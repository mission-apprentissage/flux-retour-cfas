{
  "info": {
    "version": "1.0.0",
    "title": "API mission apprentissage",
    "description": "L'API mission apprentissage est à disposition des ERPs et organismes de formation qui souhaitent envoyer leur donnnées effectifs au tableau de bord de l'apprentissage.",
    "contact": {
      "name": "support",
      "email": "tableau-de-bord@apprentissage.beta.gouv.fr"
    }
  },
  "externalDocs": {
    "description": "Plus d'info sur le tableau de bord de l'apprentissage",
    "url": "https://beta.gouv.fr/startups/tdb-apprentissage.html"
  },
  "servers": [
    {
      "url": "https://cfas.apprentissage.beta.gouv.fr/api"
    }
  ],
  "tags": [
    {
      "name": "v1",
      "description": "Version 2021. L'authentification se fait à l'aide d'un login/mot de passe. Cette version a été déprécié."
    },
    {
      "name": "v2",
      "description": "Version 2022. L'authentification se fait à l'aide d'un login/mot de passe. Cette version est en cours de dépréciation et sera remplacée par la version 3."
    },
    {
      "name": "v3",
      "description": "Version 2023. L'authentification se fait à l'aide d'une apiKey."
    }
  ],
  "openapi": "3.0.0",
  "components": {
    "securitySchemes": {
      "httpAuth": {
        "description": "Méthode d'authentification pour la V1 et V2, avec un login et un mot de passe",
        "type": "http",
        "scheme": "basic"
      },
      "apiKeyAuth": {
        "description": "Méthode d'authentification pour la V3 avec une clé d'API",
        "type": "apiKey",
        "name": "api_key",
        "in": "header"
      }
    },
    "schemas": {},
    "parameters": {}
  },
  "paths": {
    "/login": {
      "post": {
        "summary": "Authentification de l'ERP",
        "tags": ["v1", "v2"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "Le username pour s'authentifier",
                    "example": "jean.dupont"
                  },
                  "password": {
                    "type": "string",
                    "description": "Le mot de passe pour s'authentifier",
                    "example": "monMOtDePAsseSecur1sE"
                  }
                },
                "required": ["username", "password"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "successful operation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "400": {
                      "description": "Invalid username/password supplied"
                    },
                    "access_token": {
                      "type": "string",
                      "description": "Token d'authentification",
                      "example": "<JWT Access token>"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/status-apprenants": {
      "post": {
        "deprecated": true,
        "tags": ["v1"],
        "summary": "Import des dossiers apprenants",
        "description": "Permet la création ou la mise à jour de plusieurs dossiers apprenants",
        "security": [
          {
            "httpAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "nom_apprenant": {
                      "type": "string",
                      "minLength": 1,
                      "description": "nom de l'apprenant",
                      "example": "Lenôtre"
                    },
                    "prenom_apprenant": {
                      "type": "string",
                      "minLength": 1,
                      "description": "prénom de l'apprenant",
                      "example": "Gaston"
                    },
                    "date_de_naissance_apprenant": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de naissance de l'apprenant, au format ISO-8601",
                      "example": "2000-10-28T00:00:00.000Z"
                    },
                    "uai_etablissement": {
                      "type": "string",
                      "pattern": "^[0-9]{7}[a-zA-Z]$",
                      "description": "UAI apprentissage de l'établissement responsable",
                      "example": "0123456A"
                    },
                    "nom_etablissement": {
                      "type": "string",
                      "description": "Nom l'établissement responsable"
                    },
                    "id_formation": {
                      "type": "string",
                      "pattern": "^[A-Z0-9]{8}$",
                      "example": "50022141",
                      "description": "Code Formation Diplôme (CFD)"
                    },
                    "annee_scolaire": {
                      "type": "string",
                      "description": "Période scolaire",
                      "examples": ["2022-2023", "2023-2023"]
                    },
                    "statut_apprenant": {
                      "type": "integer",
                      "description": "Valeurs possibles: 0,2,3",
                      "enum": [0, 2, 3]
                    },
                    "date_metier_mise_a_jour_statut": {
                      "type": "string",
                      "format": "YYYY-MM-DDT00:00:00Z",
                      "description": "Date de dernière mise à jour du statut de l'apprenant, au format ISO-8601"
                    },
                    "id_erp_apprenant": {
                      "type": "string",
                      "description": "Identifiant de l'apprenant dans l'ERP"
                    },
                    "source": {
                      "type": "string",
                      "minLength": 1
                    },
                    "api_version": {
                      "anyOf": [
                        {
                          "type": "string",
                          "enum": ["v1"]
                        },
                        {
                          "type": "string",
                          "enum": ["v2"]
                        },
                        {
                          "type": "string",
                          "enum": ["v3"]
                        },
                        {
                          "type": "string",
                          "enum": [""]
                        },
                        {
                          "type": "null"
                        },
                        {
                          "nullable": true
                        }
                      ]
                    },
                    "ine_apprenant": {
                      "type": "string",
                      "pattern": "^(^[0-9]{9}[a-zA-Z]{2}$|^[0-9_]{10}[a-zA-Z]{1}$|^[0-9]{4}A[0-9]{5}[a-zA-Z]{1}$)$",
                      "description": "Identifiant National Élève de l'apprenant"
                    },
                    "email_contact": {
                      "type": "string",
                      "format": "email",
                      "description": "Email de l'apprenant",
                      "example": "gaston.lenotre@domain.tld"
                    },
                    "tel_apprenant": {
                      "type": "string",
                      "pattern": ".*[0-9].*",
                      "example": "0628000000",
                      "description": "Téléphone de l'apprenant"
                    },
                    "code_commune_insee_apprenant": {
                      "type": "string",
                      "pattern": "^([0-9]{2}|2A|2B)[0-9]{3}$",
                      "description": "Code Insee de la commune de résidence de l'apprenant"
                    },
                    "siret_etablissement": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'établissement responsable",
                      "example": "19750655300019"
                    },
                    "libelle_court_formation": {
                      "type": "string",
                      "minLength": 2,
                      "description": "Libellé court de la formation",
                      "example": "CAP PATISSIER"
                    },
                    "libelle_long_formation": {
                      "type": "string",
                      "minLength": 2,
                      "description": "Libellé complet de la formation",
                      "example": "CAP PATISSIER"
                    },
                    "periode_formation": {
                      "type": "string",
                      "description": "Période de la formation, en année (peut être sur plusieurs années)",
                      "example": "2021-2024"
                    },
                    "annee_formation": {
                      "type": "integer",
                      "description": "Année de la formation",
                      "enum": [0, 1, 2, 3, 4, 5]
                    },
                    "formation_rncp": {
                      "type": "string",
                      "pattern": "^(RNCP)?[0-9]{2,5}$",
                      "description": "Code RNCP de la formation",
                      "examples": ["RNCP35316", "35316"]
                    },
                    "contrat_date_debut": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "contrat_date_fin": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "contrat_date_rupture": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    }
                  },
                  "required": [
                    "nom_apprenant",
                    "prenom_apprenant",
                    "date_de_naissance_apprenant",
                    "uai_etablissement",
                    "nom_etablissement",
                    "id_formation",
                    "annee_scolaire",
                    "statut_apprenant",
                    "date_metier_mise_a_jour_statut",
                    "id_erp_apprenant",
                    "source"
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "les dossiers apprenants sont en attente de traitement. Les éventuelles erreurs seront remontées par email.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "Queued",
                      "enum": ["Queued"]
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "nom_apprenant": {
                            "type": "string",
                            "minLength": 1,
                            "description": "nom de l'apprenant",
                            "example": "Lenôtre"
                          },
                          "prenom_apprenant": {
                            "type": "string",
                            "minLength": 1,
                            "description": "prénom de l'apprenant",
                            "example": "Gaston"
                          },
                          "date_de_naissance_apprenant": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de naissance de l'apprenant, au format ISO-8601",
                            "example": "2000-10-28T00:00:00.000Z"
                          },
                          "uai_etablissement": {
                            "type": "string",
                            "pattern": "^[0-9]{7}[a-zA-Z]$",
                            "description": "UAI apprentissage de l'établissement responsable",
                            "example": "0123456A"
                          },
                          "nom_etablissement": {
                            "type": "string",
                            "description": "Nom l'établissement responsable"
                          },
                          "id_formation": {
                            "type": "string",
                            "pattern": "^[A-Z0-9]{8}$",
                            "example": "50022141",
                            "description": "Code Formation Diplôme (CFD)"
                          },
                          "annee_scolaire": {
                            "type": "string",
                            "description": "Période scolaire",
                            "examples": ["2022-2023", "2023-2023"]
                          },
                          "statut_apprenant": {
                            "type": "integer",
                            "description": "Valeurs possibles: 0,2,3",
                            "enum": [0, 2, 3]
                          },
                          "date_metier_mise_a_jour_statut": {
                            "type": "string",
                            "format": "YYYY-MM-DDT00:00:00Z",
                            "description": "Date de dernière mise à jour du statut de l'apprenant, au format ISO-8601"
                          },
                          "id_erp_apprenant": {
                            "type": "string",
                            "description": "Identifiant de l'apprenant dans l'ERP"
                          },
                          "source": {
                            "type": "string",
                            "minLength": 1
                          },
                          "api_version": {
                            "anyOf": [
                              {
                                "type": "string",
                                "enum": ["v1"]
                              },
                              {
                                "type": "string",
                                "enum": ["v2"]
                              },
                              {
                                "type": "string",
                                "enum": ["v3"]
                              },
                              {
                                "type": "string",
                                "enum": [""]
                              },
                              {
                                "type": "null"
                              },
                              {
                                "nullable": true
                              }
                            ]
                          },
                          "ine_apprenant": {
                            "type": "string",
                            "pattern": "^(^[0-9]{9}[a-zA-Z]{2}$|^[0-9_]{10}[a-zA-Z]{1}$|^[0-9]{4}A[0-9]{5}[a-zA-Z]{1}$)$",
                            "description": "Identifiant National Élève de l'apprenant"
                          },
                          "email_contact": {
                            "type": "string",
                            "format": "email",
                            "description": "Email de l'apprenant",
                            "example": "gaston.lenotre@domain.tld"
                          },
                          "tel_apprenant": {
                            "type": "string",
                            "pattern": ".*[0-9].*",
                            "example": "0628000000",
                            "description": "Téléphone de l'apprenant"
                          },
                          "code_commune_insee_apprenant": {
                            "type": "string",
                            "pattern": "^([0-9]{2}|2A|2B)[0-9]{3}$",
                            "description": "Code Insee de la commune de résidence de l'apprenant"
                          },
                          "siret_etablissement": {
                            "type": "string",
                            "pattern": "^[0-9]{14}$",
                            "description": "SIRET de l'établissement responsable",
                            "example": "19750655300019"
                          },
                          "libelle_court_formation": {
                            "type": "string",
                            "minLength": 2,
                            "description": "Libellé court de la formation",
                            "example": "CAP PATISSIER"
                          },
                          "libelle_long_formation": {
                            "type": "string",
                            "minLength": 2,
                            "description": "Libellé complet de la formation",
                            "example": "CAP PATISSIER"
                          },
                          "periode_formation": {
                            "type": "string",
                            "description": "Période de la formation, en année (peut être sur plusieurs années)",
                            "example": "2021-2024"
                          },
                          "annee_formation": {
                            "type": "integer",
                            "description": "Année de la formation",
                            "enum": [0, 1, 2, 3, 4, 5]
                          },
                          "formation_rncp": {
                            "type": "string",
                            "pattern": "^(RNCP)?[0-9]{2,5}$",
                            "description": "Code RNCP de la formation",
                            "examples": ["RNCP35316", "35316"]
                          },
                          "contrat_date_debut": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-03-23T15:23:16.265Z"
                          },
                          "contrat_date_fin": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-08-20T14:23:16.265Z"
                          },
                          "contrat_date_rupture": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-08-20T14:23:16.265Z"
                          },
                          "validation_errors": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "msg": {
                                  "type": "string",
                                  "description": "Message d'erreur",
                                  "example": "\"contrat_date_rupture\" must be in iso format"
                                },
                                "path": {
                                  "type": "string",
                                  "description": "Chemin du champ en erreur",
                                  "example": "contrat_date_rupture"
                                }
                              },
                              "required": ["msg", "path"]
                            },
                            "description": "Erreurs de validation de cet effectif"
                          }
                        },
                        "required": [
                          "nom_apprenant",
                          "prenom_apprenant",
                          "date_de_naissance_apprenant",
                          "uai_etablissement",
                          "nom_etablissement",
                          "id_formation",
                          "annee_scolaire",
                          "statut_apprenant",
                          "date_metier_mise_a_jour_statut",
                          "id_erp_apprenant",
                          "source"
                        ]
                      }
                    }
                  },
                  "required": ["message", "data"]
                }
              }
            }
          },
          "400": {
            "description": "Les données reçues ne sont pas valides"
          },
          "500": {
            "description": "Une erreur est survenue"
          }
        }
      }
    },
    "/dossiers-apprenants": {
      "post": {
        "tags": ["v2"],
        "summary": "Import des dossiers apprenants",
        "description": "Permet la création ou la mise à jour de plusieurs dossiers apprenants",
        "security": [
          {
            "httpAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "nom_apprenant": {
                      "type": "string",
                      "minLength": 1,
                      "description": "nom de l'apprenant",
                      "example": "Lenôtre"
                    },
                    "prenom_apprenant": {
                      "type": "string",
                      "minLength": 1,
                      "description": "prénom de l'apprenant",
                      "example": "Gaston"
                    },
                    "date_de_naissance_apprenant": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de naissance de l'apprenant, au format ISO-8601",
                      "example": "2000-10-28T00:00:00.000Z"
                    },
                    "uai_etablissement": {
                      "type": "string",
                      "pattern": "^[0-9]{7}[a-zA-Z]$",
                      "description": "UAI apprentissage de l'établissement responsable",
                      "example": "0123456A"
                    },
                    "nom_etablissement": {
                      "type": "string",
                      "description": "Nom l'établissement responsable"
                    },
                    "id_formation": {
                      "type": "string",
                      "pattern": "^[A-Z0-9]{8}$",
                      "example": "50022141",
                      "description": "Code Formation Diplôme (CFD)"
                    },
                    "annee_scolaire": {
                      "type": "string",
                      "description": "Période scolaire",
                      "examples": ["2022-2023", "2023-2023"]
                    },
                    "statut_apprenant": {
                      "type": "integer",
                      "description": "Valeurs possibles: 0,2,3",
                      "enum": [0, 2, 3]
                    },
                    "date_metier_mise_a_jour_statut": {
                      "type": "string",
                      "format": "YYYY-MM-DDT00:00:00Z",
                      "description": "Date de dernière mise à jour du statut de l'apprenant, au format ISO-8601"
                    },
                    "id_erp_apprenant": {
                      "type": "string",
                      "description": "Identifiant de l'apprenant dans l'ERP"
                    },
                    "source": {
                      "type": "string",
                      "minLength": 1
                    },
                    "api_version": {
                      "anyOf": [
                        {
                          "type": "string",
                          "enum": ["v1"]
                        },
                        {
                          "type": "string",
                          "enum": ["v2"]
                        },
                        {
                          "type": "string",
                          "enum": ["v3"]
                        },
                        {
                          "type": "string",
                          "enum": [""]
                        },
                        {
                          "type": "null"
                        },
                        {
                          "nullable": true
                        }
                      ]
                    },
                    "ine_apprenant": {
                      "type": "string",
                      "pattern": "^(^[0-9]{9}[a-zA-Z]{2}$|^[0-9_]{10}[a-zA-Z]{1}$|^[0-9]{4}A[0-9]{5}[a-zA-Z]{1}$)$",
                      "description": "Identifiant National Élève de l'apprenant"
                    },
                    "email_contact": {
                      "type": "string",
                      "format": "email",
                      "description": "Email de l'apprenant",
                      "example": "gaston.lenotre@domain.tld"
                    },
                    "tel_apprenant": {
                      "type": "string",
                      "pattern": ".*[0-9].*",
                      "example": "0628000000",
                      "description": "Téléphone de l'apprenant"
                    },
                    "code_commune_insee_apprenant": {
                      "type": "string",
                      "pattern": "^([0-9]{2}|2A|2B)[0-9]{3}$",
                      "description": "Code Insee de la commune de résidence de l'apprenant"
                    },
                    "siret_etablissement": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'établissement responsable",
                      "example": "19750655300019"
                    },
                    "libelle_court_formation": {
                      "type": "string",
                      "minLength": 2,
                      "description": "Libellé court de la formation",
                      "example": "CAP PATISSIER"
                    },
                    "libelle_long_formation": {
                      "type": "string",
                      "minLength": 2,
                      "description": "Libellé complet de la formation",
                      "example": "CAP PATISSIER"
                    },
                    "periode_formation": {
                      "type": "string",
                      "description": "Période de la formation, en année (peut être sur plusieurs années)",
                      "example": "2021-2024"
                    },
                    "annee_formation": {
                      "type": "integer",
                      "description": "Année de la formation",
                      "enum": [0, 1, 2, 3, 4, 5]
                    },
                    "formation_rncp": {
                      "type": "string",
                      "pattern": "^(RNCP)?[0-9]{2,5}$",
                      "description": "Code RNCP de la formation",
                      "examples": ["RNCP35316", "35316"]
                    },
                    "contrat_date_debut": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "contrat_date_fin": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "contrat_date_rupture": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    }
                  },
                  "required": [
                    "nom_apprenant",
                    "prenom_apprenant",
                    "date_de_naissance_apprenant",
                    "uai_etablissement",
                    "nom_etablissement",
                    "id_formation",
                    "annee_scolaire",
                    "statut_apprenant",
                    "date_metier_mise_a_jour_statut",
                    "id_erp_apprenant",
                    "source"
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "les dossiers apprenants sont en attente de traitement. Les éventuelles erreurs seront remontées par email.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "Queued",
                      "enum": ["Queued"]
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "nom_apprenant": {
                            "type": "string",
                            "minLength": 1,
                            "description": "nom de l'apprenant",
                            "example": "Lenôtre"
                          },
                          "prenom_apprenant": {
                            "type": "string",
                            "minLength": 1,
                            "description": "prénom de l'apprenant",
                            "example": "Gaston"
                          },
                          "date_de_naissance_apprenant": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de naissance de l'apprenant, au format ISO-8601",
                            "example": "2000-10-28T00:00:00.000Z"
                          },
                          "uai_etablissement": {
                            "type": "string",
                            "pattern": "^[0-9]{7}[a-zA-Z]$",
                            "description": "UAI apprentissage de l'établissement responsable",
                            "example": "0123456A"
                          },
                          "nom_etablissement": {
                            "type": "string",
                            "description": "Nom l'établissement responsable"
                          },
                          "id_formation": {
                            "type": "string",
                            "pattern": "^[A-Z0-9]{8}$",
                            "example": "50022141",
                            "description": "Code Formation Diplôme (CFD)"
                          },
                          "annee_scolaire": {
                            "type": "string",
                            "description": "Période scolaire",
                            "examples": ["2022-2023", "2023-2023"]
                          },
                          "statut_apprenant": {
                            "type": "integer",
                            "description": "Valeurs possibles: 0,2,3",
                            "enum": [0, 2, 3]
                          },
                          "date_metier_mise_a_jour_statut": {
                            "type": "string",
                            "format": "YYYY-MM-DDT00:00:00Z",
                            "description": "Date de dernière mise à jour du statut de l'apprenant, au format ISO-8601"
                          },
                          "id_erp_apprenant": {
                            "type": "string",
                            "description": "Identifiant de l'apprenant dans l'ERP"
                          },
                          "source": {
                            "type": "string",
                            "minLength": 1
                          },
                          "api_version": {
                            "anyOf": [
                              {
                                "type": "string",
                                "enum": ["v1"]
                              },
                              {
                                "type": "string",
                                "enum": ["v2"]
                              },
                              {
                                "type": "string",
                                "enum": ["v3"]
                              },
                              {
                                "type": "string",
                                "enum": [""]
                              },
                              {
                                "type": "null"
                              },
                              {
                                "nullable": true
                              }
                            ]
                          },
                          "ine_apprenant": {
                            "type": "string",
                            "pattern": "^(^[0-9]{9}[a-zA-Z]{2}$|^[0-9_]{10}[a-zA-Z]{1}$|^[0-9]{4}A[0-9]{5}[a-zA-Z]{1}$)$",
                            "description": "Identifiant National Élève de l'apprenant"
                          },
                          "email_contact": {
                            "type": "string",
                            "format": "email",
                            "description": "Email de l'apprenant",
                            "example": "gaston.lenotre@domain.tld"
                          },
                          "tel_apprenant": {
                            "type": "string",
                            "pattern": ".*[0-9].*",
                            "example": "0628000000",
                            "description": "Téléphone de l'apprenant"
                          },
                          "code_commune_insee_apprenant": {
                            "type": "string",
                            "pattern": "^([0-9]{2}|2A|2B)[0-9]{3}$",
                            "description": "Code Insee de la commune de résidence de l'apprenant"
                          },
                          "siret_etablissement": {
                            "type": "string",
                            "pattern": "^[0-9]{14}$",
                            "description": "SIRET de l'établissement responsable",
                            "example": "19750655300019"
                          },
                          "libelle_court_formation": {
                            "type": "string",
                            "minLength": 2,
                            "description": "Libellé court de la formation",
                            "example": "CAP PATISSIER"
                          },
                          "libelle_long_formation": {
                            "type": "string",
                            "minLength": 2,
                            "description": "Libellé complet de la formation",
                            "example": "CAP PATISSIER"
                          },
                          "periode_formation": {
                            "type": "string",
                            "description": "Période de la formation, en année (peut être sur plusieurs années)",
                            "example": "2021-2024"
                          },
                          "annee_formation": {
                            "type": "integer",
                            "description": "Année de la formation",
                            "enum": [0, 1, 2, 3, 4, 5]
                          },
                          "formation_rncp": {
                            "type": "string",
                            "pattern": "^(RNCP)?[0-9]{2,5}$",
                            "description": "Code RNCP de la formation",
                            "examples": ["RNCP35316", "35316"]
                          },
                          "contrat_date_debut": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-03-23T15:23:16.265Z"
                          },
                          "contrat_date_fin": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-08-20T14:23:16.265Z"
                          },
                          "contrat_date_rupture": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-08-20T14:23:16.265Z"
                          },
                          "validation_errors": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "msg": {
                                  "type": "string",
                                  "description": "Message d'erreur",
                                  "example": "\"contrat_date_rupture\" must be in iso format"
                                },
                                "path": {
                                  "type": "string",
                                  "description": "Chemin du champ en erreur",
                                  "example": "contrat_date_rupture"
                                }
                              },
                              "required": ["msg", "path"]
                            },
                            "description": "Erreurs de validation de cet effectif"
                          }
                        },
                        "required": [
                          "nom_apprenant",
                          "prenom_apprenant",
                          "date_de_naissance_apprenant",
                          "uai_etablissement",
                          "nom_etablissement",
                          "id_formation",
                          "annee_scolaire",
                          "statut_apprenant",
                          "date_metier_mise_a_jour_statut",
                          "id_erp_apprenant",
                          "source"
                        ]
                      }
                    }
                  },
                  "required": ["message", "data"]
                }
              }
            }
          },
          "400": {
            "description": "Les données reçues ne sont pas valides"
          },
          "500": {
            "description": "Une erreur est survenue"
          }
        }
      }
    },
    "/v3/dossiers-apprenants": {
      "post": {
        "summary": "Import des dossiers apprenants",
        "description": "Permet la création ou la mise à jour de plusieurs dossiers apprenants",
        "security": [
          {
            "apiKeyAuth": []
          }
        ],
        "tags": ["v3"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "nom_apprenant": {
                      "type": "string",
                      "minLength": 1,
                      "description": "nom de l'apprenant",
                      "example": "Lenôtre"
                    },
                    "prenom_apprenant": {
                      "type": "string",
                      "minLength": 1,
                      "description": "prénom de l'apprenant",
                      "example": "Gaston"
                    },
                    "date_de_naissance_apprenant": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de naissance de l'apprenant, au format ISO-8601",
                      "example": "2000-10-28T00:00:00.000Z"
                    },
                    "annee_scolaire": {
                      "type": "string",
                      "description": "Période scolaire",
                      "examples": ["2022-2023", "2023-2023"]
                    },
                    "statut_apprenant": {
                      "type": "integer",
                      "description": "Valeurs possibles: 0,2,3",
                      "enum": [0, 2, 3]
                    },
                    "date_metier_mise_a_jour_statut": {
                      "type": "string",
                      "format": "YYYY-MM-DDT00:00:00Z",
                      "description": "Date de dernière mise à jour du statut de l'apprenant, au format ISO-8601"
                    },
                    "id_erp_apprenant": {
                      "type": "string",
                      "description": "Identifiant de l'apprenant dans l'ERP"
                    },
                    "ine_apprenant": {
                      "type": "string",
                      "pattern": "^(^[0-9]{9}[a-zA-Z]{2}$|^[0-9_]{10}[a-zA-Z]{1}$|^[0-9]{4}A[0-9]{5}[a-zA-Z]{1}$)$",
                      "description": "Identifiant National Élève de l'apprenant"
                    },
                    "email_contact": {
                      "type": "string",
                      "format": "email",
                      "description": "Email de l'apprenant",
                      "example": "gaston.lenotre@domain.tld"
                    },
                    "tel_apprenant": {
                      "type": "string",
                      "pattern": ".*[0-9].*",
                      "example": "0628000000",
                      "description": "Téléphone de l'apprenant"
                    },
                    "libelle_court_formation": {
                      "type": "string",
                      "minLength": 2,
                      "description": "Libellé court de la formation",
                      "example": "CAP PATISSIER"
                    },
                    "annee_formation": {
                      "type": "integer",
                      "description": "Année de la formation",
                      "enum": [0, 1, 2, 3, 4, 5]
                    },
                    "formation_rncp": {
                      "type": "string",
                      "pattern": "^(RNCP)?[0-9]{2,5}$",
                      "description": "Code RNCP de la formation",
                      "examples": ["RNCP35316", "35316"]
                    },
                    "contrat_date_debut": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "contrat_date_fin": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "contrat_date_rupture": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "nir_apprenant": {
                      "type": "string",
                      "description": "NIR de l'apprenant",
                      "example": "1234567890123"
                    },
                    "adresse_apprenant": {
                      "type": "string",
                      "description": "Adresse de l'apprenant"
                    },
                    "code_postal_apprenant": {
                      "type": "string",
                      "description": "Code postal de l'apprenant"
                    },
                    "code_postal_de_naissance_apprenant": {
                      "type": "string",
                      "description": "Code postal de l'apprenant"
                    },
                    "sexe_apprenant": {
                      "type": "string",
                      "description": "Sexe de l'apprenant",
                      "enum": ["M", "F"],
                      "example": "M"
                    },
                    "rqth_apprenant": {
                      "type": "boolean",
                      "description": "Reconnaissance de la Qualité de Travailleur Handicapé",
                      "example": true
                    },
                    "date_rqth_apprenant": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de la reconnaissance travailleur handicapé",
                      "example": "2010-10-28T00:00:00.000Z"
                    },
                    "responsable_apprenant_mail1": {
                      "type": "string",
                      "format": "email",
                      "description": "Email du responsable de l'apprenant",
                      "example": "escoffier@domain.tld"
                    },
                    "responsable_apprenant_mail2": {
                      "type": "string",
                      "format": "email",
                      "description": "Email du responsable de l'apprenant",
                      "example": "escoffier@domain.tld"
                    },
                    "obtention_diplome_formation": {
                      "type": "boolean",
                      "description": "L'apprenant a obtenu son diplôme sur la formation donnée",
                      "example": true
                    },
                    "date_obtention_diplome_formation": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de l'obtention du diplôme de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "date_exclusion_formation": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date d'exclusion de l'apprenant de la formation, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "cause_exclusion_formation": {
                      "type": "string",
                      "description": "Cause de l'exclusion de l'apprenant de la formation",
                      "examples": [
                        "absences répétées et injustifiées",
                        "cessation du travail et abandon des cours",
                        "non respect des règles de sécurité"
                      ]
                    },
                    "nom_referent_handicap_formation": {
                      "type": "string",
                      "description": "Nom du référent handicap de la formation"
                    },
                    "prenom_referent_handicap_formation": {
                      "type": "string",
                      "description": "Prénom du référent handicap de la formation"
                    },
                    "email_referent_handicap_formation": {
                      "type": "string",
                      "format": "email",
                      "description": "Email du référent handicap de la formation"
                    },
                    "cause_rupture_contrat": {
                      "type": "string",
                      "description": "Cause de la rupture du contrat de l'apprenant",
                      "examples": [
                        "démission",
                        "résiliation",
                        "force majeure",
                        "obtention du diplôme",
                        "faute lourde",
                        "inaptitude constatée par la médecine du travail"
                      ]
                    },
                    "contrat_date_debut_2": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "contrat_date_fin_2": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "contrat_date_rupture_2": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "cause_rupture_contrat_2": {
                      "type": "string",
                      "description": "Cause de la rupture du contrat de l'apprenant",
                      "examples": [
                        "démission",
                        "résiliation",
                        "force majeure",
                        "obtention du diplôme",
                        "faute lourde",
                        "inaptitude constatée par la médecine du travail"
                      ]
                    },
                    "contrat_date_debut_3": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "contrat_date_fin_3": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "contrat_date_rupture_3": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "cause_rupture_contrat_3": {
                      "type": "string",
                      "description": "Cause de la rupture du contrat de l'apprenant",
                      "examples": [
                        "démission",
                        "résiliation",
                        "force majeure",
                        "obtention du diplôme",
                        "faute lourde",
                        "inaptitude constatée par la médecine du travail"
                      ]
                    },
                    "contrat_date_debut_4": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "contrat_date_fin_4": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "contrat_date_rupture_4": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "cause_rupture_contrat_4": {
                      "type": "string",
                      "description": "Cause de la rupture du contrat de l'apprenant",
                      "examples": [
                        "démission",
                        "résiliation",
                        "force majeure",
                        "obtention du diplôme",
                        "faute lourde",
                        "inaptitude constatée par la médecine du travail"
                      ]
                    },
                    "siret_employeur": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'employeur"
                    },
                    "siret_employeur_2": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'employeur"
                    },
                    "siret_employeur_3": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'employeur"
                    },
                    "siret_employeur_4": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'employeur"
                    },
                    "formation_presentielle": {
                      "type": "boolean",
                      "description": "Formation 100% à distance ou non",
                      "example": true
                    },
                    "duree_theorique_formation": {
                      "type": "integer",
                      "minimum": 1,
                      "maximum": 4,
                      "description": "Durée théorique de la formation"
                    },
                    "date_inscription_formation": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date d'inscription de l'apprenant dans la formation, au format ISO-8601"
                    },
                    "date_entree_formation": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date d'entrée de l'apprenant dans la formation, au format ISO-8601",
                      "example": "2023-03-23T15:23:16.265Z"
                    },
                    "date_fin_formation": {
                      "type": "string",
                      "format": "YYYY-MM-DD",
                      "description": "Date de fin de la formation, au format ISO-8601",
                      "example": "2023-08-20T14:23:16.265Z"
                    },
                    "etablissement_responsable_uai": {
                      "type": "string",
                      "pattern": "^[0-9]{7}[a-zA-Z]$",
                      "description": "UAI apprentissage de l'établissement responsable",
                      "example": "0123456A"
                    },
                    "etablissement_responsable_siret": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'établissement responsable",
                      "example": "19750655300019"
                    },
                    "etablissement_formateur_uai": {
                      "type": "string",
                      "pattern": "^[0-9]{7}[a-zA-Z]$",
                      "description": "UAI apprentissage de l'établissement formateur",
                      "example": "0123456A"
                    },
                    "etablissement_formateur_siret": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'établissement formateur",
                      "example": "19750655300019"
                    },
                    "etablissement_lieu_de_formation_uai": {
                      "type": "string",
                      "pattern": "^[0-9]{7}[a-zA-Z]$",
                      "description": "UAI apprentissage de l'établissement (lieu de formation)",
                      "example": "0123456A"
                    },
                    "etablissement_lieu_de_formation_siret": {
                      "type": "string",
                      "pattern": "^[0-9]{14}$",
                      "description": "SIRET de l'établissement (lieu de formation)",
                      "example": "19750655300019"
                    },
                    "formation_cfd": {
                      "type": "string",
                      "pattern": "^[A-Z0-9]{8}$",
                      "example": "50022141",
                      "description": "Code Formation Diplôme (CFD)"
                    }
                  },
                  "required": [
                    "nom_apprenant",
                    "prenom_apprenant",
                    "date_de_naissance_apprenant",
                    "annee_scolaire",
                    "statut_apprenant",
                    "date_metier_mise_a_jour_statut",
                    "id_erp_apprenant",
                    "date_inscription_formation",
                    "date_entree_formation",
                    "date_fin_formation",
                    "etablissement_responsable_uai",
                    "etablissement_responsable_siret",
                    "etablissement_formateur_uai",
                    "etablissement_formateur_siret",
                    "etablissement_lieu_de_formation_uai",
                    "etablissement_lieu_de_formation_siret"
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "les dossiers apprenants ont été mise en queue, en attente de traitement. Les éventuels erreurs seront remontées par email.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "description": "Queued",
                      "enum": ["Queued"]
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "nom_apprenant": {
                            "type": "string",
                            "minLength": 1,
                            "description": "nom de l'apprenant",
                            "example": "Lenôtre"
                          },
                          "prenom_apprenant": {
                            "type": "string",
                            "minLength": 1,
                            "description": "prénom de l'apprenant",
                            "example": "Gaston"
                          },
                          "date_de_naissance_apprenant": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de naissance de l'apprenant, au format ISO-8601",
                            "example": "2000-10-28T00:00:00.000Z"
                          },
                          "uai_etablissement": {
                            "type": "string",
                            "pattern": "^[0-9]{7}[a-zA-Z]$",
                            "description": "UAI apprentissage de l'établissement responsable",
                            "example": "0123456A"
                          },
                          "nom_etablissement": {
                            "type": "string",
                            "description": "Nom l'établissement responsable"
                          },
                          "id_formation": {
                            "type": "string",
                            "pattern": "^[A-Z0-9]{8}$",
                            "example": "50022141",
                            "description": "Code Formation Diplôme (CFD)"
                          },
                          "annee_scolaire": {
                            "type": "string",
                            "description": "Période scolaire",
                            "examples": ["2022-2023", "2023-2023"]
                          },
                          "statut_apprenant": {
                            "type": "integer",
                            "description": "Valeurs possibles: 0,2,3",
                            "enum": [0, 2, 3]
                          },
                          "date_metier_mise_a_jour_statut": {
                            "type": "string",
                            "format": "YYYY-MM-DDT00:00:00Z",
                            "description": "Date de dernière mise à jour du statut de l'apprenant, au format ISO-8601"
                          },
                          "id_erp_apprenant": {
                            "type": "string",
                            "description": "Identifiant de l'apprenant dans l'ERP"
                          },
                          "source": {
                            "type": "string",
                            "minLength": 1
                          },
                          "api_version": {
                            "anyOf": [
                              {
                                "type": "string",
                                "enum": ["v1"]
                              },
                              {
                                "type": "string",
                                "enum": ["v2"]
                              },
                              {
                                "type": "string",
                                "enum": ["v3"]
                              },
                              {
                                "type": "string",
                                "enum": [""]
                              },
                              {
                                "type": "null"
                              },
                              {
                                "nullable": true
                              }
                            ]
                          },
                          "ine_apprenant": {
                            "type": "string",
                            "pattern": "^(^[0-9]{9}[a-zA-Z]{2}$|^[0-9_]{10}[a-zA-Z]{1}$|^[0-9]{4}A[0-9]{5}[a-zA-Z]{1}$)$",
                            "description": "Identifiant National Élève de l'apprenant"
                          },
                          "email_contact": {
                            "type": "string",
                            "format": "email",
                            "description": "Email de l'apprenant",
                            "example": "gaston.lenotre@domain.tld"
                          },
                          "tel_apprenant": {
                            "type": "string",
                            "pattern": ".*[0-9].*",
                            "example": "0628000000",
                            "description": "Téléphone de l'apprenant"
                          },
                          "code_commune_insee_apprenant": {
                            "type": "string",
                            "pattern": "^([0-9]{2}|2A|2B)[0-9]{3}$",
                            "description": "Code Insee de la commune de résidence de l'apprenant"
                          },
                          "siret_etablissement": {
                            "type": "string",
                            "pattern": "^[0-9]{14}$",
                            "description": "SIRET de l'établissement responsable",
                            "example": "19750655300019"
                          },
                          "libelle_court_formation": {
                            "type": "string",
                            "minLength": 2,
                            "description": "Libellé court de la formation",
                            "example": "CAP PATISSIER"
                          },
                          "libelle_long_formation": {
                            "type": "string",
                            "minLength": 2,
                            "description": "Libellé complet de la formation",
                            "example": "CAP PATISSIER"
                          },
                          "periode_formation": {
                            "type": "string",
                            "description": "Période de la formation, en année (peut être sur plusieurs années)",
                            "example": "2021-2024"
                          },
                          "annee_formation": {
                            "type": "integer",
                            "description": "Année de la formation",
                            "enum": [0, 1, 2, 3, 4, 5]
                          },
                          "formation_rncp": {
                            "type": "string",
                            "pattern": "^(RNCP)?[0-9]{2,5}$",
                            "description": "Code RNCP de la formation",
                            "examples": ["RNCP35316", "35316"]
                          },
                          "contrat_date_debut": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de début de contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-03-23T15:23:16.265Z"
                          },
                          "contrat_date_fin": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de fin de contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-08-20T14:23:16.265Z"
                          },
                          "contrat_date_rupture": {
                            "type": "string",
                            "format": "YYYY-MM-DD",
                            "description": "Date de rupture du contrat de l'apprenant, au format ISO-8601",
                            "example": "2023-08-20T14:23:16.265Z"
                          },
                          "validation_errors": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "msg": {
                                  "type": "string",
                                  "description": "Message d'erreur",
                                  "example": "\"contrat_date_rupture\" must be in iso format"
                                },
                                "path": {
                                  "type": "string",
                                  "description": "Chemin du champ en erreur",
                                  "example": "contrat_date_rupture"
                                }
                              },
                              "required": ["msg", "path"]
                            },
                            "description": "Erreurs de validation de cet effectif"
                          }
                        },
                        "required": [
                          "nom_apprenant",
                          "prenom_apprenant",
                          "date_de_naissance_apprenant",
                          "uai_etablissement",
                          "nom_etablissement",
                          "id_formation",
                          "annee_scolaire",
                          "statut_apprenant",
                          "date_metier_mise_a_jour_statut",
                          "id_erp_apprenant",
                          "source"
                        ]
                      }
                    }
                  },
                  "required": ["message", "data"]
                }
              }
            }
          },
          "500": {
            "description": "Une erreur est survenue"
          }
        }
      }
    }
  }
}
