// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`validation-schema > should create validation schema for auditLogs > auditLogs 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "action": {
      "bsonType": "string",
      "description": "L'action en cours",
    },
    "data": {
      "anyOf": [
        {},
        {
          "bsonType": "null",
        },
      ],
      "description": "La donnée liée à l'action",
    },
    "date": {
      "bsonType": "date",
      "description": "La date de l'évènement",
    },
  },
  "required": [
    "action",
    "date",
    "_id",
  ],
}
`;

exports[`validation-schema > should create validation schema for effectifV2 > effectifV2 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "date_de_naissance": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "bsonType": "date",
                    },
                    {
                      "bsonType": "string",
                    },
                  ],
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "nom": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "prenom": {
              "bsonType": [
                "string",
                "null",
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "_id": {
      "bsonType": "objectId",
    },
    "created_at": {
      "bsonType": "date",
    },
    "draft": {
      "bsonType": "bool",
    },
    "formation_id": {
      "bsonType": "objectId",
    },
    "person_id": {
      "bsonType": "objectId",
    },
    "updated_at": {
      "bsonType": "date",
    },
  },
  "required": [
    "_id",
    "created_at",
    "updated_at",
    "draft",
    "formation_id",
    "person_id",
  ],
}
`;

exports[`validation-schema > should create validation schema for effectifs > effectifs 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "description": "Propriétés calculées ou récupérées d'autres collections",
          "properties": {
            "formation": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "codes_rome": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "items": {
                            "bsonType": "string",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "opcos": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "items": {
                            "bsonType": "string",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "organisme": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "academie": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "bassinEmploi": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                    },
                    "departement": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "fiable": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "organismes.fiabilisation_statut == "FIABLE" && ferme != false",
                    },
                    "region": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "reseaux": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "description": "Réseaux du CFA, s'ils existent",
                          "items": {
                            "bsonType": "string",
                            "enum": [
                              "ADEN",
                              "CMA",
                              "AGRI",
                              "AGRI_CNEAP",
                              "AGRI_UNREP",
                              "AGRI_UNMFREO",
                              "ANASUP",
                              "AMUE",
                              "CCI",
                              "CFA_EC",
                              "COMP_DU_DEVOIR",
                              "COMP_DU_TOUR_DE_FRANCE",
                              "GRETA",
                              "UIMM",
                              "BTP_CFA",
                              "MFR",
                              "AFTRAL",
                              "GRETA_VAUCLUSE",
                              "CFA_SAT",
                              "EN_HORS_MURS",
                              "EN_CFA_ACADEMIQUE",
                              "EN_EPLE",
                              "EDUSERVICES",
                              "AFPA",
                            ],
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Réseaux du CFA, s'ils existent",
                    },
                    "siret": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "N° SIRET de l'établissement",
                          "pattern": "^[0-9]{14}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "N° SIRET de l'établissement",
                    },
                    "uai": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code UAI de l'établissement",
                          "pattern": "^[0-9]{7}[a-zA-Z]$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code UAI de l'établissement",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "statut": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "en_cours": {
                      "bsonType": "string",
                      "enum": [
                        "ABANDON",
                        "PRE_INSCRIT",
                        "INSCRIT",
                        "APPRENTI",
                        "RUPTURANT",
                        "FIN_DE_FORMATION",
                      ],
                    },
                    "parcours": {
                      "bsonType": "array",
                      "items": {
                        "additionalProperties": false,
                        "bsonType": "object",
                        "properties": {
                          "date": {
                            "bsonType": "date",
                          },
                          "valeur": {
                            "bsonType": "string",
                            "enum": [
                              "ABANDON",
                              "PRE_INSCRIT",
                              "INSCRIT",
                              "APPRENTI",
                              "RUPTURANT",
                              "FIN_DE_FORMATION",
                            ],
                          },
                        },
                        "required": [
                          "date",
                          "valeur",
                        ],
                      },
                    },
                  },
                  "required": [
                    "en_cours",
                    "parcours",
                  ],
                },
                {
                  "bsonType": "null",
                },
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Propriétés calculées ou récupérées d'autres collections",
    },
    "_id": {
      "bsonType": "objectId",
      "description": "Identifiant MongoDB de l'effectif",
    },
    "_raw": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "formation": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "annee": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Numéro de l'année dans la formation (promo)",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Numéro de l'année dans la formation (promo)",
                    },
                    "cause_exclusion": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Cause de l'exclusion",
                    },
                    "cfd": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code CFD de la formation",
                          "pattern": "^[A-Z0-9]{8}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code CFD de la formation",
                    },
                    "date_entree": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'entrée en formation",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'entrée en formation",
                    },
                    "date_exclusion": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'exclusion",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'exclusion",
                    },
                    "date_fin": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date de fin de la formation",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date de fin de la formation",
                    },
                    "date_inscription": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'inscription",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'inscription",
                    },
                    "date_obtention_diplome": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'obtention du diplôme",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'obtention du diplôme",
                    },
                    "duree_formation_relle": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Durée réelle de la formation en mois",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Durée réelle de la formation en mois",
                    },
                    "duree_theorique": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Durée théorique de la formation en année",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Durée théorique de la formation en année",
                    },
                    "duree_theorique_mois": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Durée théorique de la formation en mois",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Durée théorique de la formation en mois",
                    },
                    "formation_id": {
                      "anyOf": [
                        {
                          "bsonType": "objectId",
                          "description": "ID de la formation",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "ID de la formation",
                    },
                    "formation_presentielle": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "Formation en présentiel",
                    },
                    "libelle_court": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé court de la formation visée",
                    },
                    "libelle_long": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé long de la formation visée",
                    },
                    "niveau": {
                      "anyOf": [
                        {
                          "anyOf": [
                            {
                              "not": {},
                            },
                            {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Niveau de formation récupéré via Tables de Correspondances",
                            },
                          ],
                          "description": "Niveau de formation récupéré via Tables de Correspondances",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Niveau de formation récupéré via Tables de Correspondances",
                    },
                    "niveau_libelle": {
                      "anyOf": [
                        {
                          "anyOf": [
                            {
                              "not": {},
                            },
                            {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                            },
                          ],
                          "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                    },
                    "obtention_diplome": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "Diplôme obtenu",
                    },
                    "periode": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "description": "Période de la formation, en année (peut être sur plusieurs années)",
                          "items": {
                            "bsonType": "int",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Période de la formation, en année (peut être sur plusieurs années)",
                    },
                    "referent_handicap": {
                      "anyOf": [
                        {
                          "additionalProperties": false,
                          "bsonType": "object",
                          "properties": {
                            "email": {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Email du référent handicap",
                            },
                            "nom": {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Nom du référent handicap",
                            },
                            "prenom": {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Prénom du référent handicap",
                            },
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "rncp": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                          "pattern": "^(RNCP)?[0-9]{2,5}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "annee_scolaire": {
      "bsonType": "string",
      "description": "Année scolaire sur laquelle l'apprenant est enregistré (ex: "2020-2021")",
      "pattern": "^[12][0-9]{3}-[12][0-9]{3}$",
    },
    "apprenant": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "adresse": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2}$",
                },
                "bassinEmploi": {
                  "bsonType": "string",
                  "description": "Code Bassin d'emploi",
                },
                "code_insee": {
                  "bsonType": "string",
                  "description": "Le code insee doit contenir 5 caractères",
                  "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                },
                "code_postal": {
                  "bsonType": "string",
                  "description": "Le code postal doit contenir 5 caractères",
                  "pattern": "^[0-9]{5}$",
                },
                "commune": {
                  "bsonType": "string",
                  "description": "Commune",
                  "maxLength": 80,
                },
                "complement": {
                  "bsonType": "string",
                  "description": "Complément d'adresse",
                },
                "complete": {
                  "bsonType": "string",
                  "description": "Adresse complète",
                },
                "departement": {
                  "bsonType": "string",
                  "pattern": "^(2A|2B|[0-9]{2,3})$",
                },
                "mission_locale_id": {
                  "bsonType": [
                    "number",
                    "null",
                  ],
                  "description": "Id de mission locale",
                },
                "numero": {
                  "bsonType": "int",
                  "description": "N° de la voie",
                },
                "pays": {
                  "bsonType": "string",
                  "description": "Pays",
                  "enum": [
                    "AF",
                    "ZA",
                    "AL",
                    "DZ",
                    "DE",
                    "AD",
                    "AO",
                    "AG",
                    "SA",
                    "AR",
                    "AM",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BE",
                    "BZ",
                    "BJ",
                    "BT",
                    "BY",
                    "MM",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BR",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "KH",
                    "CM",
                    "CA",
                    "CV",
                    "CF",
                    "CL",
                    "CN",
                    "CY",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "KR",
                    "KP",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "DK",
                    "DJ",
                    "DO",
                    "DM",
                    "EG",
                    "SV",
                    "AE",
                    "EC",
                    "ER",
                    "ES",
                    "EE",
                    "SZ",
                    "US",
                    "ET",
                    "MK",
                    "FJ",
                    "FI",
                    "FR",
                    "GA",
                    "GM",
                    "GE",
                    "GH",
                    "GR",
                    "GD",
                    "GT",
                    "GN",
                    "GQ",
                    "GW",
                    "GY",
                    "HT",
                    "HN",
                    "HU",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IS",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JO",
                    "KZ",
                    "KE",
                    "KG",
                    "KI",
                    "XK",
                    "KW",
                    "LA",
                    "LS",
                    "LV",
                    "LB",
                    "LR",
                    "LY",
                    "LI",
                    "LT",
                    "LU",
                    "MG",
                    "MY",
                    "MW",
                    "MV",
                    "ML",
                    "MT",
                    "MA",
                    "MH",
                    "MU",
                    "MR",
                    "MX",
                    "FM",
                    "MD",
                    "MC",
                    "MN",
                    "ME",
                    "MZ",
                    "NA",
                    "NR",
                    "NP",
                    "NI",
                    "NE",
                    "NG",
                    "NO",
                    "NZ",
                    "OM",
                    "UG",
                    "UZ",
                    "PK",
                    "PW",
                    "PS",
                    "PA",
                    "PG",
                    "PY",
                    "NL",
                    "PE",
                    "PH",
                    "PL",
                    "PT",
                    "QA",
                    "RO",
                    "GB",
                    "RU",
                    "RW",
                    "KN",
                    "SM",
                    "SX",
                    "VC",
                    "LC",
                    "SB",
                    "WS",
                    "ST",
                    "SN",
                    "RS",
                    "SC",
                    "SL",
                    "SG",
                    "SK",
                    "SI",
                    "SO",
                    "SD",
                    "SS",
                    "LK",
                    "SE",
                    "CH",
                    "SR",
                    "SY",
                    "TJ",
                    "TZ",
                    "TD",
                    "CZ",
                    "TH",
                    "TL",
                    "TG",
                    "TO",
                    "TT",
                    "TN",
                    "TM",
                    "TR",
                    "TV",
                    "UA",
                    "UY",
                    "VU",
                    "VA",
                    "VE",
                    "VN",
                    "YE",
                    "ZM",
                    "ZW",
                  ],
                },
                "region": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2,3}$",
                },
                "repetition_voie": {
                  "bsonType": "string",
                  "description": "Indice de répétition du numéro de voie",
                  "enum": [
                    "B",
                    "T",
                    "Q",
                    "C",
                  ],
                },
                "voie": {
                  "bsonType": "string",
                  "description": "Nom de voie",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "adresse_naissance": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2}$",
                },
                "bassinEmploi": {
                  "bsonType": "string",
                  "description": "Code Bassin d'emploi",
                },
                "code_insee": {
                  "bsonType": "string",
                  "description": "Le code insee doit contenir 5 caractères",
                  "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                },
                "code_postal": {
                  "bsonType": "string",
                  "description": "Le code postal doit contenir 5 caractères",
                  "pattern": "^[0-9]{5}$",
                },
                "commune": {
                  "bsonType": "string",
                  "description": "Commune",
                  "maxLength": 80,
                },
                "complement": {
                  "bsonType": "string",
                  "description": "Complément d'adresse",
                },
                "complete": {
                  "bsonType": "string",
                  "description": "Adresse complète",
                },
                "departement": {
                  "bsonType": "string",
                  "pattern": "^(2A|2B|[0-9]{2,3})$",
                },
                "mission_locale_id": {
                  "bsonType": [
                    "number",
                    "null",
                  ],
                  "description": "Id de mission locale",
                },
                "numero": {
                  "bsonType": "int",
                  "description": "N° de la voie",
                },
                "pays": {
                  "bsonType": "string",
                  "description": "Pays",
                  "enum": [
                    "AF",
                    "ZA",
                    "AL",
                    "DZ",
                    "DE",
                    "AD",
                    "AO",
                    "AG",
                    "SA",
                    "AR",
                    "AM",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BE",
                    "BZ",
                    "BJ",
                    "BT",
                    "BY",
                    "MM",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BR",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "KH",
                    "CM",
                    "CA",
                    "CV",
                    "CF",
                    "CL",
                    "CN",
                    "CY",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "KR",
                    "KP",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "DK",
                    "DJ",
                    "DO",
                    "DM",
                    "EG",
                    "SV",
                    "AE",
                    "EC",
                    "ER",
                    "ES",
                    "EE",
                    "SZ",
                    "US",
                    "ET",
                    "MK",
                    "FJ",
                    "FI",
                    "FR",
                    "GA",
                    "GM",
                    "GE",
                    "GH",
                    "GR",
                    "GD",
                    "GT",
                    "GN",
                    "GQ",
                    "GW",
                    "GY",
                    "HT",
                    "HN",
                    "HU",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IS",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JO",
                    "KZ",
                    "KE",
                    "KG",
                    "KI",
                    "XK",
                    "KW",
                    "LA",
                    "LS",
                    "LV",
                    "LB",
                    "LR",
                    "LY",
                    "LI",
                    "LT",
                    "LU",
                    "MG",
                    "MY",
                    "MW",
                    "MV",
                    "ML",
                    "MT",
                    "MA",
                    "MH",
                    "MU",
                    "MR",
                    "MX",
                    "FM",
                    "MD",
                    "MC",
                    "MN",
                    "ME",
                    "MZ",
                    "NA",
                    "NR",
                    "NP",
                    "NI",
                    "NE",
                    "NG",
                    "NO",
                    "NZ",
                    "OM",
                    "UG",
                    "UZ",
                    "PK",
                    "PW",
                    "PS",
                    "PA",
                    "PG",
                    "PY",
                    "NL",
                    "PE",
                    "PH",
                    "PL",
                    "PT",
                    "QA",
                    "RO",
                    "GB",
                    "RU",
                    "RW",
                    "KN",
                    "SM",
                    "SX",
                    "VC",
                    "LC",
                    "SB",
                    "WS",
                    "ST",
                    "SN",
                    "RS",
                    "SC",
                    "SL",
                    "SG",
                    "SK",
                    "SI",
                    "SO",
                    "SD",
                    "SS",
                    "LK",
                    "SE",
                    "CH",
                    "SR",
                    "SY",
                    "TJ",
                    "TZ",
                    "TD",
                    "CZ",
                    "TH",
                    "TL",
                    "TG",
                    "TO",
                    "TT",
                    "TN",
                    "TM",
                    "TR",
                    "TV",
                    "UA",
                    "UY",
                    "VU",
                    "VA",
                    "VE",
                    "VN",
                    "YE",
                    "ZM",
                    "ZW",
                  ],
                },
                "region": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2,3}$",
                },
                "repetition_voie": {
                  "bsonType": "string",
                  "description": "Indice de répétition du numéro de voie",
                  "enum": [
                    "B",
                    "T",
                    "Q",
                    "C",
                  ],
                },
                "voie": {
                  "bsonType": "string",
                  "description": "Nom de voie",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "affelnet": {
          "anyOf": [
            {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "description": "voeux affelnet de l'apprenant",
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "code_postal_de_naissance": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
              "pattern": "^[0-9]{5}$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
        },
        "courriel": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail de contact de l'apprenant",
        },
        "date_de_naissance": {
          "anyOf": [
            {
              "bsonType": "date",
              "description": "Date de naissance de l'apprenant",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Date de naissance de l'apprenant",
        },
        "date_rqth": {
          "anyOf": [
            {
              "bsonType": "date",
              "description": "Date de la reconnaissance travailleur handicapé",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Date de la reconnaissance travailleur handicapé",
        },
        "dernier_diplome": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Dernier diplôme obtenu",
              "enum": [
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                99,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Dernier diplôme obtenu",
        },
        "dernier_organisme_uai": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
              "pattern": "^(0?[0-9][0-9]|0?2[AB]|0?9[012345]|97[1234678]|98[678]|99[0135]|[0-9]{7}[a-zA-Z])$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
        },
        "derniere_situation": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Situation de l'apprenant N-1",
              "enum": [
                1003,
                1005,
                1009,
                1017,
                1019,
                1021,
                1023,
                2001,
                2003,
                2005,
                2007,
                3001,
                3101,
                3003,
                3103,
                3009,
                3109,
                3011,
                3111,
                3031,
                3131,
                3032,
                3132,
                3033,
                3133,
                3117,
                3119,
                3021,
                3121,
                3023,
                3123,
                4001,
                4101,
                4003,
                4103,
                4005,
                4105,
                4007,
                4107,
                4009,
                4011,
                4111,
                4013,
                4113,
                4015,
                4115,
                4017,
                4117,
                4019,
                4119,
                4021,
                4121,
                4023,
                4123,
                4025,
                4125,
                4027,
                4127,
                5901,
                5903,
                5905,
                5907,
                5909,
                9900,
                9999,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Situation de l'apprenant N-1",
        },
        "has_nir": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Numéro de sécurité sociale de l'apprenant",
        },
        "historique_statut": {
          "bsonType": "array",
          "description": "Historique du statut de l'apprenant",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "abandon_forced": {
                "bsonType": [
                  "bool",
                  "null",
                ],
                "description": "Le statut a été forcé en abandon",
              },
              "date_reception": {
                "anyOf": [
                  {
                    "bsonType": "date",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "date_statut": {
                "bsonType": "date",
              },
              "valeur_statut": {
                "bsonType": "number",
                "description": "Statut de l'apprenant",
                "enum": [
                  2,
                  3,
                  0,
                ],
              },
            },
            "required": [
              "valeur_statut",
              "date_statut",
            ],
          },
        },
        "ine": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "N° INE de l'apprenant",
        },
        "inscription_sportif_haut_niveau": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Apprenant inscrit sur la liste des sportifs, entraîneurs, arbitres et juges sportifs de haut niveau",
        },
        "mineur": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "l'apprenant(e) sera-t-il(elle) mineur(e) ? (calc)",
        },
        "mineur_emancipe": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Un mineur émancipé peut accomplir seul les actes nécessitant la majorité légale.",
        },
        "nationalite": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Apprenant étranger, non citoyen européen",
              "enum": [
                1,
                2,
                3,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Apprenant étranger, non citoyen européen",
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de l'apprenant",
          "minLength": 1,
        },
        "organisme_gestionnaire": {
          "bsonType": [
            "number",
            "null",
          ],
          "description": "Relicat déprécié et non utilisé",
        },
        "parcoursup": {
          "anyOf": [
            {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "description": "voeux parcoursup de l'apprenant",
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "prenom": {
          "bsonType": "string",
          "description": "Prénom de l'apprenant",
          "minLength": 1,
        },
        "regime_scolaire": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
              "enum": [
                "I",
                "D",
                "E",
                "IE",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
        },
        "representant_legal": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "adresse": {
                  "anyOf": [
                    {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "academie": {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                        "bassinEmploi": {
                          "bsonType": "string",
                          "description": "Code Bassin d'emploi",
                        },
                        "code_insee": {
                          "bsonType": "string",
                          "description": "Le code insee doit contenir 5 caractères",
                          "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                        },
                        "code_postal": {
                          "bsonType": "string",
                          "description": "Le code postal doit contenir 5 caractères",
                          "pattern": "^[0-9]{5}$",
                        },
                        "commune": {
                          "bsonType": "string",
                          "description": "Commune",
                          "maxLength": 80,
                        },
                        "complement": {
                          "bsonType": "string",
                          "description": "Complément d'adresse",
                        },
                        "complete": {
                          "bsonType": "string",
                          "description": "Adresse complète",
                        },
                        "departement": {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                        "numero": {
                          "bsonType": "int",
                          "description": "N° de la voie",
                        },
                        "pays": {
                          "bsonType": "string",
                          "description": "Pays",
                          "enum": [
                            "AF",
                            "ZA",
                            "AL",
                            "DZ",
                            "DE",
                            "AD",
                            "AO",
                            "AG",
                            "SA",
                            "AR",
                            "AM",
                            "AU",
                            "AT",
                            "AZ",
                            "BS",
                            "BH",
                            "BD",
                            "BB",
                            "BE",
                            "BZ",
                            "BJ",
                            "BT",
                            "BY",
                            "MM",
                            "BO",
                            "BQ",
                            "BA",
                            "BW",
                            "BR",
                            "BN",
                            "BG",
                            "BF",
                            "BI",
                            "KH",
                            "CM",
                            "CA",
                            "CV",
                            "CF",
                            "CL",
                            "CN",
                            "CY",
                            "CO",
                            "KM",
                            "CG",
                            "CD",
                            "KR",
                            "KP",
                            "CR",
                            "CI",
                            "HR",
                            "CU",
                            "CW",
                            "DK",
                            "DJ",
                            "DO",
                            "DM",
                            "EG",
                            "SV",
                            "AE",
                            "EC",
                            "ER",
                            "ES",
                            "EE",
                            "SZ",
                            "US",
                            "ET",
                            "MK",
                            "FJ",
                            "FI",
                            "FR",
                            "GA",
                            "GM",
                            "GE",
                            "GH",
                            "GR",
                            "GD",
                            "GT",
                            "GN",
                            "GQ",
                            "GW",
                            "GY",
                            "HT",
                            "HN",
                            "HU",
                            "IN",
                            "ID",
                            "IR",
                            "IQ",
                            "IE",
                            "IS",
                            "IL",
                            "IT",
                            "JM",
                            "JP",
                            "JO",
                            "KZ",
                            "KE",
                            "KG",
                            "KI",
                            "XK",
                            "KW",
                            "LA",
                            "LS",
                            "LV",
                            "LB",
                            "LR",
                            "LY",
                            "LI",
                            "LT",
                            "LU",
                            "MG",
                            "MY",
                            "MW",
                            "MV",
                            "ML",
                            "MT",
                            "MA",
                            "MH",
                            "MU",
                            "MR",
                            "MX",
                            "FM",
                            "MD",
                            "MC",
                            "MN",
                            "ME",
                            "MZ",
                            "NA",
                            "NR",
                            "NP",
                            "NI",
                            "NE",
                            "NG",
                            "NO",
                            "NZ",
                            "OM",
                            "UG",
                            "UZ",
                            "PK",
                            "PW",
                            "PS",
                            "PA",
                            "PG",
                            "PY",
                            "NL",
                            "PE",
                            "PH",
                            "PL",
                            "PT",
                            "QA",
                            "RO",
                            "GB",
                            "RU",
                            "RW",
                            "KN",
                            "SM",
                            "SX",
                            "VC",
                            "LC",
                            "SB",
                            "WS",
                            "ST",
                            "SN",
                            "RS",
                            "SC",
                            "SL",
                            "SG",
                            "SK",
                            "SI",
                            "SO",
                            "SD",
                            "SS",
                            "LK",
                            "SE",
                            "CH",
                            "SR",
                            "SY",
                            "TJ",
                            "TZ",
                            "TD",
                            "CZ",
                            "TH",
                            "TL",
                            "TG",
                            "TO",
                            "TT",
                            "TN",
                            "TM",
                            "TR",
                            "TV",
                            "UA",
                            "UY",
                            "VU",
                            "VA",
                            "VE",
                            "VN",
                            "YE",
                            "ZM",
                            "ZW",
                          ],
                        },
                        "region": {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                        "repetition_voie": {
                          "bsonType": "string",
                          "description": "Indice de répétition du numéro de voie",
                          "enum": [
                            "B",
                            "T",
                            "Q",
                            "C",
                          ],
                        },
                        "voie": {
                          "bsonType": "string",
                          "description": "Nom de voie",
                        },
                      },
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "courriel": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Adresse mail de contact du representant légal",
                },
                "meme_adresse": {
                  "bsonType": [
                    "bool",
                    "null",
                  ],
                  "description": "l'apprenti(e) vit à la même adresse que son representant légal",
                },
                "nom": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Nom du representant légal",
                },
                "pcs": {
                  "anyOf": [
                    {
                      "bsonType": "number",
                      "description": "Nomenclatures des professions et catégories socioprofessionnelles",
                      "enum": [
                        10,
                        21,
                        22,
                        23,
                        31,
                        33,
                        34,
                        37,
                        38,
                        42,
                        43,
                        44,
                        45,
                        46,
                        47,
                        48,
                        52,
                        53,
                        54,
                        55,
                        56,
                        61,
                        66,
                        69,
                        71,
                        72,
                        73,
                        76,
                        81,
                        82,
                        99,
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Nomenclatures des professions et catégories socioprofessionnelles",
                },
                "prenom": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Prénom du representant légal",
                },
                "telephone": {
                  "anyOf": [
                    {
                      "bsonType": "string",
                      "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
                      "pattern": "^([+])?(\\d{7,12})$",
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "responsable_mail1": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail du responsable 1",
        },
        "responsable_mail2": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail du responsable 2",
        },
        "rqth": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Apprenant en situation d'handicape (RQTH)",
        },
        "sexe": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
              "enum": [
                "M",
                "F",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
        },
        "situation_avant_contrat": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Situation de l'apprenant avant le contrat",
              "enum": [
                11,
                12,
                21,
                31,
                41,
                51,
                52,
                53,
                54,
                90,
                99,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Situation de l'apprenant avant le contrat",
        },
        "telephone": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Téléphone de l'apprenant",
              "pattern": "^([+])?(\\d{7,12})$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Téléphone de l'apprenant",
        },
        "type_cfa": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Type de CFA",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "05",
                "06",
                "07",
                "08",
                "09",
                "10",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Type de CFA",
        },
      },
      "required": [
        "nom",
        "prenom",
        "historique_statut",
      ],
    },
    "archive": {
      "bsonType": [
        "bool",
        "null",
      ],
      "description": "Dossier apprenant est archivé (rétention maximum 5 ans)",
    },
    "contrats": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Historique des contrats de l'apprenant",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "adresse": {
                "anyOf": [
                  {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "academie": {
                        "bsonType": "string",
                        "pattern": "^[0-9]{2}$",
                      },
                      "bassinEmploi": {
                        "bsonType": "string",
                        "description": "Code Bassin d'emploi",
                      },
                      "code_insee": {
                        "bsonType": "string",
                        "description": "Le code insee doit contenir 5 caractères",
                        "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                      },
                      "code_postal": {
                        "bsonType": "string",
                        "description": "Le code postal doit contenir 5 caractères",
                        "pattern": "^[0-9]{5}$",
                      },
                      "commune": {
                        "bsonType": "string",
                        "description": "Commune",
                        "maxLength": 80,
                      },
                      "complement": {
                        "bsonType": "string",
                        "description": "Complément d'adresse",
                      },
                      "complete": {
                        "bsonType": "string",
                        "description": "Adresse complète",
                      },
                      "departement": {
                        "bsonType": "string",
                        "pattern": "^(2A|2B|[0-9]{2,3})$",
                      },
                      "numero": {
                        "bsonType": "int",
                        "description": "N° de la voie",
                      },
                      "pays": {
                        "bsonType": "string",
                        "description": "Pays",
                        "enum": [
                          "AF",
                          "ZA",
                          "AL",
                          "DZ",
                          "DE",
                          "AD",
                          "AO",
                          "AG",
                          "SA",
                          "AR",
                          "AM",
                          "AU",
                          "AT",
                          "AZ",
                          "BS",
                          "BH",
                          "BD",
                          "BB",
                          "BE",
                          "BZ",
                          "BJ",
                          "BT",
                          "BY",
                          "MM",
                          "BO",
                          "BQ",
                          "BA",
                          "BW",
                          "BR",
                          "BN",
                          "BG",
                          "BF",
                          "BI",
                          "KH",
                          "CM",
                          "CA",
                          "CV",
                          "CF",
                          "CL",
                          "CN",
                          "CY",
                          "CO",
                          "KM",
                          "CG",
                          "CD",
                          "KR",
                          "KP",
                          "CR",
                          "CI",
                          "HR",
                          "CU",
                          "CW",
                          "DK",
                          "DJ",
                          "DO",
                          "DM",
                          "EG",
                          "SV",
                          "AE",
                          "EC",
                          "ER",
                          "ES",
                          "EE",
                          "SZ",
                          "US",
                          "ET",
                          "MK",
                          "FJ",
                          "FI",
                          "FR",
                          "GA",
                          "GM",
                          "GE",
                          "GH",
                          "GR",
                          "GD",
                          "GT",
                          "GN",
                          "GQ",
                          "GW",
                          "GY",
                          "HT",
                          "HN",
                          "HU",
                          "IN",
                          "ID",
                          "IR",
                          "IQ",
                          "IE",
                          "IS",
                          "IL",
                          "IT",
                          "JM",
                          "JP",
                          "JO",
                          "KZ",
                          "KE",
                          "KG",
                          "KI",
                          "XK",
                          "KW",
                          "LA",
                          "LS",
                          "LV",
                          "LB",
                          "LR",
                          "LY",
                          "LI",
                          "LT",
                          "LU",
                          "MG",
                          "MY",
                          "MW",
                          "MV",
                          "ML",
                          "MT",
                          "MA",
                          "MH",
                          "MU",
                          "MR",
                          "MX",
                          "FM",
                          "MD",
                          "MC",
                          "MN",
                          "ME",
                          "MZ",
                          "NA",
                          "NR",
                          "NP",
                          "NI",
                          "NE",
                          "NG",
                          "NO",
                          "NZ",
                          "OM",
                          "UG",
                          "UZ",
                          "PK",
                          "PW",
                          "PS",
                          "PA",
                          "PG",
                          "PY",
                          "NL",
                          "PE",
                          "PH",
                          "PL",
                          "PT",
                          "QA",
                          "RO",
                          "GB",
                          "RU",
                          "RW",
                          "KN",
                          "SM",
                          "SX",
                          "VC",
                          "LC",
                          "SB",
                          "WS",
                          "ST",
                          "SN",
                          "RS",
                          "SC",
                          "SL",
                          "SG",
                          "SK",
                          "SI",
                          "SO",
                          "SD",
                          "SS",
                          "LK",
                          "SE",
                          "CH",
                          "SR",
                          "SY",
                          "TJ",
                          "TZ",
                          "TD",
                          "CZ",
                          "TH",
                          "TL",
                          "TG",
                          "TO",
                          "TT",
                          "TN",
                          "TM",
                          "TR",
                          "TV",
                          "UA",
                          "UY",
                          "VU",
                          "VA",
                          "VE",
                          "VN",
                          "YE",
                          "ZM",
                          "ZW",
                        ],
                      },
                      "region": {
                        "bsonType": "string",
                        "pattern": "^[0-9]{2,3}$",
                      },
                      "repetition_voie": {
                        "bsonType": "string",
                        "description": "Indice de répétition du numéro de voie",
                        "enum": [
                          "B",
                          "T",
                          "Q",
                          "C",
                        ],
                      },
                      "voie": {
                        "bsonType": "string",
                        "description": "Nom de voie",
                      },
                    },
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "cause_rupture": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Cause de rupture du contrat",
              },
              "date_debut": {
                "bsonType": "date",
                "description": "Date de début du contrat",
              },
              "date_fin": {
                "anyOf": [
                  {
                    "bsonType": "date",
                    "description": "Date de fin du contrat",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Date de fin du contrat",
              },
              "date_rupture": {
                "anyOf": [
                  {
                    "bsonType": "date",
                    "description": "Date de rupture du contrat",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Date de rupture du contrat",
              },
              "denomination": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "La dénomination sociale doit être celle de l'établissement dans lequel le contrat s'exécute.",
              },
              "naf": {
                "anyOf": [
                  {
                    "bsonType": "string",
                    "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
                    "pattern": "^[0-9]{2}\\.?[0-9]{0,2}[a-zA-Z]{0,1}$",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
              },
              "nombre_de_salaries": {
                "anyOf": [
                  {
                    "bsonType": "int",
                    "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
              },
              "siret": {
                "anyOf": [
                  {
                    "bsonType": "string",
                    "description": "N° SIRET de l'employeur",
                    "pattern": "^[0-9]{14}$",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "N° SIRET de l'employeur",
              },
              "type_employeur": {
                "anyOf": [
                  {
                    "bsonType": "number",
                    "description": "Le type d'employeur doit être en adéquation avec son statut juridique.",
                    "enum": [
                      11,
                      12,
                      13,
                      14,
                      15,
                      16,
                      21,
                      22,
                      23,
                      24,
                      25,
                      26,
                      27,
                      28,
                      29,
                      30,
                    ],
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Le type d'employeur doit être en adéquation avec son statut juridique.",
              },
            },
            "required": [
              "date_debut",
            ],
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Historique des contrats de l'apprenant",
    },
    "created_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date d'ajout en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'ajout en base de données",
    },
    "formation": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "annee": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Numéro de l'année dans la formation (promo)",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Numéro de l'année dans la formation (promo)",
            },
            "cause_exclusion": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Cause de l'exclusion",
            },
            "cfd": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code CFD de la formation",
                  "pattern": "^[A-Z0-9]{8}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code CFD de la formation",
            },
            "date_entree": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'entrée en formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'entrée en formation",
            },
            "date_exclusion": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'exclusion",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'exclusion",
            },
            "date_fin": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date de fin de la formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date de fin de la formation",
            },
            "date_inscription": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'inscription",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'inscription",
            },
            "date_obtention_diplome": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'obtention du diplôme",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'obtention du diplôme",
            },
            "duree_formation_relle": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée réelle de la formation en mois",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée réelle de la formation en mois",
            },
            "duree_theorique": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée théorique de la formation en année",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée théorique de la formation en année",
            },
            "duree_theorique_mois": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée théorique de la formation en mois",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée théorique de la formation en mois",
            },
            "formation_id": {
              "anyOf": [
                {
                  "bsonType": "objectId",
                  "description": "ID de la formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "ID de la formation",
            },
            "formation_presentielle": {
              "bsonType": [
                "bool",
                "null",
              ],
              "description": "Formation en présentiel",
            },
            "libelle_court": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Libellé court de la formation visée",
            },
            "libelle_long": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Libellé long de la formation visée",
            },
            "niveau": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "not": {},
                    },
                    {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Niveau de formation récupéré via Tables de Correspondances",
                    },
                  ],
                  "description": "Niveau de formation récupéré via Tables de Correspondances",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Niveau de formation récupéré via Tables de Correspondances",
            },
            "niveau_libelle": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "not": {},
                    },
                    {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                    },
                  ],
                  "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
            },
            "obtention_diplome": {
              "bsonType": [
                "bool",
                "null",
              ],
              "description": "Diplôme obtenu",
            },
            "periode": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "description": "Période de la formation, en année (peut être sur plusieurs années)",
                  "items": {
                    "bsonType": "int",
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Période de la formation, en année (peut être sur plusieurs années)",
            },
            "referent_handicap": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "email": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Email du référent handicap",
                    },
                    "nom": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Nom du référent handicap",
                    },
                    "prenom": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Prénom du référent handicap",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "rncp": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                  "pattern": "^(RNCP)?[0-9]{2,5}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "id_erp_apprenant": {
      "bsonType": "string",
      "description": "Identifiant de l'apprenant dans l'erp",
    },
    "is_lock": {},
    "lieu_de_formation": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "adresse": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Adresse du lieu de formation",
            },
            "code_postal": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Code postal du lieu de formation",
            },
            "siret": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "N° SIRET du lieu de formation",
                  "pattern": "^[0-9]{14}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "N° SIRET du lieu de formation",
            },
            "uai": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code UAI du lieu de formation",
                  "pattern": "^[0-9]{7}[a-zA-Z]$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code UAI du lieu de formation",
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "organisme_formateur_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Organisme formateur id",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Organisme formateur id",
    },
    "organisme_id": {
      "bsonType": "objectId",
      "description": "Organisme id (lieu de formation de l'apprenant pour la v3)",
    },
    "organisme_responsable_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Organisme responsable id",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Organisme responsable id",
    },
    "source": {
      "bsonType": "string",
      "enum": [
        "FICHIER",
        "ERP",
        "DECA",
      ],
    },
    "source_organisme_id": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "transmitted_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de transmission de l'effectif",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de transmission de l'effectif",
    },
    "updated_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de mise à jour en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de mise à jour en base de données",
    },
    "validation_errors": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Erreurs de validation de cet effectif",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "fieldName": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Nom du champ en erreur",
              },
              "inputValue": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Valeur fournie en entrée",
              },
              "message": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Message de l'erreur",
              },
              "type": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Type d'erreur",
              },
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Erreurs de validation de cet effectif",
    },
  },
  "required": [
    "_id",
    "organisme_id",
    "id_erp_apprenant",
    "source",
    "annee_scolaire",
    "apprenant",
  ],
}
`;

exports[`validation-schema > should create validation schema for effectifsArchive > effectifsArchive 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "description": "Propriétés calculées ou récupérées d'autres collections",
          "properties": {
            "formation": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "codes_rome": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "items": {
                            "bsonType": "string",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "opcos": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "items": {
                            "bsonType": "string",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "organisme": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "academie": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "bassinEmploi": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                    },
                    "departement": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "fiable": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "organismes.fiabilisation_statut == "FIABLE" && ferme != false",
                    },
                    "region": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "reseaux": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "description": "Réseaux du CFA, s'ils existent",
                          "items": {
                            "bsonType": "string",
                            "enum": [
                              "ADEN",
                              "CMA",
                              "AGRI",
                              "AGRI_CNEAP",
                              "AGRI_UNREP",
                              "AGRI_UNMFREO",
                              "ANASUP",
                              "AMUE",
                              "CCI",
                              "CFA_EC",
                              "COMP_DU_DEVOIR",
                              "COMP_DU_TOUR_DE_FRANCE",
                              "GRETA",
                              "UIMM",
                              "BTP_CFA",
                              "MFR",
                              "AFTRAL",
                              "GRETA_VAUCLUSE",
                              "CFA_SAT",
                              "EN_HORS_MURS",
                              "EN_CFA_ACADEMIQUE",
                              "EN_EPLE",
                              "EDUSERVICES",
                              "AFPA",
                            ],
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Réseaux du CFA, s'ils existent",
                    },
                    "siret": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "N° SIRET de l'établissement",
                          "pattern": "^[0-9]{14}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "N° SIRET de l'établissement",
                    },
                    "uai": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code UAI de l'établissement",
                          "pattern": "^[0-9]{7}[a-zA-Z]$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code UAI de l'établissement",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "statut": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "en_cours": {
                      "bsonType": "string",
                      "enum": [
                        "ABANDON",
                        "PRE_INSCRIT",
                        "INSCRIT",
                        "APPRENTI",
                        "RUPTURANT",
                        "FIN_DE_FORMATION",
                      ],
                    },
                    "parcours": {
                      "bsonType": "array",
                      "items": {
                        "additionalProperties": false,
                        "bsonType": "object",
                        "properties": {
                          "date": {
                            "bsonType": "date",
                          },
                          "valeur": {
                            "bsonType": "string",
                            "enum": [
                              "ABANDON",
                              "PRE_INSCRIT",
                              "INSCRIT",
                              "APPRENTI",
                              "RUPTURANT",
                              "FIN_DE_FORMATION",
                            ],
                          },
                        },
                        "required": [
                          "date",
                          "valeur",
                        ],
                      },
                    },
                  },
                  "required": [
                    "en_cours",
                    "parcours",
                  ],
                },
                {
                  "bsonType": "null",
                },
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Propriétés calculées ou récupérées d'autres collections",
    },
    "_id": {
      "bsonType": "objectId",
      "description": "Identifiant MongoDB de l'effectif",
    },
    "_raw": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "formation": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "annee": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Numéro de l'année dans la formation (promo)",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Numéro de l'année dans la formation (promo)",
                    },
                    "cause_exclusion": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Cause de l'exclusion",
                    },
                    "cfd": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code CFD de la formation",
                          "pattern": "^[A-Z0-9]{8}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code CFD de la formation",
                    },
                    "date_entree": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'entrée en formation",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'entrée en formation",
                    },
                    "date_exclusion": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'exclusion",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'exclusion",
                    },
                    "date_fin": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date de fin de la formation",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date de fin de la formation",
                    },
                    "date_inscription": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'inscription",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'inscription",
                    },
                    "date_obtention_diplome": {
                      "anyOf": [
                        {
                          "bsonType": "date",
                          "description": "Date d'obtention du diplôme",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Date d'obtention du diplôme",
                    },
                    "duree_formation_relle": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Durée réelle de la formation en mois",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Durée réelle de la formation en mois",
                    },
                    "duree_theorique": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Durée théorique de la formation en année",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Durée théorique de la formation en année",
                    },
                    "duree_theorique_mois": {
                      "anyOf": [
                        {
                          "bsonType": "int",
                          "description": "Durée théorique de la formation en mois",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Durée théorique de la formation en mois",
                    },
                    "formation_id": {
                      "anyOf": [
                        {
                          "bsonType": "objectId",
                          "description": "ID de la formation",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "ID de la formation",
                    },
                    "formation_presentielle": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "Formation en présentiel",
                    },
                    "libelle_court": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé court de la formation visée",
                    },
                    "libelle_long": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé long de la formation visée",
                    },
                    "niveau": {
                      "anyOf": [
                        {
                          "anyOf": [
                            {
                              "not": {},
                            },
                            {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Niveau de formation récupéré via Tables de Correspondances",
                            },
                          ],
                          "description": "Niveau de formation récupéré via Tables de Correspondances",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Niveau de formation récupéré via Tables de Correspondances",
                    },
                    "niveau_libelle": {
                      "anyOf": [
                        {
                          "anyOf": [
                            {
                              "not": {},
                            },
                            {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                            },
                          ],
                          "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                    },
                    "obtention_diplome": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "Diplôme obtenu",
                    },
                    "periode": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "description": "Période de la formation, en année (peut être sur plusieurs années)",
                          "items": {
                            "bsonType": "int",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Période de la formation, en année (peut être sur plusieurs années)",
                    },
                    "referent_handicap": {
                      "anyOf": [
                        {
                          "additionalProperties": false,
                          "bsonType": "object",
                          "properties": {
                            "email": {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Email du référent handicap",
                            },
                            "nom": {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Nom du référent handicap",
                            },
                            "prenom": {
                              "bsonType": [
                                "string",
                                "null",
                              ],
                              "description": "Prénom du référent handicap",
                            },
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "rncp": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                          "pattern": "^(RNCP)?[0-9]{2,5}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "annee_scolaire": {
      "bsonType": "string",
      "description": "Année scolaire sur laquelle l'apprenant est enregistré (ex: "2020-2021")",
      "pattern": "^[12][0-9]{3}-[12][0-9]{3}$",
    },
    "apprenant": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "adresse": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2}$",
                },
                "bassinEmploi": {
                  "bsonType": "string",
                  "description": "Code Bassin d'emploi",
                },
                "code_insee": {
                  "bsonType": "string",
                  "description": "Le code insee doit contenir 5 caractères",
                  "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                },
                "code_postal": {
                  "bsonType": "string",
                  "description": "Le code postal doit contenir 5 caractères",
                  "pattern": "^[0-9]{5}$",
                },
                "commune": {
                  "bsonType": "string",
                  "description": "Commune",
                  "maxLength": 80,
                },
                "complement": {
                  "bsonType": "string",
                  "description": "Complément d'adresse",
                },
                "complete": {
                  "bsonType": "string",
                  "description": "Adresse complète",
                },
                "departement": {
                  "bsonType": "string",
                  "pattern": "^(2A|2B|[0-9]{2,3})$",
                },
                "mission_locale_id": {
                  "bsonType": [
                    "number",
                    "null",
                  ],
                  "description": "Id de mission locale",
                },
                "numero": {
                  "bsonType": "int",
                  "description": "N° de la voie",
                },
                "pays": {
                  "bsonType": "string",
                  "description": "Pays",
                  "enum": [
                    "AF",
                    "ZA",
                    "AL",
                    "DZ",
                    "DE",
                    "AD",
                    "AO",
                    "AG",
                    "SA",
                    "AR",
                    "AM",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BE",
                    "BZ",
                    "BJ",
                    "BT",
                    "BY",
                    "MM",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BR",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "KH",
                    "CM",
                    "CA",
                    "CV",
                    "CF",
                    "CL",
                    "CN",
                    "CY",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "KR",
                    "KP",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "DK",
                    "DJ",
                    "DO",
                    "DM",
                    "EG",
                    "SV",
                    "AE",
                    "EC",
                    "ER",
                    "ES",
                    "EE",
                    "SZ",
                    "US",
                    "ET",
                    "MK",
                    "FJ",
                    "FI",
                    "FR",
                    "GA",
                    "GM",
                    "GE",
                    "GH",
                    "GR",
                    "GD",
                    "GT",
                    "GN",
                    "GQ",
                    "GW",
                    "GY",
                    "HT",
                    "HN",
                    "HU",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IS",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JO",
                    "KZ",
                    "KE",
                    "KG",
                    "KI",
                    "XK",
                    "KW",
                    "LA",
                    "LS",
                    "LV",
                    "LB",
                    "LR",
                    "LY",
                    "LI",
                    "LT",
                    "LU",
                    "MG",
                    "MY",
                    "MW",
                    "MV",
                    "ML",
                    "MT",
                    "MA",
                    "MH",
                    "MU",
                    "MR",
                    "MX",
                    "FM",
                    "MD",
                    "MC",
                    "MN",
                    "ME",
                    "MZ",
                    "NA",
                    "NR",
                    "NP",
                    "NI",
                    "NE",
                    "NG",
                    "NO",
                    "NZ",
                    "OM",
                    "UG",
                    "UZ",
                    "PK",
                    "PW",
                    "PS",
                    "PA",
                    "PG",
                    "PY",
                    "NL",
                    "PE",
                    "PH",
                    "PL",
                    "PT",
                    "QA",
                    "RO",
                    "GB",
                    "RU",
                    "RW",
                    "KN",
                    "SM",
                    "SX",
                    "VC",
                    "LC",
                    "SB",
                    "WS",
                    "ST",
                    "SN",
                    "RS",
                    "SC",
                    "SL",
                    "SG",
                    "SK",
                    "SI",
                    "SO",
                    "SD",
                    "SS",
                    "LK",
                    "SE",
                    "CH",
                    "SR",
                    "SY",
                    "TJ",
                    "TZ",
                    "TD",
                    "CZ",
                    "TH",
                    "TL",
                    "TG",
                    "TO",
                    "TT",
                    "TN",
                    "TM",
                    "TR",
                    "TV",
                    "UA",
                    "UY",
                    "VU",
                    "VA",
                    "VE",
                    "VN",
                    "YE",
                    "ZM",
                    "ZW",
                  ],
                },
                "region": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2,3}$",
                },
                "repetition_voie": {
                  "bsonType": "string",
                  "description": "Indice de répétition du numéro de voie",
                  "enum": [
                    "B",
                    "T",
                    "Q",
                    "C",
                  ],
                },
                "voie": {
                  "bsonType": "string",
                  "description": "Nom de voie",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "adresse_naissance": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2}$",
                },
                "bassinEmploi": {
                  "bsonType": "string",
                  "description": "Code Bassin d'emploi",
                },
                "code_insee": {
                  "bsonType": "string",
                  "description": "Le code insee doit contenir 5 caractères",
                  "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                },
                "code_postal": {
                  "bsonType": "string",
                  "description": "Le code postal doit contenir 5 caractères",
                  "pattern": "^[0-9]{5}$",
                },
                "commune": {
                  "bsonType": "string",
                  "description": "Commune",
                  "maxLength": 80,
                },
                "complement": {
                  "bsonType": "string",
                  "description": "Complément d'adresse",
                },
                "complete": {
                  "bsonType": "string",
                  "description": "Adresse complète",
                },
                "departement": {
                  "bsonType": "string",
                  "pattern": "^(2A|2B|[0-9]{2,3})$",
                },
                "mission_locale_id": {
                  "bsonType": [
                    "number",
                    "null",
                  ],
                  "description": "Id de mission locale",
                },
                "numero": {
                  "bsonType": "int",
                  "description": "N° de la voie",
                },
                "pays": {
                  "bsonType": "string",
                  "description": "Pays",
                  "enum": [
                    "AF",
                    "ZA",
                    "AL",
                    "DZ",
                    "DE",
                    "AD",
                    "AO",
                    "AG",
                    "SA",
                    "AR",
                    "AM",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BE",
                    "BZ",
                    "BJ",
                    "BT",
                    "BY",
                    "MM",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BR",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "KH",
                    "CM",
                    "CA",
                    "CV",
                    "CF",
                    "CL",
                    "CN",
                    "CY",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "KR",
                    "KP",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "DK",
                    "DJ",
                    "DO",
                    "DM",
                    "EG",
                    "SV",
                    "AE",
                    "EC",
                    "ER",
                    "ES",
                    "EE",
                    "SZ",
                    "US",
                    "ET",
                    "MK",
                    "FJ",
                    "FI",
                    "FR",
                    "GA",
                    "GM",
                    "GE",
                    "GH",
                    "GR",
                    "GD",
                    "GT",
                    "GN",
                    "GQ",
                    "GW",
                    "GY",
                    "HT",
                    "HN",
                    "HU",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IS",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JO",
                    "KZ",
                    "KE",
                    "KG",
                    "KI",
                    "XK",
                    "KW",
                    "LA",
                    "LS",
                    "LV",
                    "LB",
                    "LR",
                    "LY",
                    "LI",
                    "LT",
                    "LU",
                    "MG",
                    "MY",
                    "MW",
                    "MV",
                    "ML",
                    "MT",
                    "MA",
                    "MH",
                    "MU",
                    "MR",
                    "MX",
                    "FM",
                    "MD",
                    "MC",
                    "MN",
                    "ME",
                    "MZ",
                    "NA",
                    "NR",
                    "NP",
                    "NI",
                    "NE",
                    "NG",
                    "NO",
                    "NZ",
                    "OM",
                    "UG",
                    "UZ",
                    "PK",
                    "PW",
                    "PS",
                    "PA",
                    "PG",
                    "PY",
                    "NL",
                    "PE",
                    "PH",
                    "PL",
                    "PT",
                    "QA",
                    "RO",
                    "GB",
                    "RU",
                    "RW",
                    "KN",
                    "SM",
                    "SX",
                    "VC",
                    "LC",
                    "SB",
                    "WS",
                    "ST",
                    "SN",
                    "RS",
                    "SC",
                    "SL",
                    "SG",
                    "SK",
                    "SI",
                    "SO",
                    "SD",
                    "SS",
                    "LK",
                    "SE",
                    "CH",
                    "SR",
                    "SY",
                    "TJ",
                    "TZ",
                    "TD",
                    "CZ",
                    "TH",
                    "TL",
                    "TG",
                    "TO",
                    "TT",
                    "TN",
                    "TM",
                    "TR",
                    "TV",
                    "UA",
                    "UY",
                    "VU",
                    "VA",
                    "VE",
                    "VN",
                    "YE",
                    "ZM",
                    "ZW",
                  ],
                },
                "region": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2,3}$",
                },
                "repetition_voie": {
                  "bsonType": "string",
                  "description": "Indice de répétition du numéro de voie",
                  "enum": [
                    "B",
                    "T",
                    "Q",
                    "C",
                  ],
                },
                "voie": {
                  "bsonType": "string",
                  "description": "Nom de voie",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "affelnet": {
          "anyOf": [
            {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "description": "voeux affelnet de l'apprenant",
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "code_postal_de_naissance": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
              "pattern": "^[0-9]{5}$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
        },
        "courriel": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail de contact de l'apprenant",
        },
        "date_de_naissance": {
          "anyOf": [
            {
              "bsonType": "date",
              "description": "Date de naissance de l'apprenant",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Date de naissance de l'apprenant",
        },
        "date_rqth": {
          "anyOf": [
            {
              "bsonType": "date",
              "description": "Date de la reconnaissance travailleur handicapé",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Date de la reconnaissance travailleur handicapé",
        },
        "dernier_diplome": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Dernier diplôme obtenu",
              "enum": [
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                99,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Dernier diplôme obtenu",
        },
        "dernier_organisme_uai": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
              "pattern": "^(0?[0-9][0-9]|0?2[AB]|0?9[012345]|97[1234678]|98[678]|99[0135]|[0-9]{7}[a-zA-Z])$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
        },
        "derniere_situation": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Situation de l'apprenant N-1",
              "enum": [
                1003,
                1005,
                1009,
                1017,
                1019,
                1021,
                1023,
                2001,
                2003,
                2005,
                2007,
                3001,
                3101,
                3003,
                3103,
                3009,
                3109,
                3011,
                3111,
                3031,
                3131,
                3032,
                3132,
                3033,
                3133,
                3117,
                3119,
                3021,
                3121,
                3023,
                3123,
                4001,
                4101,
                4003,
                4103,
                4005,
                4105,
                4007,
                4107,
                4009,
                4011,
                4111,
                4013,
                4113,
                4015,
                4115,
                4017,
                4117,
                4019,
                4119,
                4021,
                4121,
                4023,
                4123,
                4025,
                4125,
                4027,
                4127,
                5901,
                5903,
                5905,
                5907,
                5909,
                9900,
                9999,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Situation de l'apprenant N-1",
        },
        "has_nir": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Numéro de sécurité sociale de l'apprenant",
        },
        "historique_statut": {
          "bsonType": "array",
          "description": "Historique du statut de l'apprenant",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "abandon_forced": {
                "bsonType": [
                  "bool",
                  "null",
                ],
                "description": "Le statut a été forcé en abandon",
              },
              "date_reception": {
                "anyOf": [
                  {
                    "bsonType": "date",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "date_statut": {
                "bsonType": "date",
              },
              "valeur_statut": {
                "bsonType": "number",
                "description": "Statut de l'apprenant",
                "enum": [
                  2,
                  3,
                  0,
                ],
              },
            },
            "required": [
              "valeur_statut",
              "date_statut",
            ],
          },
        },
        "ine": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "N° INE de l'apprenant",
        },
        "inscription_sportif_haut_niveau": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Apprenant inscrit sur la liste des sportifs, entraîneurs, arbitres et juges sportifs de haut niveau",
        },
        "mineur": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "l'apprenant(e) sera-t-il(elle) mineur(e) ? (calc)",
        },
        "mineur_emancipe": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Un mineur émancipé peut accomplir seul les actes nécessitant la majorité légale.",
        },
        "nationalite": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Apprenant étranger, non citoyen européen",
              "enum": [
                1,
                2,
                3,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Apprenant étranger, non citoyen européen",
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de l'apprenant",
          "minLength": 1,
        },
        "organisme_gestionnaire": {
          "bsonType": [
            "number",
            "null",
          ],
          "description": "Relicat déprécié et non utilisé",
        },
        "parcoursup": {
          "anyOf": [
            {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "description": "voeux parcoursup de l'apprenant",
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "prenom": {
          "bsonType": "string",
          "description": "Prénom de l'apprenant",
          "minLength": 1,
        },
        "regime_scolaire": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
              "enum": [
                "I",
                "D",
                "E",
                "IE",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
        },
        "representant_legal": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "adresse": {
                  "anyOf": [
                    {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "academie": {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                        "bassinEmploi": {
                          "bsonType": "string",
                          "description": "Code Bassin d'emploi",
                        },
                        "code_insee": {
                          "bsonType": "string",
                          "description": "Le code insee doit contenir 5 caractères",
                          "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                        },
                        "code_postal": {
                          "bsonType": "string",
                          "description": "Le code postal doit contenir 5 caractères",
                          "pattern": "^[0-9]{5}$",
                        },
                        "commune": {
                          "bsonType": "string",
                          "description": "Commune",
                          "maxLength": 80,
                        },
                        "complement": {
                          "bsonType": "string",
                          "description": "Complément d'adresse",
                        },
                        "complete": {
                          "bsonType": "string",
                          "description": "Adresse complète",
                        },
                        "departement": {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                        "numero": {
                          "bsonType": "int",
                          "description": "N° de la voie",
                        },
                        "pays": {
                          "bsonType": "string",
                          "description": "Pays",
                          "enum": [
                            "AF",
                            "ZA",
                            "AL",
                            "DZ",
                            "DE",
                            "AD",
                            "AO",
                            "AG",
                            "SA",
                            "AR",
                            "AM",
                            "AU",
                            "AT",
                            "AZ",
                            "BS",
                            "BH",
                            "BD",
                            "BB",
                            "BE",
                            "BZ",
                            "BJ",
                            "BT",
                            "BY",
                            "MM",
                            "BO",
                            "BQ",
                            "BA",
                            "BW",
                            "BR",
                            "BN",
                            "BG",
                            "BF",
                            "BI",
                            "KH",
                            "CM",
                            "CA",
                            "CV",
                            "CF",
                            "CL",
                            "CN",
                            "CY",
                            "CO",
                            "KM",
                            "CG",
                            "CD",
                            "KR",
                            "KP",
                            "CR",
                            "CI",
                            "HR",
                            "CU",
                            "CW",
                            "DK",
                            "DJ",
                            "DO",
                            "DM",
                            "EG",
                            "SV",
                            "AE",
                            "EC",
                            "ER",
                            "ES",
                            "EE",
                            "SZ",
                            "US",
                            "ET",
                            "MK",
                            "FJ",
                            "FI",
                            "FR",
                            "GA",
                            "GM",
                            "GE",
                            "GH",
                            "GR",
                            "GD",
                            "GT",
                            "GN",
                            "GQ",
                            "GW",
                            "GY",
                            "HT",
                            "HN",
                            "HU",
                            "IN",
                            "ID",
                            "IR",
                            "IQ",
                            "IE",
                            "IS",
                            "IL",
                            "IT",
                            "JM",
                            "JP",
                            "JO",
                            "KZ",
                            "KE",
                            "KG",
                            "KI",
                            "XK",
                            "KW",
                            "LA",
                            "LS",
                            "LV",
                            "LB",
                            "LR",
                            "LY",
                            "LI",
                            "LT",
                            "LU",
                            "MG",
                            "MY",
                            "MW",
                            "MV",
                            "ML",
                            "MT",
                            "MA",
                            "MH",
                            "MU",
                            "MR",
                            "MX",
                            "FM",
                            "MD",
                            "MC",
                            "MN",
                            "ME",
                            "MZ",
                            "NA",
                            "NR",
                            "NP",
                            "NI",
                            "NE",
                            "NG",
                            "NO",
                            "NZ",
                            "OM",
                            "UG",
                            "UZ",
                            "PK",
                            "PW",
                            "PS",
                            "PA",
                            "PG",
                            "PY",
                            "NL",
                            "PE",
                            "PH",
                            "PL",
                            "PT",
                            "QA",
                            "RO",
                            "GB",
                            "RU",
                            "RW",
                            "KN",
                            "SM",
                            "SX",
                            "VC",
                            "LC",
                            "SB",
                            "WS",
                            "ST",
                            "SN",
                            "RS",
                            "SC",
                            "SL",
                            "SG",
                            "SK",
                            "SI",
                            "SO",
                            "SD",
                            "SS",
                            "LK",
                            "SE",
                            "CH",
                            "SR",
                            "SY",
                            "TJ",
                            "TZ",
                            "TD",
                            "CZ",
                            "TH",
                            "TL",
                            "TG",
                            "TO",
                            "TT",
                            "TN",
                            "TM",
                            "TR",
                            "TV",
                            "UA",
                            "UY",
                            "VU",
                            "VA",
                            "VE",
                            "VN",
                            "YE",
                            "ZM",
                            "ZW",
                          ],
                        },
                        "region": {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                        "repetition_voie": {
                          "bsonType": "string",
                          "description": "Indice de répétition du numéro de voie",
                          "enum": [
                            "B",
                            "T",
                            "Q",
                            "C",
                          ],
                        },
                        "voie": {
                          "bsonType": "string",
                          "description": "Nom de voie",
                        },
                      },
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "courriel": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Adresse mail de contact du representant légal",
                },
                "meme_adresse": {
                  "bsonType": [
                    "bool",
                    "null",
                  ],
                  "description": "l'apprenti(e) vit à la même adresse que son representant légal",
                },
                "nom": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Nom du representant légal",
                },
                "pcs": {
                  "anyOf": [
                    {
                      "bsonType": "number",
                      "description": "Nomenclatures des professions et catégories socioprofessionnelles",
                      "enum": [
                        10,
                        21,
                        22,
                        23,
                        31,
                        33,
                        34,
                        37,
                        38,
                        42,
                        43,
                        44,
                        45,
                        46,
                        47,
                        48,
                        52,
                        53,
                        54,
                        55,
                        56,
                        61,
                        66,
                        69,
                        71,
                        72,
                        73,
                        76,
                        81,
                        82,
                        99,
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Nomenclatures des professions et catégories socioprofessionnelles",
                },
                "prenom": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Prénom du representant légal",
                },
                "telephone": {
                  "anyOf": [
                    {
                      "bsonType": "string",
                      "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
                      "pattern": "^([+])?(\\d{7,12})$",
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "responsable_mail1": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail du responsable 1",
        },
        "responsable_mail2": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail du responsable 2",
        },
        "rqth": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Apprenant en situation d'handicape (RQTH)",
        },
        "sexe": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
              "enum": [
                "M",
                "F",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
        },
        "situation_avant_contrat": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Situation de l'apprenant avant le contrat",
              "enum": [
                11,
                12,
                21,
                31,
                41,
                51,
                52,
                53,
                54,
                90,
                99,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Situation de l'apprenant avant le contrat",
        },
        "telephone": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Téléphone de l'apprenant",
              "pattern": "^([+])?(\\d{7,12})$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Téléphone de l'apprenant",
        },
        "type_cfa": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Type de CFA",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "05",
                "06",
                "07",
                "08",
                "09",
                "10",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Type de CFA",
        },
      },
      "required": [
        "nom",
        "prenom",
        "historique_statut",
      ],
    },
    "archive": {
      "bsonType": [
        "bool",
        "null",
      ],
      "description": "Dossier apprenant est archivé (rétention maximum 5 ans)",
    },
    "contrats": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Historique des contrats de l'apprenant",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "adresse": {
                "anyOf": [
                  {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "academie": {
                        "bsonType": "string",
                        "pattern": "^[0-9]{2}$",
                      },
                      "bassinEmploi": {
                        "bsonType": "string",
                        "description": "Code Bassin d'emploi",
                      },
                      "code_insee": {
                        "bsonType": "string",
                        "description": "Le code insee doit contenir 5 caractères",
                        "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                      },
                      "code_postal": {
                        "bsonType": "string",
                        "description": "Le code postal doit contenir 5 caractères",
                        "pattern": "^[0-9]{5}$",
                      },
                      "commune": {
                        "bsonType": "string",
                        "description": "Commune",
                        "maxLength": 80,
                      },
                      "complement": {
                        "bsonType": "string",
                        "description": "Complément d'adresse",
                      },
                      "complete": {
                        "bsonType": "string",
                        "description": "Adresse complète",
                      },
                      "departement": {
                        "bsonType": "string",
                        "pattern": "^(2A|2B|[0-9]{2,3})$",
                      },
                      "numero": {
                        "bsonType": "int",
                        "description": "N° de la voie",
                      },
                      "pays": {
                        "bsonType": "string",
                        "description": "Pays",
                        "enum": [
                          "AF",
                          "ZA",
                          "AL",
                          "DZ",
                          "DE",
                          "AD",
                          "AO",
                          "AG",
                          "SA",
                          "AR",
                          "AM",
                          "AU",
                          "AT",
                          "AZ",
                          "BS",
                          "BH",
                          "BD",
                          "BB",
                          "BE",
                          "BZ",
                          "BJ",
                          "BT",
                          "BY",
                          "MM",
                          "BO",
                          "BQ",
                          "BA",
                          "BW",
                          "BR",
                          "BN",
                          "BG",
                          "BF",
                          "BI",
                          "KH",
                          "CM",
                          "CA",
                          "CV",
                          "CF",
                          "CL",
                          "CN",
                          "CY",
                          "CO",
                          "KM",
                          "CG",
                          "CD",
                          "KR",
                          "KP",
                          "CR",
                          "CI",
                          "HR",
                          "CU",
                          "CW",
                          "DK",
                          "DJ",
                          "DO",
                          "DM",
                          "EG",
                          "SV",
                          "AE",
                          "EC",
                          "ER",
                          "ES",
                          "EE",
                          "SZ",
                          "US",
                          "ET",
                          "MK",
                          "FJ",
                          "FI",
                          "FR",
                          "GA",
                          "GM",
                          "GE",
                          "GH",
                          "GR",
                          "GD",
                          "GT",
                          "GN",
                          "GQ",
                          "GW",
                          "GY",
                          "HT",
                          "HN",
                          "HU",
                          "IN",
                          "ID",
                          "IR",
                          "IQ",
                          "IE",
                          "IS",
                          "IL",
                          "IT",
                          "JM",
                          "JP",
                          "JO",
                          "KZ",
                          "KE",
                          "KG",
                          "KI",
                          "XK",
                          "KW",
                          "LA",
                          "LS",
                          "LV",
                          "LB",
                          "LR",
                          "LY",
                          "LI",
                          "LT",
                          "LU",
                          "MG",
                          "MY",
                          "MW",
                          "MV",
                          "ML",
                          "MT",
                          "MA",
                          "MH",
                          "MU",
                          "MR",
                          "MX",
                          "FM",
                          "MD",
                          "MC",
                          "MN",
                          "ME",
                          "MZ",
                          "NA",
                          "NR",
                          "NP",
                          "NI",
                          "NE",
                          "NG",
                          "NO",
                          "NZ",
                          "OM",
                          "UG",
                          "UZ",
                          "PK",
                          "PW",
                          "PS",
                          "PA",
                          "PG",
                          "PY",
                          "NL",
                          "PE",
                          "PH",
                          "PL",
                          "PT",
                          "QA",
                          "RO",
                          "GB",
                          "RU",
                          "RW",
                          "KN",
                          "SM",
                          "SX",
                          "VC",
                          "LC",
                          "SB",
                          "WS",
                          "ST",
                          "SN",
                          "RS",
                          "SC",
                          "SL",
                          "SG",
                          "SK",
                          "SI",
                          "SO",
                          "SD",
                          "SS",
                          "LK",
                          "SE",
                          "CH",
                          "SR",
                          "SY",
                          "TJ",
                          "TZ",
                          "TD",
                          "CZ",
                          "TH",
                          "TL",
                          "TG",
                          "TO",
                          "TT",
                          "TN",
                          "TM",
                          "TR",
                          "TV",
                          "UA",
                          "UY",
                          "VU",
                          "VA",
                          "VE",
                          "VN",
                          "YE",
                          "ZM",
                          "ZW",
                        ],
                      },
                      "region": {
                        "bsonType": "string",
                        "pattern": "^[0-9]{2,3}$",
                      },
                      "repetition_voie": {
                        "bsonType": "string",
                        "description": "Indice de répétition du numéro de voie",
                        "enum": [
                          "B",
                          "T",
                          "Q",
                          "C",
                        ],
                      },
                      "voie": {
                        "bsonType": "string",
                        "description": "Nom de voie",
                      },
                    },
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "cause_rupture": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Cause de rupture du contrat",
              },
              "date_debut": {
                "bsonType": "date",
                "description": "Date de début du contrat",
              },
              "date_fin": {
                "anyOf": [
                  {
                    "bsonType": "date",
                    "description": "Date de fin du contrat",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Date de fin du contrat",
              },
              "date_rupture": {
                "anyOf": [
                  {
                    "bsonType": "date",
                    "description": "Date de rupture du contrat",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Date de rupture du contrat",
              },
              "denomination": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "La dénomination sociale doit être celle de l'établissement dans lequel le contrat s'exécute.",
              },
              "naf": {
                "anyOf": [
                  {
                    "bsonType": "string",
                    "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
                    "pattern": "^[0-9]{2}\\.?[0-9]{0,2}[a-zA-Z]{0,1}$",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
              },
              "nombre_de_salaries": {
                "anyOf": [
                  {
                    "bsonType": "int",
                    "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
              },
              "siret": {
                "anyOf": [
                  {
                    "bsonType": "string",
                    "description": "N° SIRET de l'employeur",
                    "pattern": "^[0-9]{14}$",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "N° SIRET de l'employeur",
              },
              "type_employeur": {
                "anyOf": [
                  {
                    "bsonType": "number",
                    "description": "Le type d'employeur doit être en adéquation avec son statut juridique.",
                    "enum": [
                      11,
                      12,
                      13,
                      14,
                      15,
                      16,
                      21,
                      22,
                      23,
                      24,
                      25,
                      26,
                      27,
                      28,
                      29,
                      30,
                    ],
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Le type d'employeur doit être en adéquation avec son statut juridique.",
              },
            },
            "required": [
              "date_debut",
            ],
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Historique des contrats de l'apprenant",
    },
    "created_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date d'ajout en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'ajout en base de données",
    },
    "formation": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "annee": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Numéro de l'année dans la formation (promo)",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Numéro de l'année dans la formation (promo)",
            },
            "cause_exclusion": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Cause de l'exclusion",
            },
            "cfd": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code CFD de la formation",
                  "pattern": "^[A-Z0-9]{8}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code CFD de la formation",
            },
            "date_entree": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'entrée en formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'entrée en formation",
            },
            "date_exclusion": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'exclusion",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'exclusion",
            },
            "date_fin": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date de fin de la formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date de fin de la formation",
            },
            "date_inscription": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'inscription",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'inscription",
            },
            "date_obtention_diplome": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'obtention du diplôme",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'obtention du diplôme",
            },
            "duree_formation_relle": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée réelle de la formation en mois",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée réelle de la formation en mois",
            },
            "duree_theorique": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée théorique de la formation en année",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée théorique de la formation en année",
            },
            "duree_theorique_mois": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée théorique de la formation en mois",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée théorique de la formation en mois",
            },
            "formation_id": {
              "anyOf": [
                {
                  "bsonType": "objectId",
                  "description": "ID de la formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "ID de la formation",
            },
            "formation_presentielle": {
              "bsonType": [
                "bool",
                "null",
              ],
              "description": "Formation en présentiel",
            },
            "libelle_court": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Libellé court de la formation visée",
            },
            "libelle_long": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Libellé long de la formation visée",
            },
            "niveau": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "not": {},
                    },
                    {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Niveau de formation récupéré via Tables de Correspondances",
                    },
                  ],
                  "description": "Niveau de formation récupéré via Tables de Correspondances",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Niveau de formation récupéré via Tables de Correspondances",
            },
            "niveau_libelle": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "not": {},
                    },
                    {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                    },
                  ],
                  "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
            },
            "obtention_diplome": {
              "bsonType": [
                "bool",
                "null",
              ],
              "description": "Diplôme obtenu",
            },
            "periode": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "description": "Période de la formation, en année (peut être sur plusieurs années)",
                  "items": {
                    "bsonType": "int",
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Période de la formation, en année (peut être sur plusieurs années)",
            },
            "referent_handicap": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "email": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Email du référent handicap",
                    },
                    "nom": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Nom du référent handicap",
                    },
                    "prenom": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Prénom du référent handicap",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "rncp": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                  "pattern": "^(RNCP)?[0-9]{2,5}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "id_erp_apprenant": {
      "bsonType": "string",
      "description": "Identifiant de l'apprenant dans l'erp",
    },
    "is_lock": {},
    "lieu_de_formation": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "adresse": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Adresse du lieu de formation",
            },
            "code_postal": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Code postal du lieu de formation",
            },
            "siret": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "N° SIRET du lieu de formation",
                  "pattern": "^[0-9]{14}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "N° SIRET du lieu de formation",
            },
            "uai": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code UAI du lieu de formation",
                  "pattern": "^[0-9]{7}[a-zA-Z]$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code UAI du lieu de formation",
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "organisme_formateur_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Organisme formateur id",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Organisme formateur id",
    },
    "organisme_id": {
      "bsonType": "objectId",
      "description": "Organisme id (lieu de formation de l'apprenant pour la v3)",
    },
    "organisme_responsable_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Organisme responsable id",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Organisme responsable id",
    },
    "source": {
      "bsonType": "string",
      "enum": [
        "FICHIER",
        "ERP",
        "DECA",
      ],
    },
    "source_organisme_id": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "suppression": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "date": {
          "bsonType": "date",
          "description": "Date de suppression",
        },
        "description": {
          "anyOf": [
            {
              "bsonType": "string",
              "maxLength": 150,
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "motif": {
          "bsonType": "string",
          "enum": [
            "MAUVAISE_MANIP",
            "RETOUR_SCOLAIRE",
            "CHANGEMENT_CFA",
            "REFUS_CANDIDATURE",
            "AUTRE",
            "DOUBLON",
          ],
        },
        "user_id": {
          "anyOf": [
            {
              "bsonType": "objectId",
              "description": "Identifiant MongoDB de l'utilisateur responsable de la suppression",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Identifiant MongoDB de l'utilisateur responsable de la suppression",
        },
      },
      "required": [
        "motif",
        "date",
      ],
    },
    "transmitted_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de transmission de l'effectif",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de transmission de l'effectif",
    },
    "updated_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de mise à jour en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de mise à jour en base de données",
    },
    "validation_errors": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Erreurs de validation de cet effectif",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "fieldName": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Nom du champ en erreur",
              },
              "inputValue": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Valeur fournie en entrée",
              },
              "message": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Message de l'erreur",
              },
              "type": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Type d'erreur",
              },
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Erreurs de validation de cet effectif",
    },
  },
  "required": [
    "_id",
    "organisme_id",
    "id_erp_apprenant",
    "source",
    "annee_scolaire",
    "apprenant",
    "suppression",
  ],
}
`;

exports[`validation-schema > should create validation schema for effectifsDECA > effectifsDECA 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "description": "Propriétés calculées ou récupérées d'autres collections",
          "properties": {
            "formation": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "codes_rome": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "items": {
                            "bsonType": "string",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "opcos": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "items": {
                            "bsonType": "string",
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "organisme": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "academie": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "bassinEmploi": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                    },
                    "departement": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "fiable": {
                      "bsonType": [
                        "bool",
                        "null",
                      ],
                      "description": "organismes.fiabilisation_statut == "FIABLE" && ferme != false",
                    },
                    "region": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                    },
                    "reseaux": {
                      "anyOf": [
                        {
                          "bsonType": "array",
                          "description": "Réseaux du CFA, s'ils existent",
                          "items": {
                            "bsonType": "string",
                            "enum": [
                              "ADEN",
                              "CMA",
                              "AGRI",
                              "AGRI_CNEAP",
                              "AGRI_UNREP",
                              "AGRI_UNMFREO",
                              "ANASUP",
                              "AMUE",
                              "CCI",
                              "CFA_EC",
                              "COMP_DU_DEVOIR",
                              "COMP_DU_TOUR_DE_FRANCE",
                              "GRETA",
                              "UIMM",
                              "BTP_CFA",
                              "MFR",
                              "AFTRAL",
                              "GRETA_VAUCLUSE",
                              "CFA_SAT",
                              "EN_HORS_MURS",
                              "EN_CFA_ACADEMIQUE",
                              "EN_EPLE",
                              "EDUSERVICES",
                              "AFPA",
                            ],
                          },
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Réseaux du CFA, s'ils existent",
                    },
                    "siret": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "N° SIRET de l'établissement",
                          "pattern": "^[0-9]{14}$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "N° SIRET de l'établissement",
                    },
                    "uai": {
                      "anyOf": [
                        {
                          "bsonType": "string",
                          "description": "Code UAI de l'établissement",
                          "pattern": "^[0-9]{7}[a-zA-Z]$",
                        },
                        {
                          "bsonType": "null",
                        },
                      ],
                      "description": "Code UAI de l'établissement",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "statut": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "en_cours": {
                      "bsonType": "string",
                      "enum": [
                        "ABANDON",
                        "PRE_INSCRIT",
                        "INSCRIT",
                        "APPRENTI",
                        "RUPTURANT",
                        "FIN_DE_FORMATION",
                      ],
                    },
                    "parcours": {
                      "bsonType": "array",
                      "items": {
                        "additionalProperties": false,
                        "bsonType": "object",
                        "properties": {
                          "date": {
                            "bsonType": "date",
                          },
                          "valeur": {
                            "bsonType": "string",
                            "enum": [
                              "ABANDON",
                              "PRE_INSCRIT",
                              "INSCRIT",
                              "APPRENTI",
                              "RUPTURANT",
                              "FIN_DE_FORMATION",
                            ],
                          },
                        },
                        "required": [
                          "date",
                          "valeur",
                        ],
                      },
                    },
                  },
                  "required": [
                    "en_cours",
                    "parcours",
                  ],
                },
                {
                  "bsonType": "null",
                },
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Propriétés calculées ou récupérées d'autres collections",
    },
    "_id": {
      "bsonType": "objectId",
      "description": "Identifiant MongoDB de l'effectifDeca",
    },
    "annee_scolaire": {
      "bsonType": "string",
      "description": "Année scolaire sur laquelle l'apprenant est enregistré (ex: "2020-2021")",
      "pattern": "^[12][0-9]{3}-[12][0-9]{3}$",
    },
    "apprenant": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "adresse": {},
        "adresse_naissance": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2}$",
                },
                "bassinEmploi": {
                  "bsonType": "string",
                  "description": "Code Bassin d'emploi",
                },
                "code_insee": {
                  "bsonType": "string",
                  "description": "Le code insee doit contenir 5 caractères",
                  "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                },
                "code_postal": {
                  "bsonType": "string",
                  "description": "Le code postal doit contenir 5 caractères",
                  "pattern": "^[0-9]{5}$",
                },
                "commune": {
                  "bsonType": "string",
                  "description": "Commune",
                  "maxLength": 80,
                },
                "complement": {
                  "bsonType": "string",
                  "description": "Complément d'adresse",
                },
                "complete": {
                  "bsonType": "string",
                  "description": "Adresse complète",
                },
                "departement": {
                  "bsonType": "string",
                  "pattern": "^(2A|2B|[0-9]{2,3})$",
                },
                "mission_locale_id": {
                  "bsonType": [
                    "number",
                    "null",
                  ],
                  "description": "Id de mission locale",
                },
                "numero": {
                  "bsonType": "int",
                  "description": "N° de la voie",
                },
                "pays": {
                  "bsonType": "string",
                  "description": "Pays",
                  "enum": [
                    "AF",
                    "ZA",
                    "AL",
                    "DZ",
                    "DE",
                    "AD",
                    "AO",
                    "AG",
                    "SA",
                    "AR",
                    "AM",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BE",
                    "BZ",
                    "BJ",
                    "BT",
                    "BY",
                    "MM",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BR",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "KH",
                    "CM",
                    "CA",
                    "CV",
                    "CF",
                    "CL",
                    "CN",
                    "CY",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "KR",
                    "KP",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "DK",
                    "DJ",
                    "DO",
                    "DM",
                    "EG",
                    "SV",
                    "AE",
                    "EC",
                    "ER",
                    "ES",
                    "EE",
                    "SZ",
                    "US",
                    "ET",
                    "MK",
                    "FJ",
                    "FI",
                    "FR",
                    "GA",
                    "GM",
                    "GE",
                    "GH",
                    "GR",
                    "GD",
                    "GT",
                    "GN",
                    "GQ",
                    "GW",
                    "GY",
                    "HT",
                    "HN",
                    "HU",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IS",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JO",
                    "KZ",
                    "KE",
                    "KG",
                    "KI",
                    "XK",
                    "KW",
                    "LA",
                    "LS",
                    "LV",
                    "LB",
                    "LR",
                    "LY",
                    "LI",
                    "LT",
                    "LU",
                    "MG",
                    "MY",
                    "MW",
                    "MV",
                    "ML",
                    "MT",
                    "MA",
                    "MH",
                    "MU",
                    "MR",
                    "MX",
                    "FM",
                    "MD",
                    "MC",
                    "MN",
                    "ME",
                    "MZ",
                    "NA",
                    "NR",
                    "NP",
                    "NI",
                    "NE",
                    "NG",
                    "NO",
                    "NZ",
                    "OM",
                    "UG",
                    "UZ",
                    "PK",
                    "PW",
                    "PS",
                    "PA",
                    "PG",
                    "PY",
                    "NL",
                    "PE",
                    "PH",
                    "PL",
                    "PT",
                    "QA",
                    "RO",
                    "GB",
                    "RU",
                    "RW",
                    "KN",
                    "SM",
                    "SX",
                    "VC",
                    "LC",
                    "SB",
                    "WS",
                    "ST",
                    "SN",
                    "RS",
                    "SC",
                    "SL",
                    "SG",
                    "SK",
                    "SI",
                    "SO",
                    "SD",
                    "SS",
                    "LK",
                    "SE",
                    "CH",
                    "SR",
                    "SY",
                    "TJ",
                    "TZ",
                    "TD",
                    "CZ",
                    "TH",
                    "TL",
                    "TG",
                    "TO",
                    "TT",
                    "TN",
                    "TM",
                    "TR",
                    "TV",
                    "UA",
                    "UY",
                    "VU",
                    "VA",
                    "VE",
                    "VN",
                    "YE",
                    "ZM",
                    "ZW",
                  ],
                },
                "region": {
                  "bsonType": "string",
                  "pattern": "^[0-9]{2,3}$",
                },
                "repetition_voie": {
                  "bsonType": "string",
                  "description": "Indice de répétition du numéro de voie",
                  "enum": [
                    "B",
                    "T",
                    "Q",
                    "C",
                  ],
                },
                "voie": {
                  "bsonType": "string",
                  "description": "Nom de voie",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "affelnet": {
          "anyOf": [
            {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "description": "voeux affelnet de l'apprenant",
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "code_postal_de_naissance": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
              "pattern": "^[0-9]{5}$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
        },
        "courriel": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail de contact de l'apprenant",
        },
        "date_de_naissance": {
          "anyOf": [
            {
              "bsonType": "date",
              "description": "Date de naissance de l'apprenant",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Date de naissance de l'apprenant",
        },
        "date_rqth": {
          "anyOf": [
            {
              "bsonType": "date",
              "description": "Date de la reconnaissance travailleur handicapé",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Date de la reconnaissance travailleur handicapé",
        },
        "dernier_diplome": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Dernier diplôme obtenu",
              "enum": [
                1,
                2,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                99,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Dernier diplôme obtenu",
        },
        "dernier_organisme_uai": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
              "pattern": "^(0?[0-9][0-9]|0?2[AB]|0?9[012345]|97[1234678]|98[678]|99[0135]|[0-9]{7}[a-zA-Z])$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
        },
        "derniere_situation": {
          "anyOf": [
            {
              "bsonType": "number",
              "description": "Situation de l'apprenant N-1",
              "enum": [
                1003,
                1005,
                1009,
                1017,
                1019,
                1021,
                1023,
                2001,
                2003,
                2005,
                2007,
                3001,
                3101,
                3003,
                3103,
                3009,
                3109,
                3011,
                3111,
                3031,
                3131,
                3032,
                3132,
                3033,
                3133,
                3117,
                3119,
                3021,
                3121,
                3023,
                3123,
                4001,
                4101,
                4003,
                4103,
                4005,
                4105,
                4007,
                4107,
                4009,
                4011,
                4111,
                4013,
                4113,
                4015,
                4115,
                4017,
                4117,
                4019,
                4119,
                4021,
                4121,
                4023,
                4123,
                4025,
                4125,
                4027,
                4127,
                5901,
                5903,
                5905,
                5907,
                5909,
                9900,
                9999,
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Situation de l'apprenant N-1",
        },
        "has_nir": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Numéro de sécurité sociale de l'apprenant",
        },
        "historique_statut": {
          "bsonType": "array",
          "description": "Historique du statut de l'apprenant",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "abandon_forced": {
                "bsonType": [
                  "bool",
                  "null",
                ],
                "description": "Le statut a été forcé en abandon",
              },
              "date_reception": {
                "anyOf": [
                  {
                    "bsonType": "date",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "date_statut": {
                "bsonType": "date",
              },
              "valeur_statut": {
                "bsonType": "number",
                "description": "Statut de l'apprenant",
                "enum": [
                  2,
                  3,
                  0,
                ],
              },
            },
            "required": [
              "valeur_statut",
              "date_statut",
            ],
          },
        },
        "ine": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "N° INE de l'apprenant",
        },
        "inscription_sportif_haut_niveau": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Apprenant inscrit sur la liste des sportifs, entraîneurs, arbitres et juges sportifs de haut niveau",
        },
        "mineur": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "l'apprenant(e) sera-t-il(elle) mineur(e) ? (calc)",
        },
        "mineur_emancipe": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Un mineur émancipé peut accomplir seul les actes nécessitant la majorité légale.",
        },
        "nationalite": {
          "bsonType": [
            "number",
            "null",
          ],
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de l'apprenant",
          "minLength": 1,
        },
        "organisme_gestionnaire": {
          "bsonType": [
            "number",
            "null",
          ],
          "description": "Relicat déprécié et non utilisé",
        },
        "parcoursup": {
          "anyOf": [
            {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "description": "voeux parcoursup de l'apprenant",
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "prenom": {
          "bsonType": "string",
          "description": "Prénom de l'apprenant",
          "minLength": 1,
        },
        "regime_scolaire": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
              "enum": [
                "I",
                "D",
                "E",
                "IE",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
        },
        "representant_legal": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "adresse": {
                  "anyOf": [
                    {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "academie": {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                        "bassinEmploi": {
                          "bsonType": "string",
                          "description": "Code Bassin d'emploi",
                        },
                        "code_insee": {
                          "bsonType": "string",
                          "description": "Le code insee doit contenir 5 caractères",
                          "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                        },
                        "code_postal": {
                          "bsonType": "string",
                          "description": "Le code postal doit contenir 5 caractères",
                          "pattern": "^[0-9]{5}$",
                        },
                        "commune": {
                          "bsonType": "string",
                          "description": "Commune",
                          "maxLength": 80,
                        },
                        "complement": {
                          "bsonType": "string",
                          "description": "Complément d'adresse",
                        },
                        "complete": {
                          "bsonType": "string",
                          "description": "Adresse complète",
                        },
                        "departement": {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                        "numero": {
                          "bsonType": "int",
                          "description": "N° de la voie",
                        },
                        "pays": {
                          "bsonType": "string",
                          "description": "Pays",
                          "enum": [
                            "AF",
                            "ZA",
                            "AL",
                            "DZ",
                            "DE",
                            "AD",
                            "AO",
                            "AG",
                            "SA",
                            "AR",
                            "AM",
                            "AU",
                            "AT",
                            "AZ",
                            "BS",
                            "BH",
                            "BD",
                            "BB",
                            "BE",
                            "BZ",
                            "BJ",
                            "BT",
                            "BY",
                            "MM",
                            "BO",
                            "BQ",
                            "BA",
                            "BW",
                            "BR",
                            "BN",
                            "BG",
                            "BF",
                            "BI",
                            "KH",
                            "CM",
                            "CA",
                            "CV",
                            "CF",
                            "CL",
                            "CN",
                            "CY",
                            "CO",
                            "KM",
                            "CG",
                            "CD",
                            "KR",
                            "KP",
                            "CR",
                            "CI",
                            "HR",
                            "CU",
                            "CW",
                            "DK",
                            "DJ",
                            "DO",
                            "DM",
                            "EG",
                            "SV",
                            "AE",
                            "EC",
                            "ER",
                            "ES",
                            "EE",
                            "SZ",
                            "US",
                            "ET",
                            "MK",
                            "FJ",
                            "FI",
                            "FR",
                            "GA",
                            "GM",
                            "GE",
                            "GH",
                            "GR",
                            "GD",
                            "GT",
                            "GN",
                            "GQ",
                            "GW",
                            "GY",
                            "HT",
                            "HN",
                            "HU",
                            "IN",
                            "ID",
                            "IR",
                            "IQ",
                            "IE",
                            "IS",
                            "IL",
                            "IT",
                            "JM",
                            "JP",
                            "JO",
                            "KZ",
                            "KE",
                            "KG",
                            "KI",
                            "XK",
                            "KW",
                            "LA",
                            "LS",
                            "LV",
                            "LB",
                            "LR",
                            "LY",
                            "LI",
                            "LT",
                            "LU",
                            "MG",
                            "MY",
                            "MW",
                            "MV",
                            "ML",
                            "MT",
                            "MA",
                            "MH",
                            "MU",
                            "MR",
                            "MX",
                            "FM",
                            "MD",
                            "MC",
                            "MN",
                            "ME",
                            "MZ",
                            "NA",
                            "NR",
                            "NP",
                            "NI",
                            "NE",
                            "NG",
                            "NO",
                            "NZ",
                            "OM",
                            "UG",
                            "UZ",
                            "PK",
                            "PW",
                            "PS",
                            "PA",
                            "PG",
                            "PY",
                            "NL",
                            "PE",
                            "PH",
                            "PL",
                            "PT",
                            "QA",
                            "RO",
                            "GB",
                            "RU",
                            "RW",
                            "KN",
                            "SM",
                            "SX",
                            "VC",
                            "LC",
                            "SB",
                            "WS",
                            "ST",
                            "SN",
                            "RS",
                            "SC",
                            "SL",
                            "SG",
                            "SK",
                            "SI",
                            "SO",
                            "SD",
                            "SS",
                            "LK",
                            "SE",
                            "CH",
                            "SR",
                            "SY",
                            "TJ",
                            "TZ",
                            "TD",
                            "CZ",
                            "TH",
                            "TL",
                            "TG",
                            "TO",
                            "TT",
                            "TN",
                            "TM",
                            "TR",
                            "TV",
                            "UA",
                            "UY",
                            "VU",
                            "VA",
                            "VE",
                            "VN",
                            "YE",
                            "ZM",
                            "ZW",
                          ],
                        },
                        "region": {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                        "repetition_voie": {
                          "bsonType": "string",
                          "description": "Indice de répétition du numéro de voie",
                          "enum": [
                            "B",
                            "T",
                            "Q",
                            "C",
                          ],
                        },
                        "voie": {
                          "bsonType": "string",
                          "description": "Nom de voie",
                        },
                      },
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "courriel": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Adresse mail de contact du representant légal",
                },
                "meme_adresse": {
                  "bsonType": [
                    "bool",
                    "null",
                  ],
                  "description": "l'apprenti(e) vit à la même adresse que son representant légal",
                },
                "nom": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Nom du representant légal",
                },
                "pcs": {
                  "anyOf": [
                    {
                      "bsonType": "number",
                      "description": "Nomenclatures des professions et catégories socioprofessionnelles",
                      "enum": [
                        10,
                        21,
                        22,
                        23,
                        31,
                        33,
                        34,
                        37,
                        38,
                        42,
                        43,
                        44,
                        45,
                        46,
                        47,
                        48,
                        52,
                        53,
                        54,
                        55,
                        56,
                        61,
                        66,
                        69,
                        71,
                        72,
                        73,
                        76,
                        81,
                        82,
                        99,
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Nomenclatures des professions et catégories socioprofessionnelles",
                },
                "prenom": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                  "description": "Prénom du representant légal",
                },
                "telephone": {
                  "anyOf": [
                    {
                      "bsonType": "string",
                      "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
                      "pattern": "^([+])?(\\d{7,12})$",
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "responsable_mail1": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail du responsable 1",
        },
        "responsable_mail2": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Adresse mail du responsable 2",
        },
        "rqth": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Apprenant en situation d'handicape (RQTH)",
        },
        "sexe": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
              "enum": [
                "M",
                "F",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
        },
        "situation_avant_contrat": {
          "bsonType": [
            "number",
            "null",
          ],
        },
        "telephone": {
          "bsonType": [
            "string",
            "null",
          ],
        },
        "type_cfa": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Type de CFA",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "05",
                "06",
                "07",
                "08",
                "09",
                "10",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Type de CFA",
        },
      },
      "required": [
        "nom",
        "prenom",
        "historique_statut",
      ],
    },
    "archive": {
      "bsonType": [
        "bool",
        "null",
      ],
      "description": "Dossier apprenant est archivé (rétention maximum 5 ans)",
    },
    "contrats": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Historique des contrats de l'apprenant",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "adresse": {
                "anyOf": [
                  {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "academie": {
                        "bsonType": "string",
                        "pattern": "^[0-9]{2}$",
                      },
                      "bassinEmploi": {
                        "bsonType": "string",
                        "description": "Code Bassin d'emploi",
                      },
                      "code_insee": {
                        "bsonType": "string",
                        "description": "Le code insee doit contenir 5 caractères",
                        "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                      },
                      "code_postal": {
                        "bsonType": "string",
                        "description": "Le code postal doit contenir 5 caractères",
                        "pattern": "^[0-9]{5}$",
                      },
                      "commune": {
                        "bsonType": "string",
                        "description": "Commune",
                        "maxLength": 80,
                      },
                      "complement": {
                        "bsonType": "string",
                        "description": "Complément d'adresse",
                      },
                      "complete": {
                        "bsonType": "string",
                        "description": "Adresse complète",
                      },
                      "departement": {
                        "bsonType": "string",
                        "pattern": "^(2A|2B|[0-9]{2,3})$",
                      },
                      "numero": {
                        "bsonType": "int",
                        "description": "N° de la voie",
                      },
                      "pays": {
                        "bsonType": "string",
                        "description": "Pays",
                        "enum": [
                          "AF",
                          "ZA",
                          "AL",
                          "DZ",
                          "DE",
                          "AD",
                          "AO",
                          "AG",
                          "SA",
                          "AR",
                          "AM",
                          "AU",
                          "AT",
                          "AZ",
                          "BS",
                          "BH",
                          "BD",
                          "BB",
                          "BE",
                          "BZ",
                          "BJ",
                          "BT",
                          "BY",
                          "MM",
                          "BO",
                          "BQ",
                          "BA",
                          "BW",
                          "BR",
                          "BN",
                          "BG",
                          "BF",
                          "BI",
                          "KH",
                          "CM",
                          "CA",
                          "CV",
                          "CF",
                          "CL",
                          "CN",
                          "CY",
                          "CO",
                          "KM",
                          "CG",
                          "CD",
                          "KR",
                          "KP",
                          "CR",
                          "CI",
                          "HR",
                          "CU",
                          "CW",
                          "DK",
                          "DJ",
                          "DO",
                          "DM",
                          "EG",
                          "SV",
                          "AE",
                          "EC",
                          "ER",
                          "ES",
                          "EE",
                          "SZ",
                          "US",
                          "ET",
                          "MK",
                          "FJ",
                          "FI",
                          "FR",
                          "GA",
                          "GM",
                          "GE",
                          "GH",
                          "GR",
                          "GD",
                          "GT",
                          "GN",
                          "GQ",
                          "GW",
                          "GY",
                          "HT",
                          "HN",
                          "HU",
                          "IN",
                          "ID",
                          "IR",
                          "IQ",
                          "IE",
                          "IS",
                          "IL",
                          "IT",
                          "JM",
                          "JP",
                          "JO",
                          "KZ",
                          "KE",
                          "KG",
                          "KI",
                          "XK",
                          "KW",
                          "LA",
                          "LS",
                          "LV",
                          "LB",
                          "LR",
                          "LY",
                          "LI",
                          "LT",
                          "LU",
                          "MG",
                          "MY",
                          "MW",
                          "MV",
                          "ML",
                          "MT",
                          "MA",
                          "MH",
                          "MU",
                          "MR",
                          "MX",
                          "FM",
                          "MD",
                          "MC",
                          "MN",
                          "ME",
                          "MZ",
                          "NA",
                          "NR",
                          "NP",
                          "NI",
                          "NE",
                          "NG",
                          "NO",
                          "NZ",
                          "OM",
                          "UG",
                          "UZ",
                          "PK",
                          "PW",
                          "PS",
                          "PA",
                          "PG",
                          "PY",
                          "NL",
                          "PE",
                          "PH",
                          "PL",
                          "PT",
                          "QA",
                          "RO",
                          "GB",
                          "RU",
                          "RW",
                          "KN",
                          "SM",
                          "SX",
                          "VC",
                          "LC",
                          "SB",
                          "WS",
                          "ST",
                          "SN",
                          "RS",
                          "SC",
                          "SL",
                          "SG",
                          "SK",
                          "SI",
                          "SO",
                          "SD",
                          "SS",
                          "LK",
                          "SE",
                          "CH",
                          "SR",
                          "SY",
                          "TJ",
                          "TZ",
                          "TD",
                          "CZ",
                          "TH",
                          "TL",
                          "TG",
                          "TO",
                          "TT",
                          "TN",
                          "TM",
                          "TR",
                          "TV",
                          "UA",
                          "UY",
                          "VU",
                          "VA",
                          "VE",
                          "VN",
                          "YE",
                          "ZM",
                          "ZW",
                        ],
                      },
                      "region": {
                        "bsonType": "string",
                        "pattern": "^[0-9]{2,3}$",
                      },
                      "repetition_voie": {
                        "bsonType": "string",
                        "description": "Indice de répétition du numéro de voie",
                        "enum": [
                          "B",
                          "T",
                          "Q",
                          "C",
                        ],
                      },
                      "voie": {
                        "bsonType": "string",
                        "description": "Nom de voie",
                      },
                    },
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "cause_rupture": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Cause de rupture du contrat",
              },
              "date_debut": {
                "bsonType": "date",
                "description": "Date de début du contrat",
              },
              "date_fin": {
                "anyOf": [
                  {
                    "bsonType": "date",
                    "description": "Date de fin du contrat",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Date de fin du contrat",
              },
              "date_rupture": {
                "anyOf": [
                  {
                    "bsonType": "date",
                    "description": "Date de rupture du contrat",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Date de rupture du contrat",
              },
              "denomination": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "La dénomination sociale doit être celle de l'établissement dans lequel le contrat s'exécute.",
              },
              "naf": {
                "anyOf": [
                  {
                    "bsonType": "string",
                    "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
                    "pattern": "^[0-9]{2}\\.?[0-9]{0,2}[a-zA-Z]{0,1}$",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
              },
              "nombre_de_salaries": {
                "anyOf": [
                  {
                    "bsonType": "int",
                    "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
              },
              "siret": {
                "anyOf": [
                  {
                    "bsonType": "string",
                    "description": "N° SIRET de l'employeur",
                    "pattern": "^[0-9]{14}$",
                  },
                  {
                    "bsonType": "null",
                  },
                ],
                "description": "N° SIRET de l'employeur",
              },
              "type_employeur": {
                "bsonType": [
                  "number",
                  "null",
                ],
              },
            },
            "required": [
              "date_debut",
            ],
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Historique des contrats de l'apprenant",
    },
    "created_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date d'ajout en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'ajout en base de données",
    },
    "deca_raw_id": {
      "bsonType": "objectId",
      "description": "Identifiant decaraw associé à cet effectif",
    },
    "formation": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "annee": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Numéro de l'année dans la formation (promo)",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Numéro de l'année dans la formation (promo)",
            },
            "cause_exclusion": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Cause de l'exclusion",
            },
            "cfd": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "date_entree": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'entrée en formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'entrée en formation",
            },
            "date_exclusion": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'exclusion",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'exclusion",
            },
            "date_fin": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date de fin de la formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date de fin de la formation",
            },
            "date_inscription": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'inscription",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'inscription",
            },
            "date_obtention_diplome": {
              "anyOf": [
                {
                  "bsonType": "date",
                  "description": "Date d'obtention du diplôme",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Date d'obtention du diplôme",
            },
            "duree_formation_relle": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée réelle de la formation en mois",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée réelle de la formation en mois",
            },
            "duree_theorique": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée théorique de la formation en année",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée théorique de la formation en année",
            },
            "duree_theorique_mois": {
              "anyOf": [
                {
                  "bsonType": "int",
                  "description": "Durée théorique de la formation en mois",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Durée théorique de la formation en mois",
            },
            "formation_id": {
              "anyOf": [
                {
                  "bsonType": "objectId",
                  "description": "ID de la formation",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "ID de la formation",
            },
            "formation_presentielle": {
              "bsonType": [
                "bool",
                "null",
              ],
              "description": "Formation en présentiel",
            },
            "libelle_court": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Libellé court de la formation visée",
            },
            "libelle_long": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Libellé long de la formation visée",
            },
            "niveau": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "not": {},
                    },
                    {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Niveau de formation récupéré via Tables de Correspondances",
                    },
                  ],
                  "description": "Niveau de formation récupéré via Tables de Correspondances",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Niveau de formation récupéré via Tables de Correspondances",
            },
            "niveau_libelle": {
              "anyOf": [
                {
                  "anyOf": [
                    {
                      "not": {},
                    },
                    {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                    },
                  ],
                  "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
            },
            "obtention_diplome": {
              "bsonType": [
                "bool",
                "null",
              ],
              "description": "Diplôme obtenu",
            },
            "periode": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "description": "Période de la formation, en année (peut être sur plusieurs années)",
                  "items": {
                    "bsonType": "int",
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Période de la formation, en année (peut être sur plusieurs années)",
            },
            "referent_handicap": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "email": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Email du référent handicap",
                    },
                    "nom": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Nom du référent handicap",
                    },
                    "prenom": {
                      "bsonType": [
                        "string",
                        "null",
                      ],
                      "description": "Prénom du référent handicap",
                    },
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "rncp": {
              "anyOf": [
                {
                  "bsonType": "string",
                  "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
                  "pattern": "^(RNCP)?[0-9]{2,5}$",
                },
                {
                  "bsonType": "null",
                },
              ],
              "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "id_erp_apprenant": {
      "bsonType": "string",
      "description": "Identifiant de l'apprenant dans l'erp",
    },
    "is_deca_compatible": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "is_lock": {},
    "organisme_formateur_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Organisme formateur id",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Organisme formateur id",
    },
    "organisme_id": {
      "bsonType": "objectId",
      "description": "Organisme id (lieu de formation de l'apprenant pour la v3)",
    },
    "organisme_responsable_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Organisme responsable id",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Organisme responsable id",
    },
    "source": {
      "bsonType": "string",
      "description": "Source du dossier apprenant (Ymag, Gesti, TDB_MANUEL, TDB_FILE...)",
    },
    "source_organisme_id": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "updated_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de mise à jour en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de mise à jour en base de données",
    },
    "validation_errors": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Erreurs de validation de cet effectif",
          "items": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "fieldName": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Nom du champ en erreur",
              },
              "inputValue": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Valeur fournie en entrée",
              },
              "message": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Message de l'erreur",
              },
              "type": {
                "bsonType": [
                  "string",
                  "null",
                ],
                "description": "Type d'erreur",
              },
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Erreurs de validation de cet effectif",
    },
  },
  "required": [
    "_id",
    "deca_raw_id",
    "organisme_id",
    "id_erp_apprenant",
    "source",
    "annee_scolaire",
    "apprenant",
  ],
}
`;

exports[`validation-schema > should create validation schema for effectifsQueue > effectifsQueue 1`] = `
{
  "additionalProperties": true,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "adresse_apprenant": {
      "description": "Adresse de l'apprenant",
    },
    "annee_formation": {
      "description": "Numéro de l'année dans la formation (promo)",
    },
    "annee_scolaire": {
      "description": "Année scolaire sur laquelle l'apprenant est enregistré (ex: "2020-2021")",
    },
    "api_version": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Version de l'api utilisée (v2 ou v3)",
    },
    "cause_exclusion_formation": {},
    "cause_rupture_contrat": {
      "description": "Cause de rupture du contrat",
    },
    "cause_rupture_contrat_2": {
      "description": "Cause de rupture du contrat 2",
    },
    "cause_rupture_contrat_3": {
      "description": "Cause de rupture du contrat 3",
    },
    "cause_rupture_contrat_4": {
      "description": "Cause de rupture du contrat 4",
    },
    "code_commune_insee_apprenant": {
      "description": "Le code insee doit contenir 5 caractères",
    },
    "code_commune_insee_de_naissance_apprenant": {
      "description": "Le code insee doit contenir 5 caractères",
    },
    "code_postal_apprenant": {
      "description": "Code postal de l'apprenant",
    },
    "code_postal_de_naissance_apprenant": {
      "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
    },
    "contrat_date_debut": {
      "description": "Date de début du contrat",
    },
    "contrat_date_debut_2": {
      "description": "Date de début du contrat 2",
    },
    "contrat_date_debut_3": {
      "description": "Date de début du contrat 3",
    },
    "contrat_date_debut_4": {
      "description": "Date de début du contrat 4",
    },
    "contrat_date_fin": {
      "description": "Date de fin du contrat",
    },
    "contrat_date_fin_2": {
      "description": "Date de fin du contrat 2",
    },
    "contrat_date_fin_3": {
      "description": "Date de fin du contrat 3",
    },
    "contrat_date_fin_4": {
      "description": "Date de fin du contrat 4",
    },
    "contrat_date_rupture": {
      "description": "Date de rupture du contrat",
    },
    "contrat_date_rupture_2": {
      "description": "Date de rupture du contrat 2",
    },
    "contrat_date_rupture_3": {
      "description": "Date de rupture du contrat 3",
    },
    "contrat_date_rupture_4": {
      "description": "Date de rupture du contrat 4",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "date_de_naissance_apprenant": {
      "description": "Date de naissance de l'apprenant",
    },
    "date_entree_formation": {
      "description": "Date d'entrée en formation",
    },
    "date_exclusion_formation": {},
    "date_fin_formation": {
      "description": "Date de fin de la formation",
    },
    "date_inscription_formation": {
      "description": "Date d'inscription",
    },
    "date_metier_mise_a_jour_statut": {},
    "date_obtention_diplome_formation": {
      "description": "Date d'obtention du diplôme",
    },
    "date_rqth_apprenant": {
      "description": "Date de reconnaissance du RQTH de l'apprenant",
    },
    "dernier_organisme_uai": {
      "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation ou département",
    },
    "derniere_situation": {
      "description": "Situation de l'apprenant N-1",
    },
    "duree_theorique_formation": {
      "description": "Durée théorique de la formation en années",
    },
    "duree_theorique_formation_mois": {
      "description": "Durée théorique de la formation en mois",
    },
    "effectif_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Id de l'effectif associé",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Id de l'effectif associé",
    },
    "email_contact": {
      "description": "Adresse mail de contact de l'apprenant",
    },
    "email_referent_handicap_formation": {},
    "error": {
      "anyOf": [
        {
          "description": "Erreur rencontrée lors de la création de l'effectif",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Erreur rencontrée lors de la création de l'effectif",
    },
    "etablissement_formateur_siret": {
      "description": "SIRET de l'établissement formateur",
    },
    "etablissement_formateur_uai": {
      "description": "UAI de l'établissement formateur",
    },
    "etablissement_lieu_de_formation_adresse": {
      "description": "Adresse du lieu de formation",
    },
    "etablissement_lieu_de_formation_code_postal": {
      "description": "Code postal du lieu de formation",
    },
    "etablissement_lieu_de_formation_siret": {
      "description": "SIRET de l'établissement (lieu de formation)",
    },
    "etablissement_lieu_de_formation_uai": {
      "description": "UAI de l'établissement (lieu de formation)",
    },
    "etablissement_responsable_siret": {
      "description": "SIRET de l'établissement responsable",
    },
    "etablissement_responsable_uai": {
      "description": "UAI de l'établissement responsable",
    },
    "formation_cfd": {
      "description": "Code CFD de la formation",
    },
    "formation_presentielle": {
      "description": "Formation 100% à distance ou non",
    },
    "formation_rncp": {
      "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
    },
    "has_nir": {
      "bsonType": [
        "bool",
        "null",
      ],
      "description": "Identification nationale securité social",
    },
    "id_erp_apprenant": {
      "description": "Identifiant de l'apprenant dans l'erp",
    },
    "id_formation": {
      "description": "Code CFD de la formation",
    },
    "ine_apprenant": {
      "description": "N° INE de l'apprenant",
    },
    "libelle_court_formation": {},
    "libelle_long_formation": {
      "description": "Libellé long de la formation visée",
    },
    "nom_apprenant": {
      "description": "Nom de l'apprenant",
    },
    "nom_etablissement": {
      "description": "Nom de l'organisme de formation",
    },
    "nom_referent_handicap_formation": {},
    "obtention_diplome_formation": {},
    "organisme_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Id de l'organisme associé",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Id de l'organisme associé",
    },
    "periode_formation": {
      "description": "Période de la formation, en année (peut être sur plusieurs années)",
    },
    "prenom_apprenant": {
      "description": "Prénom de l'apprenant",
    },
    "prenom_referent_handicap_formation": {},
    "processed_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de process des données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de process des données",
    },
    "responsable_apprenant_mail1": {
      "description": "Mail du responsable de l'apprenant",
    },
    "responsable_apprenant_mail2": {
      "description": "Mail du responsable de l'apprenant",
    },
    "rqth_apprenant": {
      "description": "Reconnaissance de la Qualité de Travailleur Handicapé de l'apprenant",
    },
    "sexe_apprenant": {
      "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
    },
    "siret_employeur": {
      "description": "N° SIRET de l'établissement",
    },
    "siret_employeur_2": {
      "description": "N° SIRET de l'établissement",
    },
    "siret_employeur_3": {
      "description": "N° SIRET de l'établissement",
    },
    "siret_employeur_4": {
      "description": "N° SIRET de l'établissement",
    },
    "siret_etablissement": {
      "description": "N° SIRET de l'établissement",
    },
    "source": {
      "bsonType": "string",
      "enum": [
        "FICHIER",
        "ERP",
        "DECA",
      ],
    },
    "source_organisme_id": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "statut_apprenant": {
      "description": "0,2,3",
    },
    "tel_apprenant": {
      "description": "Téléphone de l'apprenant",
    },
    "type_cfa": {
      "description": "Type de CFA (nomenclature SIFA)",
    },
    "uai_etablissement": {
      "description": "Code UAI de l'établissement",
    },
    "updated_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de mise à jour en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de mise à jour en base de données",
    },
    "user_erp_id": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Id de l'utilisateur ERP",
    },
    "validation_errors": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Erreurs de validation de cet effectif",
          "items": {
            "additionalProperties": true,
            "bsonType": "object",
            "properties": {
              "message": {
                "description": "message d'erreur",
              },
              "path": {
                "description": "champ en erreur",
              },
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Erreurs de validation de cet effectif",
    },
  },
  "required": [
    "_id",
    "source",
    "created_at",
  ],
}
`;

exports[`validation-schema > should create validation schema for formationV2 > formationV2 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "cfd": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "created_at": {
      "bsonType": "date",
    },
    "draft": {
      "bsonType": "bool",
    },
    "organisme_formateur_id": {
      "bsonType": "objectId",
    },
    "organisme_responsable_id": {
      "bsonType": "objectId",
    },
    "rncp": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "updated_at": {
      "bsonType": "date",
    },
  },
  "required": [
    "_id",
    "draft",
    "created_at",
    "updated_at",
    "organisme_responsable_id",
    "organisme_formateur_id",
  ],
}
`;

exports[`validation-schema > should create validation schema for formations > formations 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "annee": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Année de la formation (cursus)",
    },
    "cfd": {
      "bsonType": "string",
      "description": "Code CFD de la formation",
      "pattern": "^[A-Z0-9]{8}$",
    },
    "cfd_end_date": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de fermeture du CFD",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de fermeture du CFD",
    },
    "cfd_start_date": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date d'ouverture du CFD",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'ouverture du CFD",
    },
    "created_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date d'ajout en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'ajout en base de données",
    },
    "duree": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Durée de la formation théorique",
    },
    "libelle": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Libellé normalisé depuis Tables de Correspondances",
    },
    "metiers": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Les domaines métiers rattachés à la formation",
          "items": {
            "bsonType": "string",
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Les domaines métiers rattachés à la formation",
    },
    "niveau": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Niveau de formation récupéré via Tables de Correspondances",
    },
    "niveau_libelle": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
    },
    "rncps": {
      "anyOf": [
        {
          "bsonType": "array",
          "description": "Liste des codes RNCPs de la formation récupéré depuis Tables de Correspondances",
          "items": {
            "bsonType": "string",
          },
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Liste des codes RNCPs de la formation récupéré depuis Tables de Correspondances",
    },
    "updated_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date d'update en base de données",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'update en base de données",
    },
  },
  "required": [
    "_id",
    "cfd",
  ],
}
`;

exports[`validation-schema > should create validation schema for formationsCatalogue > formationsCatalogue 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "annee": {
      "bsonType": "string",
    },
    "annee_incoherente": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "cfd": {
      "bsonType": "string",
    },
    "cfd_date_fermeture": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "cfd_outdated": {
      "bsonType": "bool",
    },
    "cle_ministere_educatif": {
      "bsonType": "string",
    },
    "code_commune_insee": {
      "bsonType": "string",
    },
    "code_postal": {
      "bsonType": "string",
    },
    "created_at": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "date_debut": {
      "anyOf": [
        {
          "bsonType": "array",
          "items": {
            "bsonType": "string",
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "date_fin": {
      "anyOf": [
        {
          "bsonType": "array",
          "items": {
            "bsonType": "string",
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "diplome": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "duree": {
      "bsonType": "string",
    },
    "duree_incoherente": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "entierement_a_distance": {
      "bsonType": "bool",
    },
    "etablissement_formateur_adresse": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_certifie_qualite": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_formateur_code_postal": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_date_creation": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_enseigne": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_entreprise_raison_sociale": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_habilite_rncp": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_formateur_localite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_siret": {
      "bsonType": "string",
    },
    "etablissement_formateur_uai": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_adresse": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_certifie_qualite": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_gestionnaire_code_commune_insee": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_code_postal": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_date_creation": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_enseigne": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_entreprise_raison_sociale": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_habilite_rncp": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_gestionnaire_localite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_nom_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_num_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_num_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_region": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_siret": {
      "bsonType": "string",
    },
    "etablissement_gestionnaire_uai": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "id_formation": {
      "bsonType": "string",
    },
    "intitule_court": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "intitule_long": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "libelle_court": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "lieu_formation_adresse": {
      "bsonType": "string",
    },
    "lieu_formation_siret": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "localite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "niveau": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "niveau_entree_obligatoire": {
      "bsonType": [
        "number",
        "null",
      ],
    },
    "niveau_formation_diplome": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "nom": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "nom_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "nom_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "num_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "num_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_discipline": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_domaine_sousdomaine": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_intitule": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_libelle_poursuite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_lien_site_onisepfr": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_url": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "periode": {
      "anyOf": [
        {
          "bsonType": "array",
          "items": {
            "anyOf": [
              {
                "not": {},
              },
              {
                "bsonType": [
                  "string",
                  "null",
                ],
              },
            ],
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "region": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "rncp_code": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "rncp_details": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "active_inactive": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "date_fin_validite_enregistrement": {
              "bsonType": [
                "string",
                "null",
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "rncp_eligible_apprentissage": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "rncp_intitule": {
      "bsonType": [
        "string",
        "null",
      ],
    },
  },
  "required": [
    "_id",
    "cle_ministere_educatif",
    "cfd",
    "cfd_outdated",
    "code_postal",
    "code_commune_insee",
    "rncp_code",
    "duree",
    "annee",
    "lieu_formation_adresse",
    "id_formation",
    "niveau_entree_obligatoire",
    "entierement_a_distance",
    "etablissement_gestionnaire_siret",
    "etablissement_gestionnaire_uai",
    "etablissement_formateur_siret",
    "etablissement_formateur_uai",
  ],
}
`;

exports[`validation-schema > should create validation schema for invitations > invitations 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "author_id": {
      "bsonType": "objectId",
      "description": "Auteur de l'invitation",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date de création en base de données",
    },
    "email": {
      "bsonType": "string",
      "description": "Email destinataire",
    },
    "organisation_id": {
      "bsonType": "objectId",
      "description": "Organisation cible de l'invitation",
    },
    "token": {
      "bsonType": "string",
      "description": "Jeton d'invitation",
    },
  },
  "required": [
    "_id",
    "token",
    "email",
    "organisation_id",
    "author_id",
    "created_at",
  ],
}
`;

exports[`validation-schema > should create validation schema for jwtSessions > jwtSessions 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "jwt": {
      "bsonType": "string",
      "description": "Session token",
    },
  },
  "required": [
    "_id",
    "jwt",
  ],
}
`;

exports[`validation-schema > should create validation schema for maintenanceMessages > maintenanceMessages 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "context": {
      "bsonType": "string",
      "enum": [
        "manuel",
        "automatique",
        "maintenance",
      ],
    },
    "enabled": {
      "bsonType": "bool",
      "description": "Message actif ou non",
    },
    "msg": {
      "bsonType": "string",
      "description": "Message de maintenance",
    },
    "name": {
      "bsonType": "string",
      "description": "email du créateur du message",
    },
    "time": {
      "bsonType": "date",
      "description": "Date de mise en place du message",
    },
    "type": {
      "bsonType": "string",
      "enum": [
        "alert",
        "info",
      ],
    },
  },
  "required": [
    "_id",
    "msg",
    "name",
    "type",
    "context",
  ],
}
`;

exports[`validation-schema > should create validation schema for missionLocaleEffectif > missionLocaleEffectif 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "commentaires": {
      "bsonType": "string",
      "maxLength": 200,
    },
    "effectif_id": {
      "bsonType": "objectId",
    },
    "inscrit_france_travail": {
      "bsonType": "string",
      "enum": [
        "OUI",
        "NON",
        "INCONNU",
      ],
    },
    "mission_locale_id": {
      "bsonType": "objectId",
    },
    "situation": {
      "bsonType": "string",
      "enum": [
        "CONTACTE_AVEC_SUIVI",
        "CONTACT_SANS_SUIVI",
        "DEJA_SUIVI",
        "INJOIGNABLE",
        "NON_CONTACTE",
      ],
    },
    "situation_updated_at": {
      "bsonType": "date",
    },
    "statut_correct": {
      "bsonType": "bool",
    },
    "statut_reel": {
      "anyOf": [
        {
          "bsonType": "string",
          "enum": [
            "CONTRAT_SIGNE_NON_DEMARRE",
            "RETOUR_EN_VOIE_SCOLAIRE",
            "ABANDON",
            "RUPTURE",
            "DECROCHAGE",
            "AUTRE",
          ],
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "statut_reel_text": {
      "bsonType": "string",
      "maxLength": 150,
    },
  },
  "required": [
    "_id",
    "mission_locale_id",
    "effectif_id",
  ],
}
`;

exports[`validation-schema > should create validation schema for missionLocaleEffectifLogs > missionLocaleEffectifLogs 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "created_at": {
      "bsonType": "date",
    },
    "mission_locale_effectif_id": {
      "bsonType": "objectId",
    },
    "payload": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "commentaires": {
          "bsonType": "string",
          "maxLength": 200,
        },
        "inscrit_france_travail": {
          "bsonType": "string",
          "enum": [
            "OUI",
            "NON",
            "INCONNU",
          ],
        },
        "situation": {
          "bsonType": "string",
          "enum": [
            "CONTACTE_AVEC_SUIVI",
            "CONTACT_SANS_SUIVI",
            "DEJA_SUIVI",
            "INJOIGNABLE",
            "NON_CONTACTE",
          ],
        },
        "statut_correct": {
          "bsonType": "bool",
        },
        "statut_reel": {
          "anyOf": [
            {
              "bsonType": "string",
              "enum": [
                "CONTRAT_SIGNE_NON_DEMARRE",
                "RETOUR_EN_VOIE_SCOLAIRE",
                "ABANDON",
                "RUPTURE",
                "DECROCHAGE",
                "AUTRE",
              ],
            },
            {
              "bsonType": "null",
            },
          ],
        },
        "statut_reel_text": {
          "bsonType": "string",
          "maxLength": 150,
        },
      },
    },
  },
  "required": [
    "_id",
    "created_at",
    "mission_locale_effectif_id",
    "payload",
  ],
}
`;

exports[`validation-schema > should create validation schema for opcoRncp > opcoRncp 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "opco": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "nom",
          ],
        },
        "rncp": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
          ],
        },
      },
      "required": [
        "opco",
        "rncp",
      ],
    },
    "_id": {
      "bsonType": "objectId",
    },
    "opco_id": {
      "bsonType": "objectId",
    },
    "rncp_id": {
      "bsonType": "objectId",
    },
  },
  "required": [
    "_id",
    "opco_id",
    "rncp_id",
    "_computed",
  ],
}
`;

exports[`validation-schema > should create validation schema for opcos > opcos 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "name": {
      "bsonType": "string",
    },
  },
  "required": [
    "_id",
    "name",
  ],
}
`;

exports[`validation-schema > should create validation schema for organisations > organisations 1`] = `
{
  "anyOf": [
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "ml_id": {
          "bsonType": "number",
          "description": "Identifiant de la mission locale",
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de la mission locale",
        },
        "siret": {
          "bsonType": "string",
          "description": "N° SIRET",
          "pattern": "^[0-9]{14}$",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "nom",
        "siret",
        "ml_id",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "organisme_id": {
          "bsonType": "string",
          "description": "Identifiant de l'organisme",
        },
        "siret": {
          "bsonType": "string",
          "description": "N° SIRET",
          "pattern": "^[0-9]{14}$",
        },
        "type": {
          "bsonType": "string",
        },
        "uai": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Code UAI de l'organisme (seulement pour les utilisateurs OF)",
              "pattern": "^[0-9]{7}[a-zA-Z]$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Code UAI de l'organisme (seulement pour les utilisateurs OF)",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "siret",
        "uai",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "reseau": {
          "bsonType": "string",
          "description": "Réseau du CFA, s'il existe",
          "enum": [
            "ADEN",
            "CMA",
            "AGRI",
            "AGRI_CNEAP",
            "AGRI_UNREP",
            "AGRI_UNMFREO",
            "ANASUP",
            "AMUE",
            "CCI",
            "CFA_EC",
            "COMP_DU_DEVOIR",
            "COMP_DU_TOUR_DE_FRANCE",
            "GRETA",
            "UIMM",
            "BTP_CFA",
            "MFR",
            "AFTRAL",
            "GRETA_VAUCLUSE",
            "CFA_SAT",
            "EN_HORS_MURS",
            "EN_CFA_ACADEMIQUE",
            "EN_EPLE",
            "EDUSERVICES",
            "AFPA",
          ],
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "reseau",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "code_region": {
          "bsonType": "string",
          "description": "Code région",
          "enum": [
            "11",
            "24",
            "27",
            "28",
            "32",
            "44",
            "52",
            "53",
            "75",
            "76",
            "84",
            "93",
            "94",
            "975",
            "977",
            "978",
            "984",
            "986",
            "987",
            "988",
            "989",
            "01",
            "02",
            "03",
            "04",
            "06",
          ],
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
          "enum": [
            "DREETS",
            "DRAAF",
            "CONSEIL_REGIONAL",
            "CARIF_OREF_REGIONAL",
            "DRAFPIC",
          ],
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "code_region",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "code_departement": {
          "bsonType": "string",
          "enum": [
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "21",
            "22",
            "23",
            "24",
            "25",
            "26",
            "27",
            "28",
            "29",
            "30",
            "31",
            "32",
            "33",
            "34",
            "35",
            "36",
            "37",
            "38",
            "39",
            "40",
            "41",
            "42",
            "43",
            "44",
            "45",
            "46",
            "47",
            "48",
            "49",
            "50",
            "51",
            "52",
            "53",
            "54",
            "55",
            "56",
            "57",
            "58",
            "59",
            "60",
            "61",
            "62",
            "63",
            "64",
            "65",
            "66",
            "67",
            "68",
            "69",
            "70",
            "71",
            "72",
            "73",
            "74",
            "75",
            "76",
            "77",
            "78",
            "79",
            "80",
            "81",
            "82",
            "83",
            "84",
            "85",
            "86",
            "87",
            "88",
            "89",
            "90",
            "91",
            "92",
            "93",
            "94",
            "95",
            "971",
            "972",
            "973",
            "974",
            "975",
            "976",
            "977",
            "978",
            "984",
            "986",
            "987",
            "988",
            "989",
            "01",
            "02",
            "03",
            "04",
            "05",
            "06",
            "07",
            "08",
            "09",
            "2A",
            "2B",
          ],
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "code_departement",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "code_academie": {
          "bsonType": "string",
          "description": "Code académie",
          "enum": [
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20",
            "22",
            "23",
            "24",
            "25",
            "27",
            "28",
            "31",
            "32",
            "33",
            "40",
            "41",
            "42",
            "43",
            "44",
            "70",
            "00",
            "01",
            "02",
            "03",
            "04",
            "06",
            "07",
            "08",
            "09",
          ],
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "code_academie",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de l'organisation nationale",
          "enum": [
            "Services de la Première ministre",
            "Ministère de l'Agriculture et de la Souveraineté alimentaire",
            "Ministère des Armées",
            "Ministère de la Culture",
            "Ministère de l'Économie, des Finances et de la Souveraineté industrielle et numérique",
            "Ministère de l'Éducation nationale et de la Jeunesse",
            "Ministère de l'Enseignement supérieur et de la Recherche",
            "Ministère de l'Europe et des Affaires étrangères",
            "Ministère de l'Intérieur et des Outre-mer",
            "Ministère de la Justice",
            "Ministère de la Santé et de la Prévention",
            "Ministère des Solidarités, de l'Autonomie et des Personnes handicapées",
            "Ministère des Sports et des Jeux Olympiques et Paralympiques",
            "Ministère de la Transformation et de la Fonction publiques",
            "Ministère de la Transition écologique et de la Cohésion des territoires",
            "Ministère de la Transition énergétique",
            "Ministère du Travail, du Plein emploi et de l'Insertion",
          ],
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "nom",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
      ],
    },
  ],
}
`;

exports[`validation-schema > should create validation schema for organismeV2 > organismeV2 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "created_at": {
      "bsonType": "date",
    },
    "current_organisme_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant unique",
    },
    "draft": {
      "bsonType": "bool",
    },
    "siret": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "uai": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "updated_at": {
      "bsonType": "date",
    },
  },
  "required": [
    "_id",
    "draft",
    "created_at",
    "updated_at",
  ],
}
`;

exports[`validation-schema > should create validation schema for organismes > organismes 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "access_token": {
      "bsonType": "string",
      "description": "Le token permettant l'accès au CFA à sa propre page",
    },
    "adresse": {
      "additionalProperties": false,
      "bsonType": "object",
      "description": "Adresse de l'établissement",
      "properties": {
        "academie": {
          "bsonType": "string",
          "pattern": "^[0-9]{2}$",
        },
        "bassinEmploi": {
          "bsonType": "string",
          "description": "Code Bassin d'emploi",
        },
        "code_insee": {
          "bsonType": "string",
          "description": "Le code insee doit contenir 5 caractères",
          "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
        },
        "code_postal": {
          "bsonType": "string",
          "description": "Le code postal doit contenir 5 caractères",
          "pattern": "^[0-9]{5}$",
        },
        "commune": {
          "bsonType": "string",
          "description": "Commune",
          "maxLength": 80,
        },
        "complement": {
          "bsonType": "string",
          "description": "Complément d'adresse",
        },
        "complete": {
          "bsonType": "string",
          "description": "Adresse complète",
        },
        "departement": {
          "bsonType": "string",
          "pattern": "^(2A|2B|[0-9]{2,3})$",
        },
        "numero": {
          "bsonType": "int",
          "description": "N° de la voie",
        },
        "pays": {
          "bsonType": "string",
          "description": "Pays",
          "enum": [
            "AF",
            "ZA",
            "AL",
            "DZ",
            "DE",
            "AD",
            "AO",
            "AG",
            "SA",
            "AR",
            "AM",
            "AU",
            "AT",
            "AZ",
            "BS",
            "BH",
            "BD",
            "BB",
            "BE",
            "BZ",
            "BJ",
            "BT",
            "BY",
            "MM",
            "BO",
            "BQ",
            "BA",
            "BW",
            "BR",
            "BN",
            "BG",
            "BF",
            "BI",
            "KH",
            "CM",
            "CA",
            "CV",
            "CF",
            "CL",
            "CN",
            "CY",
            "CO",
            "KM",
            "CG",
            "CD",
            "KR",
            "KP",
            "CR",
            "CI",
            "HR",
            "CU",
            "CW",
            "DK",
            "DJ",
            "DO",
            "DM",
            "EG",
            "SV",
            "AE",
            "EC",
            "ER",
            "ES",
            "EE",
            "SZ",
            "US",
            "ET",
            "MK",
            "FJ",
            "FI",
            "FR",
            "GA",
            "GM",
            "GE",
            "GH",
            "GR",
            "GD",
            "GT",
            "GN",
            "GQ",
            "GW",
            "GY",
            "HT",
            "HN",
            "HU",
            "IN",
            "ID",
            "IR",
            "IQ",
            "IE",
            "IS",
            "IL",
            "IT",
            "JM",
            "JP",
            "JO",
            "KZ",
            "KE",
            "KG",
            "KI",
            "XK",
            "KW",
            "LA",
            "LS",
            "LV",
            "LB",
            "LR",
            "LY",
            "LI",
            "LT",
            "LU",
            "MG",
            "MY",
            "MW",
            "MV",
            "ML",
            "MT",
            "MA",
            "MH",
            "MU",
            "MR",
            "MX",
            "FM",
            "MD",
            "MC",
            "MN",
            "ME",
            "MZ",
            "NA",
            "NR",
            "NP",
            "NI",
            "NE",
            "NG",
            "NO",
            "NZ",
            "OM",
            "UG",
            "UZ",
            "PK",
            "PW",
            "PS",
            "PA",
            "PG",
            "PY",
            "NL",
            "PE",
            "PH",
            "PL",
            "PT",
            "QA",
            "RO",
            "GB",
            "RU",
            "RW",
            "KN",
            "SM",
            "SX",
            "VC",
            "LC",
            "SB",
            "WS",
            "ST",
            "SN",
            "RS",
            "SC",
            "SL",
            "SG",
            "SK",
            "SI",
            "SO",
            "SD",
            "SS",
            "LK",
            "SE",
            "CH",
            "SR",
            "SY",
            "TJ",
            "TZ",
            "TD",
            "CZ",
            "TH",
            "TL",
            "TG",
            "TO",
            "TT",
            "TN",
            "TM",
            "TR",
            "TV",
            "UA",
            "UY",
            "VU",
            "VA",
            "VE",
            "VN",
            "YE",
            "ZM",
            "ZW",
          ],
        },
        "region": {
          "bsonType": "string",
          "pattern": "^[0-9]{2,3}$",
        },
        "repetition_voie": {
          "bsonType": "string",
          "description": "Indice de répétition du numéro de voie",
          "enum": [
            "B",
            "T",
            "Q",
            "C",
          ],
        },
        "voie": {
          "bsonType": "string",
          "description": "Nom de voie",
        },
      },
    },
    "api_configuration_date": {
      "bsonType": "date",
      "description": "Date de l'interfaçage",
    },
    "api_key": {
      "bsonType": "string",
      "description": "API key pour envoi de données",
    },
    "api_siret": {
      "bsonType": "string",
      "description": "Siret envoyé par l'erp",
    },
    "api_uai": {
      "bsonType": "string",
      "description": "Uai envoyé par l'erp",
    },
    "api_version": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Version de l'api utilisée (v2 ou v3)",
    },
    "contacts_from_referentiel": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "confirmé": {
            "bsonType": "bool",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "email": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
        },
      },
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "effectifs_count": {
      "bsonType": "int",
      "description": "Compteur sur le nombre d'effectifs de l'organisme",
    },
    "effectifs_current_year_count": {
      "bsonType": "int",
      "description": "Compteur sur le nombre d'effectifs de l'organisme sur l'année courante",
    },
    "enseigne": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Enseigne de l'organisme de formation",
    },
    "erp_unsupported": {
      "bsonType": "string",
      "description": "ERP renseigné par l'utilisateur à la configuration quand il n'est pas supporté",
    },
    "erps": {
      "bsonType": "array",
      "description": "ERPs rattachés au CFA, s'ils existent",
      "items": {
        "bsonType": "string",
      },
    },
    "est_dans_le_referentiel": {
      "bsonType": "string",
      "description": "Présence dans le referentiel ONISEP des organismes",
      "enum": [
        "absent",
        "present",
        "present_uai_multiples_dans_tdb",
      ],
    },
    "ferme": {
      "bsonType": "bool",
      "description": "Le siret est fermé",
    },
    "fiabilisation_api_response": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "description": "Statut du siret et uai venant de l'API de l'organisme",
          "properties": {
            "candidats": {
              "bsonType": "array",
              "items": {
                "additionalProperties": false,
                "bsonType": "object",
                "properties": {
                  "correspondances": {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "siret": {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "lui_meme": {
                                "bsonType": "bool",
                              },
                              "son_formateur": {
                                "bsonType": "bool",
                              },
                              "son_responsable": {
                                "bsonType": "bool",
                              },
                            },
                            "required": [
                              "son_formateur",
                              "son_responsable",
                              "lui_meme",
                            ],
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                      "uai": {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "lui_meme": {
                                "bsonType": "bool",
                              },
                              "son_lieu": {
                                "bsonType": "bool",
                              },
                            },
                            "required": [
                              "lui_meme",
                              "son_lieu",
                            ],
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                    },
                    "required": [
                      "uai",
                      "siret",
                    ],
                  },
                  "organisme": {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "identifiant": {
                        "additionalProperties": false,
                        "bsonType": "object",
                        "properties": {
                          "siret": {
                            "bsonType": "string",
                            "pattern": "^\\d{9,14}$",
                          },
                          "uai": {
                            "anyOf": [
                              {
                                "bsonType": "string",
                                "pattern": "^\\d{1,7}[A-Z]$",
                              },
                              {
                                "bsonType": "null",
                              },
                            ],
                          },
                        },
                        "required": [
                          "uai",
                          "siret",
                        ],
                      },
                    },
                    "required": [
                      "identifiant",
                    ],
                  },
                  "status": {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "declaration_catalogue": {
                        "bsonType": "bool",
                      },
                      "ouvert": {
                        "bsonType": "bool",
                      },
                      "validation_uai": {
                        "bsonType": "bool",
                      },
                    },
                    "required": [
                      "ouvert",
                      "declaration_catalogue",
                      "validation_uai",
                    ],
                  },
                },
                "required": [
                  "status",
                  "correspondances",
                  "organisme",
                ],
              },
            },
            "metadata": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "siret": {
                  "anyOf": [
                    {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "status": {
                          "bsonType": "string",
                          "enum": [
                            "inconnu",
                            "fermé",
                            "ok",
                          ],
                        },
                      },
                      "required": [
                        "status",
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "uai": {
                  "anyOf": [
                    {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "status": {
                          "bsonType": "string",
                          "enum": [
                            "inconnu",
                            "ok",
                          ],
                        },
                      },
                      "required": [
                        "status",
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
              },
              "required": [
                "uai",
                "siret",
              ],
            },
            "resultat": {
              "anyOf": [
                {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "properties": {
                    "correspondances": {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "siret": {
                          "anyOf": [
                            {
                              "additionalProperties": false,
                              "bsonType": "object",
                              "properties": {
                                "lui_meme": {
                                  "bsonType": "bool",
                                },
                                "son_formateur": {
                                  "bsonType": "bool",
                                },
                                "son_responsable": {
                                  "bsonType": "bool",
                                },
                              },
                              "required": [
                                "son_formateur",
                                "son_responsable",
                                "lui_meme",
                              ],
                            },
                            {
                              "bsonType": "null",
                            },
                          ],
                        },
                        "uai": {
                          "anyOf": [
                            {
                              "additionalProperties": false,
                              "bsonType": "object",
                              "properties": {
                                "lui_meme": {
                                  "bsonType": "bool",
                                },
                                "son_lieu": {
                                  "bsonType": "bool",
                                },
                              },
                              "required": [
                                "lui_meme",
                                "son_lieu",
                              ],
                            },
                            {
                              "bsonType": "null",
                            },
                          ],
                        },
                      },
                      "required": [
                        "uai",
                        "siret",
                      ],
                    },
                    "organisme": {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "identifiant": {
                          "additionalProperties": false,
                          "bsonType": "object",
                          "properties": {
                            "siret": {
                              "bsonType": "string",
                              "pattern": "^\\d{9,14}$",
                            },
                            "uai": {
                              "anyOf": [
                                {
                                  "bsonType": "string",
                                  "pattern": "^\\d{1,7}[A-Z]$",
                                },
                                {
                                  "bsonType": "null",
                                },
                              ],
                            },
                          },
                          "required": [
                            "uai",
                            "siret",
                          ],
                        },
                      },
                      "required": [
                        "identifiant",
                      ],
                    },
                    "status": {
                      "additionalProperties": false,
                      "bsonType": "object",
                      "properties": {
                        "declaration_catalogue": {
                          "bsonType": "bool",
                        },
                        "ouvert": {
                          "bsonType": "bool",
                        },
                        "validation_uai": {
                          "bsonType": "bool",
                        },
                      },
                      "required": [
                        "ouvert",
                        "declaration_catalogue",
                        "validation_uai",
                      ],
                    },
                  },
                  "required": [
                    "status",
                    "correspondances",
                    "organisme",
                  ],
                },
                {
                  "bsonType": "null",
                },
              ],
            },
          },
          "required": [
            "metadata",
            "resultat",
            "candidats",
          ],
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Statut du siret et uai venant de l'API de l'organisme",
    },
    "fiabilisation_statut": {
      "bsonType": "string",
      "description": "Statut de fiabilisation de l'organisme",
      "enum": [
        "FIABLE",
        "NON_FIABLE",
      ],
    },
    "first_transmission_date": {
      "bsonType": "date",
      "description": "Date de la première transmission de données",
    },
    "has_transmission_errors": {
      "bsonType": "bool",
      "description": "Indique si cet organisme a une transmissions d'effectif en erreur",
    },
    "is_transmission_target": {
      "bsonType": [
        "bool",
        "null",
      ],
      "description": "Indique si cet organisme ( ou un de ces organismes formateur dont il est le responsable ) a été la cible ou non de transmissions d'effectif",
    },
    "last_effectifs_deca_update": {
      "bsonType": "date",
      "description": "Date de la dernière mise à jour des effectifs deca pour cet organisme",
    },
    "last_erp_transmission_date": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de dernière transmission en tant qu'organisme transmetteur",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de dernière transmission en tant qu'organisme transmetteur",
    },
    "last_transmission_date": {
      "bsonType": "date",
      "description": "Date de la dernière transmission de données",
    },
    "mode_de_transmission": {
      "bsonType": "string",
      "description": "Mode de transmission des effectifs",
      "enum": [
        "API",
        "MANUEL",
      ],
    },
    "mode_de_transmission_configuration_author_fullname": {
      "bsonType": "string",
      "description": "Auteur de la configuration (prénom nom)",
    },
    "mode_de_transmission_configuration_date": {
      "bsonType": "date",
      "description": "Date à laquelle le mode de transmission a été configuré",
    },
    "nature": {
      "bsonType": "string",
      "description": "Nature de l'organisme de formation",
      "enum": [
        "responsable",
        "formateur",
        "responsable_formateur",
        "lieu_formation",
        "inconnue",
      ],
    },
    "nom": {
      "bsonType": "string",
      "description": "Nom de l'organisme de formation",
    },
    "opcos": {
      "bsonType": "array",
      "description": "OPCOs du CFA, s'ils existent",
      "items": {
        "bsonType": "string",
      },
    },
    "organisme_transmetteur_id": {
      "bsonType": "string",
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "organismesFormateurs": {
      "bsonType": "array",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "_id": {
            "anyOf": [
              {
                "bsonType": "objectId",
              },
              {
                "bsonType": "null",
              },
            ],
            "description": "Identifiant unique",
          },
          "academie": {
            "bsonType": "string",
          },
          "commune": {
            "bsonType": "string",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "departement": {
            "bsonType": "string",
          },
          "enseigne": {
            "bsonType": [
              "string",
              "null",
            ],
          },
          "ferme": {
            "bsonType": "bool",
          },
          "fiable": {
            "bsonType": "bool",
          },
          "label": {
            "bsonType": "string",
          },
          "last_transmission_date": {
            "anyOf": [
              {
                "bsonType": "date",
              },
              {
                "bsonType": "null",
              },
            ],
          },
          "nature": {
            "bsonType": "string",
            "enum": [
              "responsable",
              "formateur",
              "responsable_formateur",
              "lieu_formation",
              "inconnue",
            ],
          },
          "raison_sociale": {
            "bsonType": "string",
          },
          "referentiel": {
            "bsonType": "bool",
          },
          "region": {
            "bsonType": "string",
          },
          "reseaux": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "responsabilitePartielle": {
            "bsonType": "bool",
          },
          "siret": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "uai": {
            "bsonType": [
              "string",
              "null",
            ],
          },
        },
      },
    },
    "organismesResponsables": {
      "bsonType": "array",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "_id": {
            "anyOf": [
              {
                "bsonType": "objectId",
              },
              {
                "bsonType": "null",
              },
            ],
            "description": "Identifiant unique",
          },
          "academie": {
            "bsonType": "string",
          },
          "commune": {
            "bsonType": "string",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "departement": {
            "bsonType": "string",
          },
          "enseigne": {
            "bsonType": [
              "string",
              "null",
            ],
          },
          "ferme": {
            "bsonType": "bool",
          },
          "fiable": {
            "bsonType": "bool",
          },
          "label": {
            "bsonType": "string",
          },
          "last_transmission_date": {
            "anyOf": [
              {
                "bsonType": "date",
              },
              {
                "bsonType": "null",
              },
            ],
          },
          "nature": {
            "bsonType": "string",
            "enum": [
              "responsable",
              "formateur",
              "responsable_formateur",
              "lieu_formation",
              "inconnue",
            ],
          },
          "raison_sociale": {
            "bsonType": "string",
          },
          "referentiel": {
            "bsonType": "bool",
          },
          "region": {
            "bsonType": "string",
          },
          "reseaux": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "responsabilitePartielle": {
            "bsonType": "bool",
          },
          "siret": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "uai": {
            "bsonType": [
              "string",
              "null",
            ],
          },
        },
      },
    },
    "qualiopi": {
      "bsonType": "bool",
      "description": "a la certification Qualiopi",
    },
    "raison_sociale": {
      "bsonType": "string",
      "description": "Raison sociale de l'organisme de formation",
    },
    "relatedFormations": {
      "bsonType": "array",
      "description": "Formations de cet organisme",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "annee_formation": {
            "bsonType": "int",
            "description": "Année millésime de la formation pour cet organisme",
          },
          "cle_ministere_educatif": {
            "bsonType": "string",
            "description": "Clé unique de la formation",
          },
          "duree_formation_theorique": {
            "anyOf": [
              {
                "bsonType": "int",
                "description": "Durée théorique de la formation en mois pour cet organisme",
              },
              {
                "bsonType": "null",
              },
            ],
            "description": "Durée théorique de la formation en mois pour cet organisme",
          },
          "formation_id": {
            "bsonType": "objectId",
            "description": "Identifiant unique",
          },
          "organismes": {
            "bsonType": "array",
            "items": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "adresse": {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "description": "Adresse du lieu de formation (optionnel)",
                  "properties": {
                    "academie": {
                      "bsonType": "string",
                      "pattern": "^[0-9]{2}$",
                    },
                    "bassinEmploi": {
                      "bsonType": "string",
                      "description": "Code Bassin d'emploi",
                    },
                    "code_insee": {
                      "bsonType": "string",
                      "description": "Le code insee doit contenir 5 caractères",
                      "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                    },
                    "code_postal": {
                      "bsonType": "string",
                      "description": "Le code postal doit contenir 5 caractères",
                      "pattern": "^[0-9]{5}$",
                    },
                    "commune": {
                      "bsonType": "string",
                      "description": "Commune",
                      "maxLength": 80,
                    },
                    "complement": {
                      "bsonType": "string",
                      "description": "Complément d'adresse",
                    },
                    "complete": {
                      "bsonType": "string",
                      "description": "Adresse complète",
                    },
                    "departement": {
                      "bsonType": "string",
                      "pattern": "^(2A|2B|[0-9]{2,3})$",
                    },
                    "numero": {
                      "bsonType": "int",
                      "description": "N° de la voie",
                    },
                    "pays": {
                      "bsonType": "string",
                      "description": "Pays",
                      "enum": [
                        "AF",
                        "ZA",
                        "AL",
                        "DZ",
                        "DE",
                        "AD",
                        "AO",
                        "AG",
                        "SA",
                        "AR",
                        "AM",
                        "AU",
                        "AT",
                        "AZ",
                        "BS",
                        "BH",
                        "BD",
                        "BB",
                        "BE",
                        "BZ",
                        "BJ",
                        "BT",
                        "BY",
                        "MM",
                        "BO",
                        "BQ",
                        "BA",
                        "BW",
                        "BR",
                        "BN",
                        "BG",
                        "BF",
                        "BI",
                        "KH",
                        "CM",
                        "CA",
                        "CV",
                        "CF",
                        "CL",
                        "CN",
                        "CY",
                        "CO",
                        "KM",
                        "CG",
                        "CD",
                        "KR",
                        "KP",
                        "CR",
                        "CI",
                        "HR",
                        "CU",
                        "CW",
                        "DK",
                        "DJ",
                        "DO",
                        "DM",
                        "EG",
                        "SV",
                        "AE",
                        "EC",
                        "ER",
                        "ES",
                        "EE",
                        "SZ",
                        "US",
                        "ET",
                        "MK",
                        "FJ",
                        "FI",
                        "FR",
                        "GA",
                        "GM",
                        "GE",
                        "GH",
                        "GR",
                        "GD",
                        "GT",
                        "GN",
                        "GQ",
                        "GW",
                        "GY",
                        "HT",
                        "HN",
                        "HU",
                        "IN",
                        "ID",
                        "IR",
                        "IQ",
                        "IE",
                        "IS",
                        "IL",
                        "IT",
                        "JM",
                        "JP",
                        "JO",
                        "KZ",
                        "KE",
                        "KG",
                        "KI",
                        "XK",
                        "KW",
                        "LA",
                        "LS",
                        "LV",
                        "LB",
                        "LR",
                        "LY",
                        "LI",
                        "LT",
                        "LU",
                        "MG",
                        "MY",
                        "MW",
                        "MV",
                        "ML",
                        "MT",
                        "MA",
                        "MH",
                        "MU",
                        "MR",
                        "MX",
                        "FM",
                        "MD",
                        "MC",
                        "MN",
                        "ME",
                        "MZ",
                        "NA",
                        "NR",
                        "NP",
                        "NI",
                        "NE",
                        "NG",
                        "NO",
                        "NZ",
                        "OM",
                        "UG",
                        "UZ",
                        "PK",
                        "PW",
                        "PS",
                        "PA",
                        "PG",
                        "PY",
                        "NL",
                        "PE",
                        "PH",
                        "PL",
                        "PT",
                        "QA",
                        "RO",
                        "GB",
                        "RU",
                        "RW",
                        "KN",
                        "SM",
                        "SX",
                        "VC",
                        "LC",
                        "SB",
                        "WS",
                        "ST",
                        "SN",
                        "RS",
                        "SC",
                        "SL",
                        "SG",
                        "SK",
                        "SI",
                        "SO",
                        "SD",
                        "SS",
                        "LK",
                        "SE",
                        "CH",
                        "SR",
                        "SY",
                        "TJ",
                        "TZ",
                        "TD",
                        "CZ",
                        "TH",
                        "TL",
                        "TG",
                        "TO",
                        "TT",
                        "TN",
                        "TM",
                        "TR",
                        "TV",
                        "UA",
                        "UY",
                        "VU",
                        "VA",
                        "VE",
                        "VN",
                        "YE",
                        "ZM",
                        "ZW",
                      ],
                    },
                    "region": {
                      "bsonType": "string",
                      "pattern": "^[0-9]{2,3}$",
                    },
                    "repetition_voie": {
                      "bsonType": "string",
                      "description": "Indice de répétition du numéro de voie",
                      "enum": [
                        "B",
                        "T",
                        "Q",
                        "C",
                      ],
                    },
                    "voie": {
                      "bsonType": "string",
                      "description": "Nom de voie",
                    },
                  },
                },
                "nature": {
                  "bsonType": "string",
                  "enum": [
                    "responsable",
                    "formateur",
                    "responsable_formateur",
                    "lieu_formation",
                    "inconnue",
                  ],
                },
                "organisme_id": {
                  "bsonType": "objectId",
                  "description": "Identifiant unique",
                },
                "siret": {
                  "bsonType": "string",
                  "description": "Siret du lieu de formation (optionnel)",
                },
                "uai": {
                  "bsonType": "string",
                  "description": "Code UAI du lieu de formation (optionnel)",
                  "pattern": "^[0-9]{7}[a-zA-Z]$",
                },
              },
            },
          },
        },
      },
    },
    "reseaux": {
      "bsonType": "array",
      "description": "Réseaux du CFA, s'ils existent",
      "items": {
        "bsonType": "string",
        "enum": [
          "ADEN",
          "CMA",
          "AGRI",
          "AGRI_CNEAP",
          "AGRI_UNREP",
          "AGRI_UNMFREO",
          "ANASUP",
          "AMUE",
          "CCI",
          "CFA_EC",
          "COMP_DU_DEVOIR",
          "COMP_DU_TOUR_DE_FRANCE",
          "GRETA",
          "UIMM",
          "BTP_CFA",
          "MFR",
          "AFTRAL",
          "GRETA_VAUCLUSE",
          "CFA_SAT",
          "EN_HORS_MURS",
          "EN_CFA_ACADEMIQUE",
          "EN_EPLE",
          "EDUSERVICES",
          "AFPA",
        ],
      },
    },
    "siret": {
      "bsonType": "string",
      "description": "N° SIRET de l'établissement",
      "pattern": "^[0-9]{14}$",
    },
    "transmission_errors_date": {
      "bsonType": "date",
      "description": "Date d'erreur de transmission",
    },
    "uai": {
      "bsonType": "string",
      "description": "Code UAI de l'établissement",
      "pattern": "^[0-9]{7}[a-zA-Z]$",
    },
    "updated_at": {
      "bsonType": "date",
      "description": "Date de mise à jour en base de données",
    },
  },
  "required": [
    "_id",
    "siret",
    "updated_at",
    "created_at",
  ],
}
`;

exports[`validation-schema > should create validation schema for organismesReferentiel > organismesReferentiel 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "adresse": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "academie": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
            "nom",
          ],
        },
        "code_insee": {
          "bsonType": "string",
        },
        "code_postal": {
          "bsonType": "string",
        },
        "departement": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
            "nom",
          ],
        },
        "geojson": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "geometry": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "coordinates": {
                  "bsonType": "array",
                },
                "type": {
                  "bsonType": "string",
                },
              },
              "required": [
                "type",
                "coordinates",
              ],
            },
            "properties": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "score": {
                  "bsonType": "number",
                },
                "source": {
                  "bsonType": "string",
                },
              },
            },
            "type": {
              "bsonType": "string",
            },
          },
          "required": [
            "type",
            "geometry",
          ],
        },
        "label": {
          "bsonType": "string",
        },
        "localite": {
          "bsonType": "string",
        },
        "region": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
            "nom",
          ],
        },
      },
      "required": [
        "code_postal",
        "code_insee",
        "localite",
        "region",
        "academie",
      ],
    },
    "contacts": {
      "bsonType": "array",
      "description": "Contacts du referentiel",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "confirmé": {
            "bsonType": "bool",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "email": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
        },
      },
    },
    "enseigne": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etat_administratif": {
      "bsonType": "string",
      "enum": [
        "actif",
        "fermé",
      ],
    },
    "forme_juridique": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "code": {
          "bsonType": "string",
        },
        "label": {
          "bsonType": "string",
        },
      },
      "required": [
        "code",
        "label",
      ],
    },
    "lieux_de_formation": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "uai": {
            "bsonType": "string",
          },
          "uai_fiable": {
            "bsonType": "bool",
          },
        },
      },
    },
    "nature": {
      "bsonType": "string",
      "enum": [
        "responsable",
        "formateur",
        "responsable_formateur",
        "inconnue",
      ],
    },
    "numero_declaration_activite": {
      "bsonType": "string",
    },
    "qualiopi": {
      "bsonType": "bool",
    },
    "raison_sociale": {
      "bsonType": "string",
    },
    "relations": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "label": {
            "bsonType": "string",
          },
          "referentiel": {
            "bsonType": "bool",
          },
          "siret": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "type": {
            "bsonType": "string",
            "enum": [
              "formateur->responsable",
              "responsable->formateur",
              "entreprise",
            ],
          },
          "uai": {
            "bsonType": [
              "string",
              "null",
            ],
          },
        },
      },
    },
    "siege_social": {
      "bsonType": "bool",
    },
    "siret": {
      "bsonType": "string",
    },
    "uai": {
      "bsonType": "string",
    },
  },
  "required": [
    "_id",
    "siret",
    "nature",
    "lieux_de_formation",
  ],
}
`;

exports[`validation-schema > should create validation schema for personV2 > personV2 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "created_at": {
      "bsonType": "date",
    },
    "date_de_naissance": {
      "anyOf": [
        {
          "anyOf": [
            {
              "bsonType": "date",
            },
            {
              "bsonType": "string",
            },
          ],
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "nom": {
      "bsonType": "string",
    },
    "prenom": {
      "bsonType": "string",
    },
    "updated_at": {
      "bsonType": "date",
    },
  },
  "required": [
    "_id",
    "created_at",
    "updated_at",
    "nom",
    "prenom",
  ],
}
`;

exports[`validation-schema > should create validation schema for rncp > rncp 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "actif": {
      "bsonType": "bool",
    },
    "etat_fiche": {
      "bsonType": "string",
    },
    "intitule": {
      "bsonType": "string",
    },
    "niveau": {
      "bsonType": "number",
    },
    "nouveaux_rncp": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
    "opcos": {
      "bsonType": "array",
      "description": "Information récupérée depuis les CSV des OPCOs et non le RNCP",
      "items": {
        "bsonType": "string",
      },
    },
    "rncp": {
      "bsonType": "string",
    },
    "romes": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
  },
  "required": [
    "_id",
    "rncp",
    "intitule",
    "etat_fiche",
    "actif",
    "romes",
  ],
}
`;

exports[`validation-schema > should create validation schema for telechargementListeNomLogs > telechargementListeNomLogs 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
      "description": "Identifiant MongoDB du log",
    },
    "effectifs": {
      "anyOf": [
        {
          "bsonType": "array",
          "items": {
            "bsonType": "objectId",
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "elementList": {
      "anyOf": [
        {
          "bsonType": "array",
          "items": {
            "bsonType": "string",
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "organisation_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant unique",
    },
    "organisme_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant unique",
    },
    "telechargement_date": {
      "bsonType": "date",
    },
    "type": {
      "bsonType": "string",
      "enum": [
        "apprenant",
        "apprenti",
        "inscritSansContrat",
        "rupturant",
        "abandon",
        "inconnu",
        "organismes_sans_effectifs",
        "organismes_nature_inconnue",
        "organismes_siret_ferme",
        "organismes_uai_non_determine",
        "affelnet_concretise",
        "affelnet",
        "affelnet_non_concretise",
        "sifa",
      ],
    },
    "user_id": {
      "bsonType": "objectId",
    },
  },
  "required": [
    "_id",
    "type",
    "telechargement_date",
    "user_id",
  ],
}
`;

exports[`validation-schema > should create validation schema for transmissionV2 > transmissionV2 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "created_at": {
      "bsonType": "date",
    },
    "formation_id": {
      "bsonType": "objectId",
    },
    "organisme_transmetteur_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant unique",
    },
  },
  "required": [
    "_id",
    "created_at",
    "formation_id",
  ],
}
`;

exports[`validation-schema > should create validation schema for users > users 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "__v": {
      "bsonType": "number",
    },
    "_id": {
      "bsonType": "objectId",
    },
    "archived_at": {
      "bsonType": "date",
    },
    "created_at": {
      "bsonType": "date",
      "description": "La date de création de l'utilisateur",
    },
    "email": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Email de l'utilisateur",
    },
    "last_connection": {
      "bsonType": "date",
      "description": "Date de dernière connexion",
    },
    "network": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Le réseau de CFA de l'utilisateur s'il est précisé",
    },
    "organisme": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "L'organisme d'appartenance de l'utilisateur s'il est précisé",
    },
    "password": {
      "bsonType": "string",
      "description": "Le mot de passe hashed",
    },
    "password_update_token": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Token généré afin de sécuriser le changement de mot de passe",
    },
    "password_update_token_expiry": {
      "anyOf": [
        {
          "bsonType": "date",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'expiration du token généré afin de sécuriser le changement de mot de passe",
    },
    "permissions": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
    "region": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "La région de l'utilisateur s'il est précisé",
    },
    "username": {
      "bsonType": "string",
      "description": "Le nom de l'utilisateur, utilisé pour l'authentification",
    },
  },
  "required": [
    "_id",
    "username",
    "created_at",
  ],
}
`;

exports[`validation-schema > should create validation schema for usersMigration > usersMigration 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "account_status": {
      "bsonType": "string",
      "description": "Statut du compte",
      "enum": [
        "PENDING_EMAIL_VALIDATION",
        "PENDING_ADMIN_VALIDATION",
        "CONFIRMED",
      ],
    },
    "civility": {
      "bsonType": "string",
      "description": "civilité",
      "enum": [
        "Madame",
        "Monsieur",
      ],
    },
    "connection_history": {
      "bsonType": "array",
      "description": "Historique des dates de connexion",
      "items": {
        "bsonType": "date",
      },
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date de création du compte",
    },
    "email": {
      "bsonType": "string",
      "description": "Email utilisateur",
    },
    "emails": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "error": {
            "bsonType": "array",
            "items": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "message": {
                  "bsonType": "string",
                },
                "type": {
                  "bsonType": "string",
                  "enum": [
                    "fatal",
                    "soft_bounce",
                    "hard_bounce",
                    "complaint",
                    "invalid_email",
                    "blocked",
                    "error",
                  ],
                },
              },
            },
          },
          "messageIds": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "openDate": {
            "bsonType": "date",
          },
          "payload": {},
          "sendDates": {
            "bsonType": "array",
            "items": {
              "bsonType": "date",
            },
          },
          "templateName": {
            "bsonType": "string",
          },
          "token": {
            "bsonType": "string",
          },
        },
        "required": [
          "token",
          "templateName",
          "sendDates",
        ],
      },
    },
    "fonction": {
      "bsonType": "string",
      "description": "La fonction de l'utilisateur",
    },
    "has_accept_cgu_version": {
      "bsonType": "string",
      "description": "Version des cgu accepté par l'utilisateur",
    },
    "invalided_token": {
      "bsonType": "bool",
      "description": "true si besoin de reset le token",
    },
    "last_connection": {
      "bsonType": "date",
      "description": "Date de dernière connexion",
    },
    "nom": {
      "bsonType": "string",
      "description": "Le nom de l'utilisateur",
    },
    "organisation_id": {
      "bsonType": "objectId",
      "description": "Organisation à laquelle appartient l'utilisateur",
    },
    "password": {
      "bsonType": "string",
      "description": "Le mot de passe hashé",
    },
    "password_updated_at": {
      "bsonType": "date",
      "description": "Date de dernière mise à jour mot de passe",
    },
    "prenom": {
      "bsonType": "string",
      "description": "Le prénom de l'utilisateur",
    },
    "reminder_missing_configuration_and_data_sent_date": {
      "bsonType": "date",
      "description": "Date d'envoi de la relance email pour configuration et données manquantes",
    },
    "reminder_missing_data_sent_date": {
      "bsonType": "date",
      "description": "Date d'envoi de la relance email pour données manquantes",
    },
    "telephone": {
      "bsonType": "string",
      "description": "Le téléphone de l'utilisateur",
    },
    "unsubscribe": {
      "bsonType": "bool",
      "description": "unsubscribe email",
    },
  },
  "required": [
    "_id",
    "email",
    "password",
    "civility",
    "nom",
    "prenom",
    "organisation_id",
    "account_status",
  ],
}
`;

exports[`validation-schema > should create validation schema for voeuxAffelnet > voeuxAffelnet 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "formation": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "cfd": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "libelle": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "rncp": {
              "bsonType": [
                "string",
                "null",
              ],
            },
          },
        },
        "organisme": {
          "anyOf": [
            {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "anyOf": [
                    {
                      "anyOf": [
                        {
                          "not": {},
                        },
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2}$",
                        },
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "bassinEmploi": {
                  "bsonType": [
                    "string",
                    "null",
                  ],
                },
                "departement": {
                  "anyOf": [
                    {
                      "anyOf": [
                        {
                          "not": {},
                        },
                        {
                          "bsonType": "string",
                          "pattern": "^(2A|2B|[0-9]{2,3})$",
                        },
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "fiable": {
                  "bsonType": [
                    "bool",
                    "null",
                  ],
                  "description": "organismes.fiabilisation_statut == "FIABLE" && ferme != false",
                },
                "region": {
                  "anyOf": [
                    {
                      "anyOf": [
                        {
                          "not": {},
                        },
                        {
                          "bsonType": "string",
                          "pattern": "^[0-9]{2,3}$",
                        },
                      ],
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                },
                "reseaux": {
                  "anyOf": [
                    {
                      "bsonType": "array",
                      "description": "Réseaux du CFA, s'ils existent",
                      "items": {
                        "bsonType": "string",
                        "enum": [
                          "ADEN",
                          "CMA",
                          "AGRI",
                          "AGRI_CNEAP",
                          "AGRI_UNREP",
                          "AGRI_UNMFREO",
                          "ANASUP",
                          "AMUE",
                          "CCI",
                          "CFA_EC",
                          "COMP_DU_DEVOIR",
                          "COMP_DU_TOUR_DE_FRANCE",
                          "GRETA",
                          "UIMM",
                          "BTP_CFA",
                          "MFR",
                          "AFTRAL",
                          "GRETA_VAUCLUSE",
                          "CFA_SAT",
                          "EN_HORS_MURS",
                          "EN_CFA_ACADEMIQUE",
                          "EN_EPLE",
                          "EDUSERVICES",
                          "AFPA",
                        ],
                      },
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Réseaux du CFA, s'ils existent",
                },
                "siret": {
                  "anyOf": [
                    {
                      "bsonType": "string",
                      "description": "N° SIRET de l'établissement",
                      "pattern": "^[0-9]{14}$",
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "N° SIRET de l'établissement",
                },
                "uai": {
                  "anyOf": [
                    {
                      "bsonType": "string",
                      "description": "Code UAI de l'établissement",
                      "pattern": "^[0-9]{7}[a-zA-Z]$",
                    },
                    {
                      "bsonType": "null",
                    },
                  ],
                  "description": "Code UAI de l'établissement",
                },
              },
            },
            {
              "bsonType": "null",
            },
          ],
        },
      },
      "required": [
        "formation",
      ],
    },
    "_id": {
      "bsonType": "objectId",
      "description": "Identifiant unique MongoDB de l'instance voeu",
    },
    "annee_scolaire_rentree": {
      "anyOf": [
        {
          "bsonType": "string",
          "description": "Année scolaire du voeux",
          "pattern": "^[12][0-9]{3}$",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Année scolaire du voeux",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "deleted_at": {
      "anyOf": [
        {
          "bsonType": "date",
          "description": "Date de suppresion du voeux",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date de suppresion du voeux",
    },
    "effectif_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Identifiant de l'effectif",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant de l'effectif",
    },
    "formation_catalogue_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant unique",
    },
    "history": {
      "bsonType": "array",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "created_at": {
            "bsonType": "date",
          },
          "raw": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "academie": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "adresse_1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "adresse_2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "adresse_3": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "adresse_4": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "annee_scolaire_rentree": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "bareme": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "candidature_internat": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "cle_ministere_educatif": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_enseignement": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_lv1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_lv2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_mef": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_mef_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_offre_formation": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_origine_1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_origine_2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_postal": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_specialite_offre_formation": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_uai_cio_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_uai_etab_accueil": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "code_uai_etab_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "demande_code_lv1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "demande_code_lv2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "demande_libelle_lv1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "demande_libelle_lv2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "ine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_cio_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_enseignement": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_etab_accueil": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_etab_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_formation": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_formation_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_lv1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_lv2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_option_1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_option_2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "libelle_public_etablissement": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "mail_responsable_1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "mail_responsable_2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "mnemonique_mef_offre_formation": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "mnemonique_mef_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "nom": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "pays": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "prenom_1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "prenom_2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "prenom_3": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "rang": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "siret_uai_gestionnaire": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "telephone": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "telephone_portable": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "telephone_pro": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "telephone_responsable_1": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "telephone_responsable_2": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "type_etab_accueil": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "type_etab_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "uai_cio_etab_accueil": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "uai_etablissement_responsable": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "uai_etatblissement_formateur": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "ville": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "ville_etab_accueil": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
              "ville_etab_origine": {
                "anyOf": [
                  {},
                  {
                    "bsonType": "null",
                  },
                ],
              },
            },
          },
        },
        "required": [
          "created_at",
          "raw",
        ],
      },
    },
    "is_contacted": {
      "bsonType": "bool",
      "description": "Indique si le jeune a été contacté",
    },
    "organisme_formateur_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Identifiant de l'organisme formateur",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant de l'organisme formateur",
    },
    "organisme_responsable_id": {
      "anyOf": [
        {
          "bsonType": "objectId",
          "description": "Identifiant de l'organisme responsable",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Identifiant de l'organisme responsable",
    },
    "raw": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "academie": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "adresse_1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "adresse_2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "adresse_3": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "adresse_4": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "annee_scolaire_rentree": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "bareme": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "candidature_internat": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "cle_ministere_educatif": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_enseignement": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_lv1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_lv2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_mef": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_mef_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_offre_formation": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_origine_1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_origine_2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_postal": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_specialite_offre_formation": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_uai_cio_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_uai_etab_accueil": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "code_uai_etab_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "demande_code_lv1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "demande_code_lv2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "demande_libelle_lv1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "demande_libelle_lv2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "ine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_cio_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_enseignement": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_etab_accueil": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_etab_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_formation": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_formation_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_lv1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_lv2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_option_1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_option_2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "libelle_public_etablissement": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "mail_responsable_1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "mail_responsable_2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "mnemonique_mef_offre_formation": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "mnemonique_mef_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "nom": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "pays": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "prenom_1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "prenom_2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "prenom_3": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "rang": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "siret_uai_gestionnaire": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "telephone": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "telephone_portable": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "telephone_pro": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "telephone_responsable_1": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "telephone_responsable_2": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "type_etab_accueil": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "type_etab_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "uai_cio_etab_accueil": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "uai_etablissement_responsable": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "uai_etatblissement_formateur": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "ville": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "ville_etab_accueil": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
        "ville_etab_origine": {
          "anyOf": [
            {},
            {
              "bsonType": "null",
            },
          ],
        },
      },
    },
    "updated_at": {
      "bsonType": "date",
      "description": "Date de mise à jour",
    },
  },
  "required": [
    "_id",
    "created_at",
    "updated_at",
    "is_contacted",
    "raw",
    "history",
    "_computed",
  ],
}
`;
