import { effectifsDb, effectifsQueueDb } from "@/common/model/collections";

export const up = async () => {
  await effectifsDb().updateMany({ "apprenant.nir": { $ne: null } }, [
    { $set: { "apprenant.has_nir": true } },
    { $unset: ["apprenant.nir"] },
  ]);
  await effectifsDb().updateMany({ "apprenant.nir": null }, [
    { $set: { "apprenant.has_nir": false } },
    { $unset: ["apprenant.nir"] },
  ]);
  await effectifsQueueDb().updateMany({ nir_apprenant: { $ne: null } }, [
    { $set: { has_nir: true } },
    { $unset: ["nir_apprenant"] },
  ]);
  await effectifsQueueDb().updateMany({ nir_apprenant: null }, [
    { $set: { has_nir: false } },
    { $unset: ["nir_apprenant"] },
  ]);
};
