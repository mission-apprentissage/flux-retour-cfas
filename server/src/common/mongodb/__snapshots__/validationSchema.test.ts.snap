// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`validation-schema should create validation schema for auditLogs: auditLogs 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "action": {
      "bsonType": "string",
      "description": "L'action en cours",
    },
    "data": {
      "anyOf": [
        {},
        {
          "bsonType": "null",
        },
      ],
      "description": "La donnée liée à l'action",
    },
    "date": {
      "bsonType": "date",
      "description": "La date de l'évènement",
    },
  },
  "required": [
    "action",
    "date",
    "_id",
  ],
}
`;

exports[`validation-schema should create validation schema for bassinsEmploi: bassinsEmploi 1`] = `
{
  "additionalProperties": true,
  "bsonType": "object",
  "properties": {
    "code_commune": {
      "bsonType": "string",
      "description": "Code commune",
    },
    "code_zone_emploi": {
      "bsonType": "string",
      "description": "Code zone d'emploi",
    },
  },
  "required": [
    "code_commune",
    "code_zone_emploi",
  ],
}
`;

exports[`validation-schema should create validation schema for contratsDeca: contratsDeca 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "alternant": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "adresse": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "codePostal": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "Le code postal de l'adresse",
            },
            "numero": {
              "bsonType": [
                "number",
                "null",
              ],
              "description": "Le numéro de l'adresse",
            },
            "voie": {
              "bsonType": [
                "string",
                "null",
              ],
              "description": "La voie de l'adresse",
            },
          },
        },
        "courriel": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "L'adresse email de l'alternant",
        },
        "dateNaissance": {
          "bsonType": "string",
          "description": "La date de naissance de l'alternant",
        },
        "departementNaissance": {
          "bsonType": "string",
          "description": "Le département de naissance de l'alternant",
        },
        "derniereClasse": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "La dernière classe de l'apprenant",
        },
        "handicap": {
          "bsonType": [
            "bool",
            "null",
          ],
          "description": "Indique si l'alternant est identifié comme porteur d'un handicap",
        },
        "nationalite": {
          "bsonType": [
            "number",
            "null",
          ],
          "description": "Le code de la nationalité de l'alternant",
        },
        "nom": {
          "bsonType": "string",
          "description": "Le nom de l'alternant",
        },
        "prenom": {
          "bsonType": "string",
          "description": "Le prenom de l'alternant",
        },
        "sexe": {
          "bsonType": "string",
          "description": "Le sexe de l'alternant",
        },
        "telephone": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Le numéro de téléphone de l'alternant",
        },
      },
      "required": [
        "nom",
        "prenom",
        "sexe",
        "dateNaissance",
        "departementNaissance",
      ],
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "detailsContrat": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "dateDebutContrat": {
          "bsonType": "string",
          "description": "La date de début du contrat",
        },
        "dateEffetAvenant": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "La date d'effet de l'avenant du contrat",
        },
        "dateFinContrat": {
          "bsonType": "string",
          "description": "La date de fin du contrat",
        },
        "noAvenant": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Le numéro de l'avenant du contrat",
        },
        "noContrat": {
          "bsonType": "string",
          "description": "Le numéro du contrat",
        },
        "statut": {
          "bsonType": "string",
          "description": "Le statut du contrat",
        },
      },
      "required": [
        "noContrat",
        "dateDebutContrat",
        "statut",
        "dateFinContrat",
      ],
    },
    "employeur": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "codeIdcc": {
          "bsonType": "string",
          "description": "Le code IDCC de l'employeur",
        },
      },
      "required": [
        "codeIdcc",
      ],
    },
    "etablissementFormation": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "siret": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Le siret de l'établissement de la formation",
        },
      },
    },
    "formation": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "codeDiplome": {
          "bsonType": "string",
          "description": "Le code diplôme de la formation",
        },
        "dateDebutFormation": {
          "bsonType": "string",
          "description": "La date de début de la formation",
        },
        "dateFinFormation": {
          "bsonType": "string",
          "description": "La date de fin de la formation",
        },
        "intituleOuQualification": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "L'adresse email de l'alternant",
        },
        "rncp": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Le code RNCP de la formation",
        },
      },
      "required": [
        "dateDebutFormation",
        "dateFinFormation",
        "codeDiplome",
      ],
    },
    "organismeFormationResponsable": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "siret": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Le SIRET de l'organisme responsable",
        },
        "uaiCfa": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "L'UAI de l'organisme responsable",
        },
      },
    },
    "rupture": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "dateEffetRupture": {
              "bsonType": "string",
              "description": "La date d'effet de la rupture",
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
  },
  "required": [
    "_id",
    "alternant",
    "formation",
    "etablissementFormation",
    "organismeFormationResponsable",
    "detailsContrat",
    "employeur",
    "created_at",
  ],
}
`;

exports[`validation-schema should create validation schema for effectifs: effectifs 1`] = `
{
  "additionalProperties": true,
  "bsonType": "object",
  "properties": {
    "_computed": {
      "additionalProperties": false,
      "bsonType": "object",
      "description": "Propriétés calculées ou récupérées d'autres collections",
      "properties": {
        "formation": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "codes_rome": {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
              },
            },
            "opcos": {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
              },
            },
          },
        },
        "organisme": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "academie": {
              "bsonType": "string",
              "enum": [
                "1",
                "2",
                "3",
                "4",
                "6",
                "7",
                "8",
                "9",
                "10",
                "11",
                "12",
                "13",
                "14",
                "15",
                "16",
                "17",
                "18",
                "19",
                "20",
                "22",
                "23",
                "24",
                "25",
                "27",
                "28",
                "31",
                "32",
                "33",
                "43",
                "44",
                "70",
                "77",
                "78",
              ],
            },
            "bassinEmploi": {
              "bsonType": "string",
            },
            "departement": {
              "bsonType": "string",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "05",
                "06",
                "07",
                "08",
                "09",
                "10",
                "11",
                "12",
                "13",
                "14",
                "15",
                "16",
                "17",
                "18",
                "19",
                "21",
                "22",
                "23",
                "24",
                "25",
                "26",
                "27",
                "28",
                "29",
                "2A",
                "2B",
                "30",
                "31",
                "32",
                "33",
                "34",
                "35",
                "36",
                "37",
                "38",
                "39",
                "40",
                "41",
                "42",
                "43",
                "44",
                "45",
                "46",
                "47",
                "48",
                "49",
                "50",
                "51",
                "52",
                "53",
                "54",
                "55",
                "56",
                "57",
                "58",
                "59",
                "60",
                "61",
                "62",
                "63",
                "64",
                "65",
                "66",
                "67",
                "68",
                "69",
                "70",
                "71",
                "72",
                "73",
                "74",
                "75",
                "76",
                "77",
                "78",
                "79",
                "80",
                "81",
                "82",
                "83",
                "84",
                "85",
                "86",
                "87",
                "88",
                "89",
                "90",
                "91",
                "92",
                "93",
                "94",
                "95",
                "971",
                "972",
                "973",
                "974",
                "975",
                "976",
                "977",
                "978",
                "984",
                "986",
                "987",
                "988",
                "989",
              ],
              "example": "1 Ain, 99 Étranger",
              "maxLength": 3,
              "minLength": 1,
              "pattern": "^([0-9][0-9]|2[AB]|9[012345]|97[1234678]|98[46789])$",
            },
            "fiable": {
              "bsonType": "bool",
              "description": "organismes.fiabilisation_statut == "FIABLE" && ferme != false",
            },
            "region": {
              "bsonType": "string",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "06",
                "11",
                "24",
                "27",
                "28",
                "32",
                "44",
                "52",
                "53",
                "75",
                "76",
                "84",
                "93",
                "94",
                "978",
                "977",
                "00",
              ],
            },
            "reseaux": {
              "bsonType": "array",
              "items": {
                "bsonType": "string",
                "enum": [
                  "ADEN",
                  "CMA",
                  "AGRI",
                  "AGRI_CNEAP",
                  "AGRI_UNREP",
                  "AGRI_UNMFREO",
                  "ANASUP",
                  "AMUE",
                  "CCI",
                  "CFA_EC",
                  "COMP_DU_DEVOIR",
                  "COMP_DU_TOUR_DE_FRANCE",
                  "GRETA",
                  "UIMM",
                  "BTP_CFA",
                  "MFR",
                  "AFTRAL",
                  "GRETA_VAUCLUSE",
                  "CFA_SAT",
                  "EN_HORS_MURS",
                  "EN_CFA_ACADEMIQUE",
                  "EN_EPLE",
                ],
              },
            },
            "siret": {
              "bsonType": "string",
              "maxLength": 14,
              "minLength": 14,
              "pattern": "^[0-9]{14}$",
            },
            "uai": {
              "bsonType": "string",
              "maxLength": 8,
              "minLength": 8,
              "pattern": "^[0-9]{7}[a-zA-Z]$",
            },
          },
        },
      },
    },
    "_id": {
      "bsonType": "objectId",
      "description": "Identifiant MongoDB de l'effectif",
    },
    "annee_scolaire": {
      "bsonType": "string",
      "description": "Année scolaire sur laquelle l'apprenant est enregistré (ex: "2020-2021")",
      "pattern": "^[12][0-9]{3}-[12][0-9]{3}$",
    },
    "apprenant": {
      "additionalProperties": true,
      "bsonType": "object",
      "properties": {
        "adresse": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "academie": {
              "bsonType": "string",
              "enum": [
                "1",
                "2",
                "3",
                "4",
                "6",
                "7",
                "8",
                "9",
                "10",
                "11",
                "12",
                "13",
                "14",
                "15",
                "16",
                "17",
                "18",
                "19",
                "20",
                "22",
                "23",
                "24",
                "25",
                "27",
                "28",
                "31",
                "32",
                "33",
                "43",
                "44",
                "70",
                "77",
                "78",
              ],
            },
            "bassinEmploi": {
              "bsonType": "string",
              "description": "Code Bassin d'emploi",
            },
            "code_insee": {
              "bsonType": "string",
              "description": "Code commune insee de l'apprenant",
              "example": "54318",
              "maxLength": 5,
              "minLength": 5,
              "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
            },
            "code_postal": {
              "bsonType": "string",
              "description": "Le code postal doit contenir 5 caractères",
              "example": "75000",
              "maxLength": 5,
              "minLength": 5,
              "pattern": "^[0-9]{5}$",
            },
            "commune": {
              "bsonType": "string",
              "description": "Commune",
              "example": "PARIS",
              "maxLength": 80,
            },
            "complement": {
              "bsonType": "string",
              "description": "Complément d'adresse",
              "example": "Bâtiment ; Résidence ; Entrée ; Appartement ; Escalier ; Etage",
            },
            "complete": {
              "bsonType": "string",
              "description": "Adresse complète",
              "example": "13 Bis Boulevard de la liberté 75000 PARIS",
            },
            "departement": {
              "bsonType": "string",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "05",
                "06",
                "07",
                "08",
                "09",
                "10",
                "11",
                "12",
                "13",
                "14",
                "15",
                "16",
                "17",
                "18",
                "19",
                "21",
                "22",
                "23",
                "24",
                "25",
                "26",
                "27",
                "28",
                "29",
                "2A",
                "2B",
                "30",
                "31",
                "32",
                "33",
                "34",
                "35",
                "36",
                "37",
                "38",
                "39",
                "40",
                "41",
                "42",
                "43",
                "44",
                "45",
                "46",
                "47",
                "48",
                "49",
                "50",
                "51",
                "52",
                "53",
                "54",
                "55",
                "56",
                "57",
                "58",
                "59",
                "60",
                "61",
                "62",
                "63",
                "64",
                "65",
                "66",
                "67",
                "68",
                "69",
                "70",
                "71",
                "72",
                "73",
                "74",
                "75",
                "76",
                "77",
                "78",
                "79",
                "80",
                "81",
                "82",
                "83",
                "84",
                "85",
                "86",
                "87",
                "88",
                "89",
                "90",
                "91",
                "92",
                "93",
                "94",
                "95",
                "971",
                "972",
                "973",
                "974",
                "975",
                "976",
                "977",
                "978",
                "984",
                "986",
                "987",
                "988",
                "989",
              ],
              "example": "1 Ain, 99 Étranger",
              "maxLength": 3,
              "minLength": 1,
              "pattern": "^([0-9][0-9]|2[AB]|9[012345]|97[12345678]|98[46789])$",
            },
            "numero": {
              "bsonType": "int",
              "description": "N° de la voie",
              "example": 13,
              "pattern": "^(?!0{1})[0-9]*$",
            },
            "pays": {
              "bsonType": "string",
              "description": "Pays",
              "enum": [
                "AF",
                "ZA",
                "AL",
                "DZ",
                "DE",
                "AD",
                "AO",
                "AG",
                "SA",
                "AR",
                "AM",
                "AU",
                "AT",
                "AZ",
                "BS",
                "BH",
                "BD",
                "BB",
                "BE",
                "BZ",
                "BJ",
                "BT",
                "BY",
                "MM",
                "BO",
                "BQ",
                "BA",
                "BW",
                "BR",
                "BN",
                "BG",
                "BF",
                "BI",
                "KH",
                "CM",
                "CA",
                "CV",
                "CF",
                "CL",
                "CN",
                "CY",
                "CO",
                "KM",
                "CG",
                "CD",
                "KR",
                "KP",
                "CR",
                "CI",
                "HR",
                "CU",
                "CW",
                "DK",
                "DJ",
                "DO",
                "DM",
                "EG",
                "SV",
                "AE",
                "EC",
                "ER",
                "ES",
                "EE",
                "SZ",
                "US",
                "ET",
                "MK",
                "FJ",
                "FI",
                "FR",
                "GA",
                "GM",
                "GE",
                "GH",
                "GR",
                "GD",
                "GT",
                "GN",
                "GQ",
                "GW",
                "GY",
                "HT",
                "HN",
                "HU",
                "IN",
                "ID",
                "IR",
                "IQ",
                "IE",
                "IS",
                "IL",
                "IT",
                "JM",
                "JP",
                "JO",
                "KZ",
                "KE",
                "KG",
                "KI",
                "XK",
                "KW",
                "LA",
                "LS",
                "LV",
                "LB",
                "LR",
                "LY",
                "LI",
                "LT",
                "LU",
                "MG",
                "MY",
                "MW",
                "MV",
                "ML",
                "MT",
                "MA",
                "MH",
                "MU",
                "MR",
                "MX",
                "FM",
                "MD",
                "MC",
                "MN",
                "ME",
                "MZ",
                "NA",
                "NR",
                "NP",
                "NI",
                "NE",
                "NG",
                "NO",
                "NZ",
                "OM",
                "UG",
                "UZ",
                "PK",
                "PW",
                "PS",
                "PA",
                "PG",
                "PY",
                "NL",
                "PE",
                "PH",
                "PL",
                "PT",
                "QA",
                "RO",
                "GB",
                "RU",
                "RW",
                "KN",
                "SM",
                "SX",
                "VC",
                "LC",
                "SB",
                "WS",
                "ST",
                "SN",
                "RS",
                "SC",
                "SL",
                "SG",
                "SK",
                "SI",
                "SO",
                "SD",
                "SS",
                "LK",
                "SE",
                "CH",
                "SR",
                "SY",
                "TJ",
                "TZ",
                "TD",
                "CZ",
                "TH",
                "TL",
                "TG",
                "TO",
                "TT",
                "TN",
                "TM",
                "TR",
                "TV",
                "UA",
                "UY",
                "VU",
                "VA",
                "VE",
                "VN",
                "YE",
                "ZM",
                "ZW",
              ],
            },
            "region": {
              "bsonType": "string",
              "enum": [
                "01",
                "02",
                "03",
                "04",
                "06",
                "11",
                "24",
                "27",
                "28",
                "32",
                "44",
                "52",
                "53",
                "75",
                "76",
                "84",
                "93",
                "94",
                "978",
                "977",
                "00",
              ],
            },
            "repetition_voie": {
              "bsonType": "string",
              "description": "Indice de répétition du numéro de voie",
              "enum": [
                "B",
                "T",
                "Q",
                "C",
              ],
              "example": "B",
            },
            "voie": {
              "bsonType": "string",
              "description": "Nom de voie",
              "example": "Boulevard de la liberté",
            },
          },
        },
        "affelnet": {
          "bsonType": "array",
          "items": {
            "bsonType": "string",
            "description": "voeux affelnet de l'apprenant",
          },
        },
        "code_postal_de_naissance": {
          "bsonType": "string",
          "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
          "example": "75000",
          "maxLength": 5,
          "minLength": 5,
          "pattern": "^[0-9]{5}$",
        },
        "courriel": {
          "bsonType": "string",
          "description": "Adresse mail de contact de l'apprenant",
        },
        "date_de_naissance": {
          "bsonType": "date",
          "description": "Date de naissance de l'apprenant",
        },
        "date_rqth": {
          "bsonType": "date",
          "description": "Date de la reconnaissance travailleur handicapé",
        },
        "dernier_diplome": {
          "bsonType": "int",
          "description": "Dernier diplôme obtenu",
          "enum": [
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            99,
          ],
        },
        "dernier_organisme_uai": {
          "bsonType": "string",
          "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation
      ou département.   
* Pour les apprentis en emploi l'année dernière, le numéro UAI n-1 à indiquer est le **995** qui signifie "Non concerné".
         
* Si cette information n'est pas connue, le numéro UAI n-1 à indiquer est le **993** qui signifie "Inconnu" ",
          "pattern": "^(0?[0-9][0-9]|0?2[AB]|0?9[012345]|97[1234678]|98[46789]|99[0135]|[0-9]{7}[a-zA-Z])$",
        },
        "derniere_situation": {
          "bsonType": "int",
          "description": "Situation de l'apprenant N-1",
          "enum": [
            1003,
            1005,
            1009,
            1013,
            1015,
            1017,
            1018,
            1019,
            1021,
            1023,
            2001,
            2003,
            2005,
            2007,
            3001,
            3101,
            3003,
            3103,
            3009,
            3109,
            3011,
            3111,
            3031,
            3131,
            3032,
            3132,
            3033,
            3133,
            3117,
            3119,
            3021,
            3121,
            3023,
            3123,
            4001,
            4101,
            4003,
            4103,
            4005,
            4105,
            4007,
            4107,
            4009,
            4011,
            4111,
            4013,
            4113,
            4015,
            4115,
            4017,
            4117,
            4019,
            4119,
            4021,
            4121,
            5901,
            5903,
            5905,
            5907,
            5909,
            9900,
            9999,
          ],
        },
        "has_nir": {
          "bsonType": "bool",
          "description": "Numéro de sécurité sociale de l'apprenant",
        },
        "historique_statut": {
          "bsonType": "array",
          "description": "Historique du statut de l'apprenant",
          "items": {
            "additionalProperties": true,
            "bsonType": "object",
            "properties": {
              "abandon_forced": {
                "bsonType": "bool",
                "description": "Le statut a été forcé en abandon",
              },
              "date_reception": {
                "bsonType": "date",
              },
              "date_statut": {
                "bsonType": "date",
              },
              "valeur_statut": {
                "bsonType": "int",
                "description": "Statut de l'apprenant",
                "enum": [
                  2,
                  3,
                  0,
                ],
              },
            },
            "required": [
              "valeur_statut",
              "date_statut",
            ],
          },
        },
        "ine": {
          "bsonType": "string",
          "description": "N° INE de l'apprenant",
          "example": "0494004062M",
        },
        "inscription_sportif_haut_niveau": {
          "bsonType": "bool",
          "description": "Apprenant inscrit sur la liste des sportifs, entraîneurs, arbitres et juges sportifs de haut niveau",
        },
        "mineur": {
          "bsonType": "bool",
          "description": "l'apprenant(e) sera-t-il(elle) mineur(e) ? (calc)",
        },
        "mineur_emancipe": {
          "bsonType": "bool",
          "description": "Un mineur émancipé peut accomplir seul les actes nécessitant la majorité légale.",
        },
        "nationalite": {
          "bsonType": "int",
          "description": "Apprenant étranger, non citoyen européen",
          "enum": [
            1,
            2,
            3,
          ],
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de l'apprenant",
          "pattern": "^.+$",
        },
        "parcoursup": {
          "bsonType": "array",
          "items": {
            "bsonType": "string",
            "description": "voeux parcoursup de l'apprenant",
          },
        },
        "prenom": {
          "bsonType": "string",
          "description": "Prénom de l'apprenant",
          "pattern": "^.+$",
        },
        "regime_scolaire": {
          "bsonType": "string",
          "description": "Régime scolaire (I : Interne, D : Demi-pensionnaire, E : Externe, IE : Interne externé)",
          "enum": [
            "I",
            "D",
            "E",
            "IE",
          ],
        },
        "representant_legal": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "adresse": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "academie": {
                  "bsonType": "string",
                  "enum": [
                    "1",
                    "2",
                    "3",
                    "4",
                    "6",
                    "7",
                    "8",
                    "9",
                    "10",
                    "11",
                    "12",
                    "13",
                    "14",
                    "15",
                    "16",
                    "17",
                    "18",
                    "19",
                    "20",
                    "22",
                    "23",
                    "24",
                    "25",
                    "27",
                    "28",
                    "31",
                    "32",
                    "33",
                    "43",
                    "44",
                    "70",
                    "77",
                    "78",
                  ],
                },
                "bassinEmploi": {
                  "bsonType": "string",
                  "description": "Code Bassin d'emploi",
                },
                "code_insee": {
                  "bsonType": "string",
                  "description": "Le code insee doit contenir 5 caractères",
                  "example": "54318",
                  "maxLength": 5,
                  "minLength": 5,
                  "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                },
                "code_postal": {
                  "bsonType": "string",
                  "description": "Le code postal doit contenir 5 caractères",
                  "example": "75000",
                  "maxLength": 5,
                  "minLength": 5,
                  "pattern": "^[0-9]{5}$",
                },
                "commune": {
                  "bsonType": "string",
                  "description": "Commune",
                  "example": "PARIS",
                  "maxLength": 80,
                },
                "complement": {
                  "bsonType": "string",
                  "description": "Complément d'adresse",
                  "example": "Bâtiment ; Résidence ; Entrée ; Appartement ; Escalier ; Etage",
                },
                "complete": {
                  "bsonType": "string",
                  "description": "Adresse complète",
                  "example": "13 Bis Boulevard de la liberté 75000 PARIS",
                },
                "departement": {
                  "bsonType": "string",
                  "enum": [
                    "01",
                    "02",
                    "03",
                    "04",
                    "05",
                    "06",
                    "07",
                    "08",
                    "09",
                    "10",
                    "11",
                    "12",
                    "13",
                    "14",
                    "15",
                    "16",
                    "17",
                    "18",
                    "19",
                    "21",
                    "22",
                    "23",
                    "24",
                    "25",
                    "26",
                    "27",
                    "28",
                    "29",
                    "2A",
                    "2B",
                    "30",
                    "31",
                    "32",
                    "33",
                    "34",
                    "35",
                    "36",
                    "37",
                    "38",
                    "39",
                    "40",
                    "41",
                    "42",
                    "43",
                    "44",
                    "45",
                    "46",
                    "47",
                    "48",
                    "49",
                    "50",
                    "51",
                    "52",
                    "53",
                    "54",
                    "55",
                    "56",
                    "57",
                    "58",
                    "59",
                    "60",
                    "61",
                    "62",
                    "63",
                    "64",
                    "65",
                    "66",
                    "67",
                    "68",
                    "69",
                    "70",
                    "71",
                    "72",
                    "73",
                    "74",
                    "75",
                    "76",
                    "77",
                    "78",
                    "79",
                    "80",
                    "81",
                    "82",
                    "83",
                    "84",
                    "85",
                    "86",
                    "87",
                    "88",
                    "89",
                    "90",
                    "91",
                    "92",
                    "93",
                    "94",
                    "95",
                    "971",
                    "972",
                    "973",
                    "974",
                    "975",
                    "976",
                    "977",
                    "978",
                    "984",
                    "986",
                    "987",
                    "988",
                    "989",
                  ],
                  "example": "1 Ain, 99 Étranger",
                  "maxLength": 3,
                  "minLength": 1,
                  "pattern": "^([0-9][0-9]|2[AB]|9[012345]|97[12345678]|98[46789])$",
                },
                "numero": {
                  "bsonType": "int",
                  "description": "N° de la voie",
                  "example": 13,
                  "pattern": "^(?!0{1})[0-9]*$",
                },
                "pays": {
                  "bsonType": "string",
                  "description": "Pays",
                  "enum": [
                    "AF",
                    "ZA",
                    "AL",
                    "DZ",
                    "DE",
                    "AD",
                    "AO",
                    "AG",
                    "SA",
                    "AR",
                    "AM",
                    "AU",
                    "AT",
                    "AZ",
                    "BS",
                    "BH",
                    "BD",
                    "BB",
                    "BE",
                    "BZ",
                    "BJ",
                    "BT",
                    "BY",
                    "MM",
                    "BO",
                    "BQ",
                    "BA",
                    "BW",
                    "BR",
                    "BN",
                    "BG",
                    "BF",
                    "BI",
                    "KH",
                    "CM",
                    "CA",
                    "CV",
                    "CF",
                    "CL",
                    "CN",
                    "CY",
                    "CO",
                    "KM",
                    "CG",
                    "CD",
                    "KR",
                    "KP",
                    "CR",
                    "CI",
                    "HR",
                    "CU",
                    "CW",
                    "DK",
                    "DJ",
                    "DO",
                    "DM",
                    "EG",
                    "SV",
                    "AE",
                    "EC",
                    "ER",
                    "ES",
                    "EE",
                    "SZ",
                    "US",
                    "ET",
                    "MK",
                    "FJ",
                    "FI",
                    "FR",
                    "GA",
                    "GM",
                    "GE",
                    "GH",
                    "GR",
                    "GD",
                    "GT",
                    "GN",
                    "GQ",
                    "GW",
                    "GY",
                    "HT",
                    "HN",
                    "HU",
                    "IN",
                    "ID",
                    "IR",
                    "IQ",
                    "IE",
                    "IS",
                    "IL",
                    "IT",
                    "JM",
                    "JP",
                    "JO",
                    "KZ",
                    "KE",
                    "KG",
                    "KI",
                    "XK",
                    "KW",
                    "LA",
                    "LS",
                    "LV",
                    "LB",
                    "LR",
                    "LY",
                    "LI",
                    "LT",
                    "LU",
                    "MG",
                    "MY",
                    "MW",
                    "MV",
                    "ML",
                    "MT",
                    "MA",
                    "MH",
                    "MU",
                    "MR",
                    "MX",
                    "FM",
                    "MD",
                    "MC",
                    "MN",
                    "ME",
                    "MZ",
                    "NA",
                    "NR",
                    "NP",
                    "NI",
                    "NE",
                    "NG",
                    "NO",
                    "NZ",
                    "OM",
                    "UG",
                    "UZ",
                    "PK",
                    "PW",
                    "PS",
                    "PA",
                    "PG",
                    "PY",
                    "NL",
                    "PE",
                    "PH",
                    "PL",
                    "PT",
                    "QA",
                    "RO",
                    "GB",
                    "RU",
                    "RW",
                    "KN",
                    "SM",
                    "SX",
                    "VC",
                    "LC",
                    "SB",
                    "WS",
                    "ST",
                    "SN",
                    "RS",
                    "SC",
                    "SL",
                    "SG",
                    "SK",
                    "SI",
                    "SO",
                    "SD",
                    "SS",
                    "LK",
                    "SE",
                    "CH",
                    "SR",
                    "SY",
                    "TJ",
                    "TZ",
                    "TD",
                    "CZ",
                    "TH",
                    "TL",
                    "TG",
                    "TO",
                    "TT",
                    "TN",
                    "TM",
                    "TR",
                    "TV",
                    "UA",
                    "UY",
                    "VU",
                    "VA",
                    "VE",
                    "VN",
                    "YE",
                    "ZM",
                    "ZW",
                  ],
                },
                "region": {
                  "bsonType": "string",
                  "enum": [
                    "01",
                    "02",
                    "03",
                    "04",
                    "06",
                    "11",
                    "24",
                    "27",
                    "28",
                    "32",
                    "44",
                    "52",
                    "53",
                    "75",
                    "76",
                    "84",
                    "93",
                    "94",
                    "978",
                    "977",
                    "00",
                  ],
                },
                "repetition_voie": {
                  "bsonType": "string",
                  "description": "Indice de répétition du numéro de voie",
                  "enum": [
                    "B",
                    "T",
                    "Q",
                    "C",
                  ],
                  "example": "B",
                },
                "voie": {
                  "bsonType": "string",
                  "description": "Nom de voie",
                  "example": "Boulevard de la liberté",
                },
              },
            },
            "courriel": {
              "bsonType": "string",
              "description": "Adresse mail de contact du representant légal",
            },
            "meme_adresse": {
              "bsonType": "bool",
              "description": "l'apprenti(e) vit à la même adresse que son representant légal",
            },
            "nom": {
              "bsonType": "string",
              "description": "Nom du representant légal",
            },
            "pcs": {
              "bsonType": "int",
              "description": "Nomenclatures des professions et catégories socioprofessionnelles",
              "enum": [
                10,
                21,
                22,
                23,
                31,
                33,
                34,
                37,
                38,
                42,
                43,
                44,
                45,
                46,
                47,
                48,
                52,
                53,
                54,
                55,
                56,
                61,
                66,
                69,
                71,
                72,
                73,
                76,
                81,
                82,
                99,
              ],
            },
            "prenom": {
              "bsonType": "string",
              "description": "Prénom du representant légal",
            },
            "telephone": {
              "bsonType": "string",
              "description": "Dans le cas d'un numéro français, il n'est pas
    nécessaire de saisir le "0" car l'indicateur pays est
    pré-renseigné.
    Il doit contenir 9 chiffres après l'indicatif.",
              "example": "+33908070605",
              "maxLength": 13,
              "minLength": 8,
              "pattern": "^([+])?(\\d{7,12})$",
            },
          },
        },
        "responsable_mail1": {
          "bsonType": "string",
          "description": "Adresse mail du responsable 1",
        },
        "responsable_mail2": {
          "bsonType": "string",
          "description": "Adresse mail du responsable 2",
        },
        "rqth": {
          "bsonType": "bool",
          "description": "Apprenant en situation d'handicape (RQTH)",
        },
        "sexe": {
          "bsonType": "string",
          "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
          "enum": [
            "M",
            "F",
          ],
        },
        "situation_avant_contrat": {
          "bsonType": "int",
          "description": "Situation de l'apprenant avant le contrat",
          "enum": [
            11,
            12,
            21,
            31,
            41,
            51,
            52,
            53,
            54,
            90,
            99,
          ],
        },
        "telephone": {
          "bsonType": "string",
          "description": "Téléphone de l'apprenant",
          "example": "+33908070605",
          "maxLength": 13,
          "minLength": 8,
          "pattern": "^([+])?(\\d{7,12})$",
        },
        "type_cfa": {
          "bsonType": "string",
          "description": "Type de CFA",
          "enum": [
            "01",
            "02",
            "03",
            "04",
            "05",
            "06",
            "07",
            "08",
            "09",
            "10",
          ],
        },
      },
      "required": [
        "nom",
        "prenom",
        "historique_statut",
      ],
    },
    "archive": {
      "bsonType": "bool",
      "description": "Dossier apprenant est archivé (rétention maximum 5 ans)",
    },
    "contrats": {
      "bsonType": "array",
      "description": "Historique des contrats de l'apprenant",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "adresse": {
            "additionalProperties": false,
            "bsonType": "object",
            "properties": {
              "academie": {
                "bsonType": "string",
                "enum": [
                  "1",
                  "2",
                  "3",
                  "4",
                  "6",
                  "7",
                  "8",
                  "9",
                  "10",
                  "11",
                  "12",
                  "13",
                  "14",
                  "15",
                  "16",
                  "17",
                  "18",
                  "19",
                  "20",
                  "22",
                  "23",
                  "24",
                  "25",
                  "27",
                  "28",
                  "31",
                  "32",
                  "33",
                  "43",
                  "44",
                  "70",
                  "77",
                  "78",
                ],
              },
              "bassinEmploi": {
                "bsonType": "string",
                "description": "Code Bassin d'emploi",
              },
              "code_insee": {
                "bsonType": "string",
                "description": "Le code insee doit contenir 5 caractères",
                "example": "54318",
                "maxLength": 5,
                "minLength": 5,
                "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
              },
              "code_postal": {
                "bsonType": "string",
                "description": "Le code postal doit contenir 5 caractères",
                "example": "75000",
                "maxLength": 5,
                "minLength": 5,
                "pattern": "^[0-9]{5}$",
              },
              "commune": {
                "bsonType": "string",
                "description": "Commune",
                "example": "PARIS",
                "maxLength": 80,
              },
              "complement": {
                "bsonType": "string",
                "description": "Complément d'adresse",
                "example": "Bâtiment ; Résidence ; Entrée ; Appartement ; Escalier ; Etage",
              },
              "complete": {
                "bsonType": "string",
                "description": "Adresse complète",
                "example": "13 Bis Boulevard de la liberté 75000 PARIS",
              },
              "departement": {
                "bsonType": "string",
                "enum": [
                  "01",
                  "02",
                  "03",
                  "04",
                  "05",
                  "06",
                  "07",
                  "08",
                  "09",
                  "10",
                  "11",
                  "12",
                  "13",
                  "14",
                  "15",
                  "16",
                  "17",
                  "18",
                  "19",
                  "21",
                  "22",
                  "23",
                  "24",
                  "25",
                  "26",
                  "27",
                  "28",
                  "29",
                  "2A",
                  "2B",
                  "30",
                  "31",
                  "32",
                  "33",
                  "34",
                  "35",
                  "36",
                  "37",
                  "38",
                  "39",
                  "40",
                  "41",
                  "42",
                  "43",
                  "44",
                  "45",
                  "46",
                  "47",
                  "48",
                  "49",
                  "50",
                  "51",
                  "52",
                  "53",
                  "54",
                  "55",
                  "56",
                  "57",
                  "58",
                  "59",
                  "60",
                  "61",
                  "62",
                  "63",
                  "64",
                  "65",
                  "66",
                  "67",
                  "68",
                  "69",
                  "70",
                  "71",
                  "72",
                  "73",
                  "74",
                  "75",
                  "76",
                  "77",
                  "78",
                  "79",
                  "80",
                  "81",
                  "82",
                  "83",
                  "84",
                  "85",
                  "86",
                  "87",
                  "88",
                  "89",
                  "90",
                  "91",
                  "92",
                  "93",
                  "94",
                  "95",
                  "971",
                  "972",
                  "973",
                  "974",
                  "975",
                  "976",
                  "977",
                  "978",
                  "984",
                  "986",
                  "987",
                  "988",
                  "989",
                ],
                "example": "1 Ain, 99 Étranger",
                "maxLength": 3,
                "minLength": 1,
                "pattern": "^([0-9][0-9]|2[AB]|9[012345]|97[12345678]|98[46789])$",
              },
              "numero": {
                "bsonType": "int",
                "description": "N° de la voie",
                "example": 13,
                "pattern": "^(?!0{1})[0-9]*$",
              },
              "pays": {
                "bsonType": "string",
                "description": "Pays",
                "enum": [
                  "AF",
                  "ZA",
                  "AL",
                  "DZ",
                  "DE",
                  "AD",
                  "AO",
                  "AG",
                  "SA",
                  "AR",
                  "AM",
                  "AU",
                  "AT",
                  "AZ",
                  "BS",
                  "BH",
                  "BD",
                  "BB",
                  "BE",
                  "BZ",
                  "BJ",
                  "BT",
                  "BY",
                  "MM",
                  "BO",
                  "BQ",
                  "BA",
                  "BW",
                  "BR",
                  "BN",
                  "BG",
                  "BF",
                  "BI",
                  "KH",
                  "CM",
                  "CA",
                  "CV",
                  "CF",
                  "CL",
                  "CN",
                  "CY",
                  "CO",
                  "KM",
                  "CG",
                  "CD",
                  "KR",
                  "KP",
                  "CR",
                  "CI",
                  "HR",
                  "CU",
                  "CW",
                  "DK",
                  "DJ",
                  "DO",
                  "DM",
                  "EG",
                  "SV",
                  "AE",
                  "EC",
                  "ER",
                  "ES",
                  "EE",
                  "SZ",
                  "US",
                  "ET",
                  "MK",
                  "FJ",
                  "FI",
                  "FR",
                  "GA",
                  "GM",
                  "GE",
                  "GH",
                  "GR",
                  "GD",
                  "GT",
                  "GN",
                  "GQ",
                  "GW",
                  "GY",
                  "HT",
                  "HN",
                  "HU",
                  "IN",
                  "ID",
                  "IR",
                  "IQ",
                  "IE",
                  "IS",
                  "IL",
                  "IT",
                  "JM",
                  "JP",
                  "JO",
                  "KZ",
                  "KE",
                  "KG",
                  "KI",
                  "XK",
                  "KW",
                  "LA",
                  "LS",
                  "LV",
                  "LB",
                  "LR",
                  "LY",
                  "LI",
                  "LT",
                  "LU",
                  "MG",
                  "MY",
                  "MW",
                  "MV",
                  "ML",
                  "MT",
                  "MA",
                  "MH",
                  "MU",
                  "MR",
                  "MX",
                  "FM",
                  "MD",
                  "MC",
                  "MN",
                  "ME",
                  "MZ",
                  "NA",
                  "NR",
                  "NP",
                  "NI",
                  "NE",
                  "NG",
                  "NO",
                  "NZ",
                  "OM",
                  "UG",
                  "UZ",
                  "PK",
                  "PW",
                  "PS",
                  "PA",
                  "PG",
                  "PY",
                  "NL",
                  "PE",
                  "PH",
                  "PL",
                  "PT",
                  "QA",
                  "RO",
                  "GB",
                  "RU",
                  "RW",
                  "KN",
                  "SM",
                  "SX",
                  "VC",
                  "LC",
                  "SB",
                  "WS",
                  "ST",
                  "SN",
                  "RS",
                  "SC",
                  "SL",
                  "SG",
                  "SK",
                  "SI",
                  "SO",
                  "SD",
                  "SS",
                  "LK",
                  "SE",
                  "CH",
                  "SR",
                  "SY",
                  "TJ",
                  "TZ",
                  "TD",
                  "CZ",
                  "TH",
                  "TL",
                  "TG",
                  "TO",
                  "TT",
                  "TN",
                  "TM",
                  "TR",
                  "TV",
                  "UA",
                  "UY",
                  "VU",
                  "VA",
                  "VE",
                  "VN",
                  "YE",
                  "ZM",
                  "ZW",
                ],
              },
              "region": {
                "bsonType": "string",
                "enum": [
                  "01",
                  "02",
                  "03",
                  "04",
                  "06",
                  "11",
                  "24",
                  "27",
                  "28",
                  "32",
                  "44",
                  "52",
                  "53",
                  "75",
                  "76",
                  "84",
                  "93",
                  "94",
                  "978",
                  "977",
                  "00",
                ],
              },
              "repetition_voie": {
                "bsonType": "string",
                "description": "Indice de répétition du numéro de voie",
                "enum": [
                  "B",
                  "T",
                  "Q",
                  "C",
                ],
                "example": "B",
              },
              "voie": {
                "bsonType": "string",
                "description": "Nom de voie",
                "example": "Boulevard de la liberté",
              },
            },
          },
          "cause_rupture": {
            "bsonType": "string",
            "description": "Cause de rupture du contrat",
          },
          "date_debut": {
            "bsonType": "date",
            "description": "Date de début du contrat",
          },
          "date_fin": {
            "bsonType": "date",
            "description": "Date de fin du contrat",
          },
          "date_rupture": {
            "bsonType": "date",
            "description": "Date de rupture du contrat",
          },
          "denomination": {
            "bsonType": "string",
            "description": "La dénomination sociale doit être celle de l'établissement dans lequel le contrat s'exécute.",
          },
          "naf": {
            "bsonType": "string",
            "description": "Le Code NAF est composé de 4 chiffres et 1 lettre. Il est délivré par l'INSEE.[Informations sur le Code NAF.](https://www.economie.gouv.fr/entreprises/activite-entreprise-code-ape-code-naf)",
            "example": "1031Z",
            "maxLength": 6,
            "pattern": "^([0-9]){2}\\.?([0-9]){0,2}([a-zA-Z]){0,1}$",
          },
          "nombre_de_salaries": {
            "bsonType": "int",
            "description": "L'effectif salarié rempli automatiquement correspond à l'estimation de la base Entreprises de l'INSEE. <br/>L'effectif renseigné est celui de l’entreprise dans sa globalité (et non seulement l’effectif de l’établissement d’exécution du contrat).",
            "example": 123,
          },
          "siret": {
            "bsonType": "string",
            "description": "N° SIRET de l'employeur",
            "maxLength": 14,
            "minLength": 14,
            "pattern": "^[0-9]{14}$",
          },
          "type_employeur": {
            "bsonType": "int",
            "description": "Le type d'employeur doit être en adéquation avec son statut juridique.",
            "enum": [
              11,
              12,
              13,
              14,
              15,
              16,
              21,
              22,
              23,
              24,
              25,
              26,
              27,
              28,
              29,
            ],
          },
        },
        "required": [
          "date_debut",
        ],
      },
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "formation": {
      "additionalProperties": true,
      "bsonType": "object",
      "properties": {
        "annee": {
          "bsonType": "int",
          "description": "Numéro de l'année dans la formation (promo)",
        },
        "cause_exclusion": {
          "bsonType": "string",
          "description": "Cause de l'exclusion",
        },
        "cfd": {
          "bsonType": "string",
          "description": "Code CFD de la formation",
          "maxLength": 8,
          "pattern": "^[A-Z0-9]{8}$",
        },
        "date_entree": {
          "bsonType": "date",
          "description": "Date d'entrée en formation",
        },
        "date_exclusion": {
          "bsonType": "date",
          "description": "Date d'exclusion",
        },
        "date_fin": {
          "bsonType": "date",
          "description": "Date de fin de la formation",
        },
        "date_inscription": {
          "bsonType": "date",
          "description": "Date d'inscription",
        },
        "date_obtention_diplome": {
          "bsonType": "date",
          "description": "Date d'obtention du diplôme",
        },
        "duree_formation_relle": {
          "bsonType": "int",
          "description": "Durée réelle de la formation en mois",
        },
        "duree_theorique": {
          "bsonType": "int",
          "description": "Durée théorique de la formation en année",
        },
        "duree_theorique_mois": {
          "bsonType": "int",
          "description": "Durée théorique de la formation en mois",
        },
        "formation_id": {
          "bsonType": "objectId",
          "description": "ID de la formation",
        },
        "formation_presentielle": {
          "bsonType": "bool",
          "description": "Formation en présentiel",
        },
        "libelle_long": {
          "bsonType": "string",
          "description": "Libellé long de la formation visée",
        },
        "niveau": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Niveau de formation récupéré via Tables de Correspondances",
        },
        "niveau_libelle": {
          "bsonType": [
            "string",
            "null",
          ],
          "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
        },
        "obtention_diplome": {
          "bsonType": "bool",
          "description": "Diplôme obtenu",
        },
        "periode": {
          "bsonType": "array",
          "description": "Période de la formation, en année (peut être sur plusieurs années)",
          "items": {
            "bsonType": "int",
          },
        },
        "referent_handicap": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "email": {
              "bsonType": "string",
              "description": "Email du référent handicap",
            },
            "nom": {
              "bsonType": "string",
              "description": "Nom du référent handicap",
            },
            "prenom": {
              "bsonType": "string",
              "description": "Prénom du référent handicap",
            },
          },
        },
        "rncp": {
          "bsonType": "string",
          "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
          "maxLength": 9,
          "pattern": "^(RNCP)?[0-9]{2,5}$",
        },
      },
    },
    "id_erp_apprenant": {
      "bsonType": "string",
      "description": "Identifiant de l'apprenant dans l'erp",
    },
    "is_lock": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Indique les champs verrouillés",
    },
    "organisme_formateur_id": {
      "bsonType": "objectId",
      "description": "Organisme formateur id",
    },
    "organisme_id": {
      "bsonType": "objectId",
      "description": "Organisme id (lieu de formation de l'apprenant pour la v3)",
    },
    "organisme_responsable_id": {
      "bsonType": "objectId",
      "description": "Organisme responsable id",
    },
    "source": {
      "bsonType": "string",
      "description": "Source du dossier apprenant (Ymag, Gesti, TDB_MANUEL, TDB_FILE...)",
    },
    "source_organisme_id": {
      "bsonType": "string",
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "updated_at": {
      "bsonType": "date",
      "description": "Date de mise à jour en base de données",
    },
    "validation_errors": {
      "bsonType": "array",
      "description": "Erreurs de validation de cet effectif",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "fieldName": {
            "bsonType": "string",
            "description": "Nom du champ en erreur",
          },
          "inputValue": {
            "bsonType": "string",
            "description": "Valeur fournie en entrée",
          },
          "message": {
            "bsonType": "string",
            "description": "Message de l'erreur",
          },
          "type": {
            "bsonType": "string",
            "description": "Type d'erreur",
          },
        },
      },
    },
  },
  "required": [
    "apprenant",
    "id_erp_apprenant",
    "organisme_id",
    "source",
    "annee_scolaire",
  ],
}
`;

exports[`validation-schema should create validation schema for effectifsQueue: effectifsQueue 1`] = `
{
  "additionalProperties": true,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "adresse_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Adresse de l'apprenant",
    },
    "annee_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Numéro de l'année dans la formation (promo)",
    },
    "annee_scolaire": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Année scolaire sur laquelle l'apprenant est enregistré (ex: "2020-2021")",
    },
    "api_version": {
      "bsonType": "string",
      "description": "Version de l'api utilisée (v2 ou v3)",
    },
    "cause_exclusion_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "cause_rupture_contrat": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Cause de rupture du contrat",
    },
    "cause_rupture_contrat_2": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Cause de rupture du contrat 2",
    },
    "cause_rupture_contrat_3": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Cause de rupture du contrat 3",
    },
    "cause_rupture_contrat_4": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Cause de rupture du contrat 4",
    },
    "code_commune_insee_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Code commune insee de l'apprenant",
    },
    "code_postal_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Code postal de l'apprenant",
    },
    "code_postal_de_naissance_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Le code postal doit contenir 5 caractères.  
Pour les jeunes résidents à l’étranger, il conviendra de mettre « 99 » suivi du numéro de pays.  
*Exemple : pour l’Allemagne le code pays est 109, il conviendra donc de saisir : « 99109 »*",
    },
    "contrat_date_debut": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de début du contrat",
    },
    "contrat_date_debut_2": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de début du contrat 2",
    },
    "contrat_date_debut_3": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de début du contrat 3",
    },
    "contrat_date_debut_4": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de début du contrat 4",
    },
    "contrat_date_fin": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de fin du contrat",
    },
    "contrat_date_fin_2": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de fin du contrat 2",
    },
    "contrat_date_fin_3": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de fin du contrat 3",
    },
    "contrat_date_fin_4": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de fin du contrat 4",
    },
    "contrat_date_rupture": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de rupture du contrat",
    },
    "contrat_date_rupture_2": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de rupture du contrat 2",
    },
    "contrat_date_rupture_3": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de rupture du contrat 3",
    },
    "contrat_date_rupture_4": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de rupture du contrat 4",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "date_de_naissance_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de naissance de l'apprenant",
    },
    "date_entree_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date d'entrée en formation",
    },
    "date_exclusion_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "date_fin_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de fin de la formation",
    },
    "date_inscription_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date d'inscription",
    },
    "date_metier_mise_a_jour_statut": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "date_obtention_diplome_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date d'obtention du diplôme",
    },
    "date_rqth_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Date de reconnaissance du RQTH de l'apprenant",
    },
    "dernier_organisme_uai": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Numéro UAI de l’établissement fréquenté l’année dernière (N-1), si déjà en apprentissage, mettre l’UAI du site de formation ou département",
    },
    "derniere_situation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Situation de l'apprenant N-1",
    },
    "duree_theorique_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Durée théorique de la formation en années",
    },
    "duree_theorique_formation_mois": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Durée théorique de la formation en mois",
    },
    "effectif_id": {
      "bsonType": "objectId",
      "description": "Id de l'effectif associé",
    },
    "email_contact": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Adresse mail de contact de l'apprenant",
    },
    "email_referent_handicap_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "error": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Erreur rencontrée lors de la création de l'effectif",
    },
    "etablissement_formateur_siret": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "SIRET de l'établissement formateur",
    },
    "etablissement_formateur_uai": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "UAI de l'établissement formateur",
    },
    "etablissement_lieu_de_formation_siret": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "SIRET de l'établissement (lieu de formation)",
    },
    "etablissement_lieu_de_formation_uai": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "UAI de l'établissement (lieu de formation)",
    },
    "etablissement_responsable_siret": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "SIRET de l'établissement responsable",
    },
    "etablissement_responsable_uai": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "UAI de l'établissement responsable",
    },
    "formation_cfd": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Code CFD de la formation",
    },
    "formation_presentielle": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Formation 100% à distance ou non",
    },
    "formation_rncp": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Code RNCP de la formation à laquelle l'apprenant est inscrit",
    },
    "has_nir": {
      "bsonType": "bool",
      "description": "Identification nationale securité social",
    },
    "id_erp_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Identifiant de l'apprenant dans l'erp",
    },
    "id_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Code CFD de la formation",
    },
    "ine_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "N° INE de l'apprenant",
    },
    "libelle_long_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Libellé long de la formation visée",
    },
    "nom_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Nom de l'apprenant",
    },
    "nom_etablissement": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Nom de l'organisme de formation",
    },
    "nom_referent_handicap_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "obtention_diplome_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "organisme_id": {
      "bsonType": "objectId",
      "description": "Id de l'organisme associé",
    },
    "periode_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Période de la formation, en année (peut être sur plusieurs années)",
    },
    "prenom_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Prénom de l'apprenant",
    },
    "prenom_referent_handicap_formation": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
    },
    "processed_at": {
      "bsonType": "date",
      "description": "Date de process des données",
    },
    "responsable_apprenant_mail1": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Mail du responsable de l'apprenant",
    },
    "responsable_apprenant_mail2": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Mail du responsable de l'apprenant",
    },
    "rqth_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Reconnaissance de la Qualité de Travailleur Handicapé de l'apprenant",
    },
    "sexe_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Sexe de l'apprenant (M: Homme, F: Femme)",
    },
    "siret_employeur": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "N° SIRET de l'établissement",
    },
    "siret_employeur_2": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "N° SIRET de l'établissement",
    },
    "siret_employeur_3": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "N° SIRET de l'établissement",
    },
    "siret_employeur_4": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "N° SIRET de l'établissement",
    },
    "siret_etablissement": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "N° SIRET de l'établissement",
    },
    "source": {
      "bsonType": "string",
      "description": "Source du dossier apprenant (Ymag, Gesti, TDB_MANUEL, TDB_FILE...)",
    },
    "source_organisme_id": {
      "bsonType": "string",
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "statut_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "0,2,3",
    },
    "tel_apprenant": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Téléphone de l'apprenant",
    },
    "type_cfa": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Type de CFA (nomenclature SIFA)",
    },
    "uai_etablissement": {
      "additionalProperties": true,
      "bsonType": [
        "number",
        "string",
        "bool",
        "object",
        "array",
        "null",
      ],
      "description": "Code UAI de l'établissement",
    },
    "updated_at": {
      "bsonType": "date",
      "description": "Date de mise à jour en base de données",
    },
    "validation_errors": {
      "bsonType": "array",
      "description": "Erreurs de validation de cet effectif",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "message": {
            "additionalProperties": true,
            "bsonType": [
              "number",
              "string",
              "bool",
              "object",
              "array",
              "null",
            ],
            "description": "message d'erreur",
          },
          "path": {
            "additionalProperties": true,
            "bsonType": [
              "number",
              "string",
              "bool",
              "object",
              "array",
              "null",
            ],
            "description": "champ en erreur",
          },
        },
      },
    },
  },
  "required": [
    "source",
    "created_at",
  ],
}
`;

exports[`validation-schema should create validation schema for fiabilisationUaiSiret: fiabilisationUaiSiret 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "created_at": {
      "bsonType": "date",
    },
    "siret": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Le SIRET du couple à fiabiliser",
    },
    "siret_fiable": {
      "bsonType": "string",
      "description": "Le SIRET fiable lié au couple à fiabiliser",
    },
    "type": {
      "bsonType": "string",
      "description": "Statut de fiabilisation du couple UAI SIRET",
      "enum": [
        "FIABLE",
        "A_FIABILISER",
        "NON_FIABILISABLE_INEXISTANT",
        "NON_FIABILISABLE_PB_COLLECTE",
        "NON_FIABILISABLE_UAI_VALIDEE",
        "NON_FIABILISABLE_UAI_NON_VALIDEE",
      ],
    },
    "uai": {
      "bsonType": "string",
      "description": "L'UAI du couple à fiabiliser",
    },
    "uai_fiable": {
      "bsonType": "string",
      "description": "L'UAI fiable lié au couple à fiabiliser",
    },
  },
}
`;

exports[`validation-schema should create validation schema for formations: formations 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "annee": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Année de la formation (cursus)",
    },
    "cfd": {
      "bsonType": "string",
      "description": "Code CFD de la formation",
      "maxLength": 8,
      "pattern": "^[A-Z0-9]{8}$",
    },
    "cfd_end_date": {
      "bsonType": [
        "date",
        "null",
      ],
      "description": "Date de fermeture du CFD",
    },
    "cfd_start_date": {
      "bsonType": [
        "date",
        "null",
      ],
      "description": "Date d'ouverture du CFD",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "duree": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Durée de la formation théorique",
    },
    "libelle": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Libellé normalisé depuis Tables de Correspondances",
    },
    "metiers": {
      "bsonType": "array",
      "description": "Les domaines métiers rattachés à la formation",
      "items": {
        "bsonType": "string",
      },
    },
    "niveau": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Niveau de formation récupéré via Tables de Correspondances",
    },
    "niveau_libelle": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Libellé du niveau de formation récupéré via Tables de Correspondances",
    },
    "rncps": {
      "bsonType": "array",
      "description": "Liste des codes RNCPs de la formation récupéré depuis Tables de Correspondances",
      "items": {
        "bsonType": "string",
      },
    },
    "updated_at": {
      "bsonType": [
        "date",
        "null",
      ],
      "description": "Date d'update en base de données",
    },
  },
  "required": [
    "cfd",
  ],
}
`;

exports[`validation-schema should create validation schema for formationsCatalogue: formationsCatalogue 1`] = `
{
  "additionalProperties": true,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "annee": {
      "bsonType": "string",
    },
    "annee_incoherente": {
      "bsonType": "bool",
    },
    "bcn_mefs_10": {
      "anyOf": [
        {
          "bsonType": "array",
          "items": {
            "anyOf": [
              {
                "not": {},
              },
              {
                "anyOf": [
                  {
                    "additionalProperties": false,
                    "bsonType": "object",
                    "properties": {
                      "mef10": {
                        "bsonType": [
                          "string",
                          "null",
                        ],
                      },
                      "modalite": {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "annee": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "duree": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                            },
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                    },
                  },
                  {
                    "bsonType": "null",
                  },
                ],
              },
            ],
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "capacite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "catalogue_published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "cfd": {
      "bsonType": "string",
    },
    "cfd_date_fermeture": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "cfd_entree": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "cfd_outdated": {
      "bsonType": "bool",
    },
    "cfd_specialite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "cle_ministere_educatif": {
      "bsonType": "string",
    },
    "code_commune_insee": {
      "bsonType": "string",
    },
    "code_postal": {
      "bsonType": "string",
    },
    "created_at": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "date_debut": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
    "date_fin": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
    "diplome": {
      "bsonType": "string",
    },
    "distance": {
      "bsonType": [
        "number",
        "null",
      ],
    },
    "distance_lieu_formation_etablissement_formateur": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "duree": {
      "bsonType": "string",
    },
    "duree_incoherente": {
      "bsonType": "bool",
    },
    "entierement_a_distance": {
      "bsonType": "bool",
    },
    "etablissement_formateur_adresse": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_cedex": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_certifie_qualite": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_formateur_code_commune_insee": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_code_postal": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_complement_adresse": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_date_creation": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_enseigne": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_entreprise_raison_sociale": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_habilite_rncp": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_formateur_id": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_localite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_nda": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_nom_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_nom_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_num_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_num_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_formateur_region": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_siren": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_formateur_siret": {
      "bsonType": "string",
    },
    "etablissement_formateur_uai": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_adresse": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_cedex": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_certifie_qualite": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_gestionnaire_code_commune_insee": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_code_postal": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_complement_adresse": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_date_creation": {
      "bsonType": "string",
    },
    "etablissement_gestionnaire_enseigne": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_entreprise_raison_sociale": {
      "bsonType": "string",
    },
    "etablissement_gestionnaire_habilite_rncp": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_gestionnaire_id": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_localite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_nda": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_nom_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_nom_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_num_academie": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_num_departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_gestionnaire_region": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_siren": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_gestionnaire_siret": {
      "bsonType": "string",
    },
    "etablissement_gestionnaire_uai": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_reference": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_reference_certifie_qualite": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_reference_date_creation": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "etablissement_reference_habilite_rncp": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "etablissement_reference_published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "forced_published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "france_competence_infos": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "geo_coordonnees_etablissement_formateur": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "geo_coordonnees_etablissement_gestionnaire": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "id_RCO": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "id_action": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "id_certifinfo": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "id_formation": {
      "bsonType": "string",
    },
    "id_rco_formation": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "idea_geo_coordonnees_etablissement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "ids_action": {
      "bsonType": "array",
      "items": {
        "anyOf": [
          {
            "not": {},
          },
          {
            "bsonType": [
              "string",
              "null",
            ],
          },
        ],
      },
    },
    "intitule_court": {
      "bsonType": "string",
    },
    "intitule_long": {
      "bsonType": "string",
    },
    "intitule_rco": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "last_update_at": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "libelle_court": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "lieu_formation_adresse": {
      "bsonType": "string",
    },
    "lieu_formation_adresse_computed": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "lieu_formation_geo_coordonnees": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "lieu_formation_geo_coordonnees_computed": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "lieu_formation_siret": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "localite": {
      "bsonType": "string",
    },
    "modalites_entrees_sorties": {
      "bsonType": "array",
      "items": {
        "anyOf": [
          {
            "not": {},
          },
          {
            "bsonType": [
              "bool",
              "null",
            ],
          },
        ],
      },
    },
    "niveau": {
      "bsonType": "string",
    },
    "niveau_entree_obligatoire": {
      "bsonType": [
        "number",
        "null",
      ],
    },
    "niveau_formation_diplome": {
      "bsonType": "string",
    },
    "nom": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "nom_academie": {
      "bsonType": "string",
    },
    "nom_departement": {
      "bsonType": "string",
    },
    "num_academie": {
      "bsonType": "string",
    },
    "num_departement": {
      "bsonType": "string",
    },
    "onisep_discipline": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_domaine_sousdomaine": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_intitule": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_libelle_poursuite": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_lien_site_onisepfr": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "onisep_url": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "periode": {
      "bsonType": "array",
      "items": {
        "anyOf": [
          {
            "not": {},
          },
          {
            "bsonType": [
              "string",
              "null",
            ],
          },
        ],
      },
    },
    "published": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "region": {
      "bsonType": "string",
    },
    "rncp_code": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "rncp_details": {
      "anyOf": [
        {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "active_inactive": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "ancienne_fiche": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "items": {
                    "anyOf": [
                      {
                        "not": {},
                      },
                      {
                        "bsonType": [
                          "string",
                          "null",
                        ],
                      },
                    ],
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "blocs_competences": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "items": {
                    "anyOf": [
                      {
                        "not": {},
                      },
                      {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "intitule": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "liste_competences": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "modalites_evaluation": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "numero_bloc": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                            },
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                    ],
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "certificateurs": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "items": {
                    "anyOf": [
                      {
                        "not": {},
                      },
                      {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "certificateur": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "siret_certificateur": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                            },
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                    ],
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "code_type_certif": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "date_fin_validite_enregistrement": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "demande": {
              "bsonType": [
                "number",
                "null",
              ],
            },
            "etat_fiche_rncp": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "niveau_europe": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "nouvelle_fiche": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "items": {
                    "anyOf": [
                      {
                        "not": {},
                      },
                      {
                        "bsonType": [
                          "string",
                          "null",
                        ],
                      },
                    ],
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "nsf_code": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "nsf_libelle": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "partenaires": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "items": {
                    "anyOf": [
                      {
                        "not": {},
                      },
                      {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "Habilitation_Partenaire": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "Nom_Partenaire": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "Siret_Partenaire": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                            },
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                    ],
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "rncp_outdated": {
              "bsonType": [
                "bool",
                "null",
              ],
            },
            "romes": {
              "anyOf": [
                {
                  "bsonType": "array",
                  "items": {
                    "anyOf": [
                      {
                        "not": {},
                      },
                      {
                        "anyOf": [
                          {
                            "additionalProperties": false,
                            "bsonType": "object",
                            "properties": {
                              "libelle": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                              "rome": {
                                "bsonType": [
                                  "string",
                                  "null",
                                ],
                              },
                            },
                          },
                          {
                            "bsonType": "null",
                          },
                        ],
                      },
                    ],
                  },
                },
                {
                  "bsonType": "null",
                },
              ],
            },
            "type_certif": {
              "bsonType": [
                "string",
                "null",
              ],
            },
            "voix_acces": {
              "bsonType": [
                "string",
                "null",
              ],
            },
          },
        },
        {
          "bsonType": "null",
        },
      ],
    },
    "rncp_eligible_apprentissage": {
      "bsonType": [
        "bool",
        "null",
      ],
    },
    "rncp_intitule": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "rome_codes": {
      "bsonType": "array",
      "items": {
        "anyOf": [
          {
            "not": {},
          },
          {
            "bsonType": [
              "string",
              "null",
            ],
          },
        ],
      },
    },
    "tags": {
      "bsonType": "array",
      "items": {
        "anyOf": [
          {
            "not": {},
          },
          {
            "bsonType": [
              "string",
              "null",
            ],
          },
        ],
      },
    },
  },
  "required": [
    "_id",
    "cle_ministere_educatif",
    "cfd",
    "cfd_outdated",
    "nom_academie",
    "num_academie",
    "code_postal",
    "code_commune_insee",
    "num_departement",
    "nom_departement",
    "region",
    "localite",
    "intitule_long",
    "intitule_court",
    "diplome",
    "niveau",
    "rncp_code",
    "rome_codes",
    "periode",
    "duree",
    "duree_incoherente",
    "annee",
    "annee_incoherente",
    "lieu_formation_adresse",
    "id_formation",
    "ids_action",
    "tags",
    "niveau_formation_diplome",
    "niveau_entree_obligatoire",
    "entierement_a_distance",
    "date_debut",
    "date_fin",
    "modalites_entrees_sorties",
    "etablissement_gestionnaire_siret",
    "etablissement_gestionnaire_uai",
    "etablissement_gestionnaire_entreprise_raison_sociale",
    "etablissement_gestionnaire_date_creation",
    "etablissement_formateur_siret",
    "etablissement_formateur_uai",
  ],
}
`;

exports[`validation-schema should create validation schema for invitations: invitations 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "author_id": {
      "bsonType": "objectId",
      "description": "Auteur de l'invitation",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date de création en base de données",
    },
    "email": {
      "bsonType": "string",
      "description": "Email destinataire",
    },
    "organisation_id": {
      "bsonType": "objectId",
      "description": "Organisation cible de l'invitation",
    },
    "token": {
      "bsonType": "string",
      "description": "Jeton d'invitation",
    },
  },
  "required": [
    "_id",
    "token",
    "email",
    "organisation_id",
    "author_id",
    "created_at",
  ],
}
`;

exports[`validation-schema should create validation schema for jobEvents: jobEvents 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "action": {
      "bsonType": "string",
      "description": "L'action en cours",
    },
    "data": {
      "additionalProperties": true,
      "bsonType": "object",
      "description": "La donnée liéé à l'action",
      "properties": {},
    },
    "date": {
      "bsonType": "date",
      "description": "La date de l'evenement",
    },
    "jobname": {
      "bsonType": "string",
      "description": "Le nom du job",
    },
  },
  "required": [
    "jobname",
    "action",
    "date",
  ],
}
`;

exports[`validation-schema should create validation schema for jwtSessions: jwtSessions 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "jwt": {
      "bsonType": "string",
      "description": "Session token",
    },
  },
  "required": [
    "_id",
    "jwt",
  ],
}
`;

exports[`validation-schema should create validation schema for maintenanceMessages: maintenanceMessages 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "context": {
      "bsonType": "string",
      "enum": [
        "manuel",
        "automatique",
        "maintenance",
      ],
    },
    "enabled": {
      "bsonType": "bool",
      "description": "Message actif ou non",
    },
    "msg": {
      "bsonType": "string",
      "description": "Message de maintenance",
    },
    "name": {
      "bsonType": "string",
      "description": "email du créateur du message",
    },
    "time": {
      "bsonType": "date",
      "description": "Date de mise en place du message",
    },
    "type": {
      "bsonType": "string",
      "enum": [
        "alert",
        "info",
      ],
    },
  },
  "required": [
    "_id",
    "msg",
    "name",
    "type",
    "context",
  ],
}
`;

exports[`validation-schema should create validation schema for organisations: organisations 1`] = `
{
  "anyOf": [
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "siret": {
          "bsonType": "string",
          "description": "N° SIRET",
          "pattern": "^[0-9]{14}$",
        },
        "type": {
          "bsonType": "string",
        },
        "uai": {
          "anyOf": [
            {
              "bsonType": "string",
              "description": "Code UAI de l'organisme (seulement pour les utilisateurs OF)",
              "pattern": "^[0-9]{7}[a-zA-Z]$",
            },
            {
              "bsonType": "null",
            },
          ],
          "description": "Code UAI de l'organisme (seulement pour les utilisateurs OF)",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "siret",
        "uai",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "reseau": {
          "bsonType": "string",
          "description": "Réseau du CFA, s'il existe",
          "enum": [
            "ADEN",
            "CMA",
            "AGRI",
            "AGRI_CNEAP",
            "AGRI_UNREP",
            "AGRI_UNMFREO",
            "ANASUP",
            "AMUE",
            "CCI",
            "CFA_EC",
            "COMP_DU_DEVOIR",
            "COMP_DU_TOUR_DE_FRANCE",
            "GRETA",
            "UIMM",
            "BTP_CFA",
            "MFR",
            "AFTRAL",
            "GRETA_VAUCLUSE",
            "CFA_SAT",
            "EN_HORS_MURS",
            "EN_CFA_ACADEMIQUE",
            "EN_EPLE",
          ],
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "reseau",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "code_region": {
          "bsonType": "string",
          "description": "Code région",
          "enum": [
            "11",
            "24",
            "27",
            "28",
            "32",
            "44",
            "52",
            "53",
            "75",
            "76",
            "84",
            "93",
            "94",
            "977",
            "978",
            "01",
            "02",
            "03",
            "04",
            "06",
            "00",
          ],
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
          "enum": [
            "DREETS",
            "DRAAF",
            "CONSEIL_REGIONAL",
            "CARIF_OREF_REGIONAL",
            "DRAFPIC",
          ],
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "code_region",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "code_departement": {
          "bsonType": "string",
          "enum": [
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "21",
            "22",
            "23",
            "24",
            "25",
            "26",
            "27",
            "28",
            "29",
            "30",
            "31",
            "32",
            "33",
            "34",
            "35",
            "36",
            "37",
            "38",
            "39",
            "40",
            "41",
            "42",
            "43",
            "44",
            "45",
            "46",
            "47",
            "48",
            "49",
            "50",
            "51",
            "52",
            "53",
            "54",
            "55",
            "56",
            "57",
            "58",
            "59",
            "60",
            "61",
            "62",
            "63",
            "64",
            "65",
            "66",
            "67",
            "68",
            "69",
            "70",
            "71",
            "72",
            "73",
            "74",
            "75",
            "76",
            "77",
            "78",
            "79",
            "80",
            "81",
            "82",
            "83",
            "84",
            "85",
            "86",
            "87",
            "88",
            "89",
            "90",
            "91",
            "92",
            "93",
            "94",
            "95",
            "971",
            "972",
            "973",
            "974",
            "975",
            "976",
            "977",
            "978",
            "984",
            "986",
            "987",
            "988",
            "989",
            "01",
            "02",
            "03",
            "04",
            "05",
            "06",
            "07",
            "08",
            "09",
            "2A",
            "2B",
          ],
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "code_departement",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "code_academie": {
          "bsonType": "string",
          "description": "Code académie",
          "enum": [
            "1",
            "2",
            "3",
            "4",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20",
            "22",
            "23",
            "24",
            "25",
            "27",
            "28",
            "31",
            "32",
            "33",
            "43",
            "44",
            "70",
            "77",
            "78",
          ],
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "code_academie",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "nom": {
          "bsonType": "string",
          "description": "Nom de l'organisation nationale",
          "enum": [
            "Services de la Première ministre",
            "Ministère de l'Agriculture et de la Souveraineté alimentaire",
            "Ministère des Armées",
            "Ministère de la Culture",
            "Ministère de l'Économie, des Finances et de la Souveraineté industrielle et numérique",
            "Ministère de l'Éducation nationale et de la Jeunesse",
            "Ministère de l'Enseignement supérieur et de la Recherche",
            "Ministère de l'Europe et des Affaires étrangères",
            "Ministère de l'Intérieur et des Outre-mer",
            "Ministère de la Justice",
            "Ministère de la Santé et de la Prévention",
            "Ministère des Solidarités, de l'Autonomie et des Personnes handicapées",
            "Ministère des Sports et des Jeux Olympiques et Paralympiques",
            "Ministère de la Transformation et de la Fonction publiques",
            "Ministère de la Transition écologique et de la Cohésion des territoires",
            "Ministère de la Transition énergétique",
            "Ministère du Travail, du Plein emploi et de l'Insertion",
          ],
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
        "nom",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
      ],
    },
    {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "_id": {
          "bsonType": "objectId",
        },
        "created_at": {
          "bsonType": "date",
          "description": "Date de création en base de données",
        },
        "type": {
          "bsonType": "string",
        },
      },
      "required": [
        "_id",
        "created_at",
        "type",
      ],
    },
  ],
}
`;

exports[`validation-schema should create validation schema for organismes: organismes 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "access_token": {
      "bsonType": "string",
      "description": "Le token permettant l'accès au CFA à sa propre page",
    },
    "adresse": {
      "additionalProperties": false,
      "bsonType": "object",
      "description": "Adresse de l'établissement",
      "properties": {
        "academie": {
          "bsonType": "string",
          "enum": [
            "1",
            "2",
            "3",
            "4",
            "6",
            "7",
            "8",
            "9",
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "20",
            "22",
            "23",
            "24",
            "25",
            "27",
            "28",
            "31",
            "32",
            "33",
            "43",
            "44",
            "70",
            "77",
            "78",
          ],
        },
        "bassinEmploi": {
          "bsonType": "string",
          "description": "Code Bassin d'emploi",
        },
        "code_insee": {
          "bsonType": "string",
          "description": "Le code insee doit contenir 5 caractères",
          "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
        },
        "code_postal": {
          "bsonType": "string",
          "description": "Le code postal doit contenir 5 caractères",
          "pattern": "^[0-9]{5}$",
        },
        "commune": {
          "bsonType": "string",
          "description": "Commune",
          "maxLength": 80,
        },
        "complement": {
          "bsonType": "string",
          "description": "Complément d'adresse",
        },
        "complete": {
          "bsonType": "string",
          "description": "Adresse complète",
        },
        "departement": {
          "bsonType": "string",
          "enum": [
            "10",
            "11",
            "12",
            "13",
            "14",
            "15",
            "16",
            "17",
            "18",
            "19",
            "21",
            "22",
            "23",
            "24",
            "25",
            "26",
            "27",
            "28",
            "29",
            "30",
            "31",
            "32",
            "33",
            "34",
            "35",
            "36",
            "37",
            "38",
            "39",
            "40",
            "41",
            "42",
            "43",
            "44",
            "45",
            "46",
            "47",
            "48",
            "49",
            "50",
            "51",
            "52",
            "53",
            "54",
            "55",
            "56",
            "57",
            "58",
            "59",
            "60",
            "61",
            "62",
            "63",
            "64",
            "65",
            "66",
            "67",
            "68",
            "69",
            "70",
            "71",
            "72",
            "73",
            "74",
            "75",
            "76",
            "77",
            "78",
            "79",
            "80",
            "81",
            "82",
            "83",
            "84",
            "85",
            "86",
            "87",
            "88",
            "89",
            "90",
            "91",
            "92",
            "93",
            "94",
            "95",
            "971",
            "972",
            "973",
            "974",
            "975",
            "976",
            "977",
            "978",
            "984",
            "986",
            "987",
            "988",
            "989",
            "01",
            "02",
            "03",
            "04",
            "05",
            "06",
            "07",
            "08",
            "09",
            "2A",
            "2B",
          ],
        },
        "numero": {
          "bsonType": "int",
          "description": "N° de la voie",
        },
        "pays": {
          "bsonType": "string",
          "description": "Pays",
          "enum": [
            "AF",
            "ZA",
            "AL",
            "DZ",
            "DE",
            "AD",
            "AO",
            "AG",
            "SA",
            "AR",
            "AM",
            "AU",
            "AT",
            "AZ",
            "BS",
            "BH",
            "BD",
            "BB",
            "BE",
            "BZ",
            "BJ",
            "BT",
            "BY",
            "MM",
            "BO",
            "BQ",
            "BA",
            "BW",
            "BR",
            "BN",
            "BG",
            "BF",
            "BI",
            "KH",
            "CM",
            "CA",
            "CV",
            "CF",
            "CL",
            "CN",
            "CY",
            "CO",
            "KM",
            "CG",
            "CD",
            "KR",
            "KP",
            "CR",
            "CI",
            "HR",
            "CU",
            "CW",
            "DK",
            "DJ",
            "DO",
            "DM",
            "EG",
            "SV",
            "AE",
            "EC",
            "ER",
            "ES",
            "EE",
            "SZ",
            "US",
            "ET",
            "MK",
            "FJ",
            "FI",
            "FR",
            "GA",
            "GM",
            "GE",
            "GH",
            "GR",
            "GD",
            "GT",
            "GN",
            "GQ",
            "GW",
            "GY",
            "HT",
            "HN",
            "HU",
            "IN",
            "ID",
            "IR",
            "IQ",
            "IE",
            "IS",
            "IL",
            "IT",
            "JM",
            "JP",
            "JO",
            "KZ",
            "KE",
            "KG",
            "KI",
            "XK",
            "KW",
            "LA",
            "LS",
            "LV",
            "LB",
            "LR",
            "LY",
            "LI",
            "LT",
            "LU",
            "MG",
            "MY",
            "MW",
            "MV",
            "ML",
            "MT",
            "MA",
            "MH",
            "MU",
            "MR",
            "MX",
            "FM",
            "MD",
            "MC",
            "MN",
            "ME",
            "MZ",
            "NA",
            "NR",
            "NP",
            "NI",
            "NE",
            "NG",
            "NO",
            "NZ",
            "OM",
            "UG",
            "UZ",
            "PK",
            "PW",
            "PS",
            "PA",
            "PG",
            "PY",
            "NL",
            "PE",
            "PH",
            "PL",
            "PT",
            "QA",
            "RO",
            "GB",
            "RU",
            "RW",
            "KN",
            "SM",
            "SX",
            "VC",
            "LC",
            "SB",
            "WS",
            "ST",
            "SN",
            "RS",
            "SC",
            "SL",
            "SG",
            "SK",
            "SI",
            "SO",
            "SD",
            "SS",
            "LK",
            "SE",
            "CH",
            "SR",
            "SY",
            "TJ",
            "TZ",
            "TD",
            "CZ",
            "TH",
            "TL",
            "TG",
            "TO",
            "TT",
            "TN",
            "TM",
            "TR",
            "TV",
            "UA",
            "UY",
            "VU",
            "VA",
            "VE",
            "VN",
            "YE",
            "ZM",
            "ZW",
          ],
        },
        "region": {
          "bsonType": "string",
          "enum": [
            "11",
            "24",
            "27",
            "28",
            "32",
            "44",
            "52",
            "53",
            "75",
            "76",
            "84",
            "93",
            "94",
            "977",
            "978",
            "01",
            "02",
            "03",
            "04",
            "06",
            "00",
          ],
        },
        "repetition_voie": {
          "bsonType": "string",
          "description": "Indice de répétition du numéro de voie",
          "enum": [
            "B",
            "T",
            "Q",
            "C",
          ],
        },
        "voie": {
          "bsonType": "string",
          "description": "Nom de voie",
        },
      },
    },
    "api_configuration_date": {
      "bsonType": "date",
      "description": "Date de l'interfaçage",
    },
    "api_key": {
      "bsonType": "string",
      "description": "API key pour envoi de données",
    },
    "api_siret": {
      "bsonType": "string",
      "description": "Siret envoyé par l'erp",
    },
    "api_uai": {
      "bsonType": "string",
      "description": "Uai envoyé par l'erp",
    },
    "api_version": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Version de l'api utilisée (v2 ou v3)",
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date d'ajout en base de données",
    },
    "creation_statut": {
      "bsonType": "string",
      "description": "Flag pour identifier que c'est un organisme créé à partir d'un lieu",
      "enum": [
        "ORGANISME_LIEU_FORMATION",
      ],
    },
    "effectifs_count": {
      "bsonType": "int",
      "description": "Compteur sur le nombre d'effectifs de l'organisme",
    },
    "effectifs_current_year_count": {
      "bsonType": "int",
      "description": "Compteur sur le nombre d'effectifs de l'organisme sur l'année courante",
    },
    "enseigne": {
      "bsonType": "string",
      "description": "Enseigne de l'organisme de formation",
    },
    "erp_unsupported": {
      "bsonType": "string",
      "description": "ERP renseigné par l'utilisateur à la configuration quand il n'est pas supporté",
    },
    "erps": {
      "bsonType": "array",
      "description": "ERPs rattachés au CFA, s'ils existent",
      "items": {
        "bsonType": "string",
      },
    },
    "est_dans_le_referentiel": {
      "bsonType": "string",
      "description": "Présence dans le referentiel ONISEP des organismes",
      "enum": [
        "absent",
        "present",
        "present_uai_multiples_dans_tdb",
      ],
    },
    "ferme": {
      "bsonType": "bool",
      "description": "Le siret est fermé",
    },
    "fiabilisation_statut": {
      "bsonType": "string",
      "description": "Statut de fiabilisation de l'organisme",
      "enum": [
        "FIABLE",
        "NON_FIABILISABLE_PB_COLLECTE",
        "NON_FIABILISABLE_UAI_NON_VALIDEE",
        "NON_FIABILISABLE_UAI_VALIDEE",
        "NON_FIABILISABLE_INEXISTANT",
        "A_CONTACTER",
        "INCONNU",
        "INCONNU_INSCRIPTION",
      ],
    },
    "first_transmission_date": {
      "bsonType": "date",
      "description": "Date de la première transmission de données",
    },
    "formations": {
      "bsonType": "array",
      "maxItems": 0,
    },
    "last_transmission_date": {
      "bsonType": "date",
      "description": "Date de la dernière transmission de données",
    },
    "mode_de_transmission": {
      "bsonType": "string",
      "description": "Mode de transmission des effectifs",
      "enum": [
        "API",
        "MANUEL",
      ],
    },
    "mode_de_transmission_configuration_author_fullname": {
      "bsonType": "string",
      "description": "Auteur de la configuration (prénom nom)",
    },
    "mode_de_transmission_configuration_date": {
      "bsonType": "date",
      "description": "Date à laquelle le mode de transmission a été configuré",
    },
    "nature": {
      "bsonType": "string",
      "description": "Nature de l'organisme de formation",
      "enum": [
        "responsable",
        "formateur",
        "responsable_formateur",
        "lieu_formation",
        "inconnue",
      ],
    },
    "natureValidityWarning": {
      "bsonType": "bool",
    },
    "nom": {
      "bsonType": "string",
      "description": "Nom de l'organisme de formation",
    },
    "opcos": {
      "bsonType": "array",
      "description": "OPCOs du CFA, s'ils existent",
      "items": {
        "bsonType": "string",
      },
    },
    "organisme_transmetteur_id": {
      "bsonType": "string",
      "description": "Identifiant de l'organisme id source transmettant",
    },
    "organismesFormateurs": {
      "bsonType": "array",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "_id": {
            "anyOf": [
              {
                "bsonType": "objectId",
              },
              {
                "bsonType": "null",
              },
            ],
            "description": "Identifiant unique",
          },
          "academie": {
            "bsonType": "string",
          },
          "commune": {
            "bsonType": "string",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "departement": {
            "bsonType": "string",
          },
          "enseigne": {
            "bsonType": "string",
          },
          "label": {
            "bsonType": "string",
          },
          "raison_sociale": {
            "bsonType": "string",
          },
          "referentiel": {
            "bsonType": "bool",
          },
          "region": {
            "bsonType": "string",
          },
          "reseaux": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "responsabilitePartielle": {
            "bsonType": "bool",
          },
          "siret": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "uai": {
            "bsonType": [
              "string",
              "null",
            ],
          },
        },
      },
    },
    "organismesResponsables": {
      "bsonType": "array",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "_id": {
            "anyOf": [
              {
                "bsonType": "objectId",
              },
              {
                "bsonType": "null",
              },
            ],
            "description": "Identifiant unique",
          },
          "academie": {
            "bsonType": "string",
          },
          "commune": {
            "bsonType": "string",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "departement": {
            "bsonType": "string",
          },
          "enseigne": {
            "bsonType": "string",
          },
          "label": {
            "bsonType": "string",
          },
          "raison_sociale": {
            "bsonType": "string",
          },
          "referentiel": {
            "bsonType": "bool",
          },
          "region": {
            "bsonType": "string",
          },
          "reseaux": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "responsabilitePartielle": {
            "bsonType": "bool",
          },
          "siret": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "uai": {
            "bsonType": [
              "string",
              "null",
            ],
          },
        },
      },
    },
    "prepa_apprentissage": {
      "bsonType": "bool",
      "description": "fait de la prépa apprentissage",
    },
    "qualiopi": {
      "bsonType": "bool",
      "description": "a la certification Qualiopi",
    },
    "raison_sociale": {
      "bsonType": "string",
      "description": "Raison sociale de l'organisme de formation",
    },
    "relatedFormations": {
      "bsonType": "array",
      "description": "Formations de cet organisme",
      "items": {
        "additionalProperties": false,
        "bsonType": "object",
        "properties": {
          "annee_formation": {
            "bsonType": "int",
            "description": "Année millésime de la formation pour cet organisme",
          },
          "cle_ministere_educatif": {
            "bsonType": "string",
            "description": "Clé unique de la formation",
          },
          "duree_formation_theorique": {
            "bsonType": "int",
            "description": "Durée théorique de la formation en mois pour cet organisme",
          },
          "formation_id": {
            "bsonType": "objectId",
            "description": "Identifiant unique",
          },
          "organismes": {
            "bsonType": "array",
            "items": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "adresse": {
                  "additionalProperties": false,
                  "bsonType": "object",
                  "description": "Adresse du lieu de formation (optionnel)",
                  "properties": {
                    "academie": {
                      "bsonType": "string",
                      "enum": [
                        "1",
                        "2",
                        "3",
                        "4",
                        "6",
                        "7",
                        "8",
                        "9",
                        "10",
                        "11",
                        "12",
                        "13",
                        "14",
                        "15",
                        "16",
                        "17",
                        "18",
                        "19",
                        "20",
                        "22",
                        "23",
                        "24",
                        "25",
                        "27",
                        "28",
                        "31",
                        "32",
                        "33",
                        "43",
                        "44",
                        "70",
                        "77",
                        "78",
                      ],
                    },
                    "bassinEmploi": {
                      "bsonType": "string",
                      "description": "Code Bassin d'emploi",
                    },
                    "code_insee": {
                      "bsonType": "string",
                      "description": "Le code insee doit contenir 5 caractères",
                      "pattern": "^[0-9]{1}[0-9A-Z]{1}[0-9]{3}$",
                    },
                    "code_postal": {
                      "bsonType": "string",
                      "description": "Le code postal doit contenir 5 caractères",
                      "pattern": "^[0-9]{5}$",
                    },
                    "commune": {
                      "bsonType": "string",
                      "description": "Commune",
                      "maxLength": 80,
                    },
                    "complement": {
                      "bsonType": "string",
                      "description": "Complément d'adresse",
                    },
                    "complete": {
                      "bsonType": "string",
                      "description": "Adresse complète",
                    },
                    "departement": {
                      "bsonType": "string",
                      "enum": [
                        "10",
                        "11",
                        "12",
                        "13",
                        "14",
                        "15",
                        "16",
                        "17",
                        "18",
                        "19",
                        "21",
                        "22",
                        "23",
                        "24",
                        "25",
                        "26",
                        "27",
                        "28",
                        "29",
                        "30",
                        "31",
                        "32",
                        "33",
                        "34",
                        "35",
                        "36",
                        "37",
                        "38",
                        "39",
                        "40",
                        "41",
                        "42",
                        "43",
                        "44",
                        "45",
                        "46",
                        "47",
                        "48",
                        "49",
                        "50",
                        "51",
                        "52",
                        "53",
                        "54",
                        "55",
                        "56",
                        "57",
                        "58",
                        "59",
                        "60",
                        "61",
                        "62",
                        "63",
                        "64",
                        "65",
                        "66",
                        "67",
                        "68",
                        "69",
                        "70",
                        "71",
                        "72",
                        "73",
                        "74",
                        "75",
                        "76",
                        "77",
                        "78",
                        "79",
                        "80",
                        "81",
                        "82",
                        "83",
                        "84",
                        "85",
                        "86",
                        "87",
                        "88",
                        "89",
                        "90",
                        "91",
                        "92",
                        "93",
                        "94",
                        "95",
                        "971",
                        "972",
                        "973",
                        "974",
                        "975",
                        "976",
                        "977",
                        "978",
                        "984",
                        "986",
                        "987",
                        "988",
                        "989",
                        "01",
                        "02",
                        "03",
                        "04",
                        "05",
                        "06",
                        "07",
                        "08",
                        "09",
                        "2A",
                        "2B",
                      ],
                    },
                    "numero": {
                      "bsonType": "int",
                      "description": "N° de la voie",
                    },
                    "pays": {
                      "bsonType": "string",
                      "description": "Pays",
                      "enum": [
                        "AF",
                        "ZA",
                        "AL",
                        "DZ",
                        "DE",
                        "AD",
                        "AO",
                        "AG",
                        "SA",
                        "AR",
                        "AM",
                        "AU",
                        "AT",
                        "AZ",
                        "BS",
                        "BH",
                        "BD",
                        "BB",
                        "BE",
                        "BZ",
                        "BJ",
                        "BT",
                        "BY",
                        "MM",
                        "BO",
                        "BQ",
                        "BA",
                        "BW",
                        "BR",
                        "BN",
                        "BG",
                        "BF",
                        "BI",
                        "KH",
                        "CM",
                        "CA",
                        "CV",
                        "CF",
                        "CL",
                        "CN",
                        "CY",
                        "CO",
                        "KM",
                        "CG",
                        "CD",
                        "KR",
                        "KP",
                        "CR",
                        "CI",
                        "HR",
                        "CU",
                        "CW",
                        "DK",
                        "DJ",
                        "DO",
                        "DM",
                        "EG",
                        "SV",
                        "AE",
                        "EC",
                        "ER",
                        "ES",
                        "EE",
                        "SZ",
                        "US",
                        "ET",
                        "MK",
                        "FJ",
                        "FI",
                        "FR",
                        "GA",
                        "GM",
                        "GE",
                        "GH",
                        "GR",
                        "GD",
                        "GT",
                        "GN",
                        "GQ",
                        "GW",
                        "GY",
                        "HT",
                        "HN",
                        "HU",
                        "IN",
                        "ID",
                        "IR",
                        "IQ",
                        "IE",
                        "IS",
                        "IL",
                        "IT",
                        "JM",
                        "JP",
                        "JO",
                        "KZ",
                        "KE",
                        "KG",
                        "KI",
                        "XK",
                        "KW",
                        "LA",
                        "LS",
                        "LV",
                        "LB",
                        "LR",
                        "LY",
                        "LI",
                        "LT",
                        "LU",
                        "MG",
                        "MY",
                        "MW",
                        "MV",
                        "ML",
                        "MT",
                        "MA",
                        "MH",
                        "MU",
                        "MR",
                        "MX",
                        "FM",
                        "MD",
                        "MC",
                        "MN",
                        "ME",
                        "MZ",
                        "NA",
                        "NR",
                        "NP",
                        "NI",
                        "NE",
                        "NG",
                        "NO",
                        "NZ",
                        "OM",
                        "UG",
                        "UZ",
                        "PK",
                        "PW",
                        "PS",
                        "PA",
                        "PG",
                        "PY",
                        "NL",
                        "PE",
                        "PH",
                        "PL",
                        "PT",
                        "QA",
                        "RO",
                        "GB",
                        "RU",
                        "RW",
                        "KN",
                        "SM",
                        "SX",
                        "VC",
                        "LC",
                        "SB",
                        "WS",
                        "ST",
                        "SN",
                        "RS",
                        "SC",
                        "SL",
                        "SG",
                        "SK",
                        "SI",
                        "SO",
                        "SD",
                        "SS",
                        "LK",
                        "SE",
                        "CH",
                        "SR",
                        "SY",
                        "TJ",
                        "TZ",
                        "TD",
                        "CZ",
                        "TH",
                        "TL",
                        "TG",
                        "TO",
                        "TT",
                        "TN",
                        "TM",
                        "TR",
                        "TV",
                        "UA",
                        "UY",
                        "VU",
                        "VA",
                        "VE",
                        "VN",
                        "YE",
                        "ZM",
                        "ZW",
                      ],
                    },
                    "region": {
                      "bsonType": "string",
                      "enum": [
                        "11",
                        "24",
                        "27",
                        "28",
                        "32",
                        "44",
                        "52",
                        "53",
                        "75",
                        "76",
                        "84",
                        "93",
                        "94",
                        "977",
                        "978",
                        "01",
                        "02",
                        "03",
                        "04",
                        "06",
                        "00",
                      ],
                    },
                    "repetition_voie": {
                      "bsonType": "string",
                      "description": "Indice de répétition du numéro de voie",
                      "enum": [
                        "B",
                        "T",
                        "Q",
                        "C",
                      ],
                    },
                    "voie": {
                      "bsonType": "string",
                      "description": "Nom de voie",
                    },
                  },
                },
                "nature": {
                  "bsonType": "string",
                  "enum": [
                    "responsable",
                    "formateur",
                    "responsable_formateur",
                    "lieu_formation",
                    "inconnue",
                  ],
                },
                "organisme_id": {
                  "bsonType": "objectId",
                  "description": "Identifiant unique",
                },
                "siret": {
                  "bsonType": "string",
                  "description": "Siret du lieu de formation (optionnel)",
                  "pattern": "^[0-9]{14}$",
                },
                "uai": {
                  "bsonType": "string",
                  "description": "Code UAI du lieu de formation (optionnel)",
                  "pattern": "^[0-9]{7}[a-zA-Z]$",
                },
              },
            },
          },
        },
      },
    },
    "reseaux": {
      "bsonType": "array",
      "description": "Réseaux du CFA, s'ils existent",
      "items": {
        "bsonType": "string",
        "enum": [
          "ADEN",
          "CMA",
          "AGRI",
          "AGRI_CNEAP",
          "AGRI_UNREP",
          "AGRI_UNMFREO",
          "ANASUP",
          "AMUE",
          "CCI",
          "CFA_EC",
          "COMP_DU_DEVOIR",
          "COMP_DU_TOUR_DE_FRANCE",
          "GRETA",
          "UIMM",
          "BTP_CFA",
          "MFR",
          "AFTRAL",
          "GRETA_VAUCLUSE",
          "CFA_SAT",
          "EN_HORS_MURS",
          "EN_CFA_ACADEMIQUE",
          "EN_EPLE",
        ],
      },
    },
    "siret": {
      "bsonType": "string",
      "description": "N° SIRET de l'établissement",
      "pattern": "^[0-9]{14}$",
    },
    "uai": {
      "bsonType": "string",
      "description": "Code UAI de l'établissement",
      "pattern": "^[0-9]{7}[a-zA-Z]$",
    },
    "updated_at": {
      "bsonType": "date",
      "description": "Date de mise à jour en base de données",
    },
  },
  "required": [
    "_id",
    "siret",
    "updated_at",
    "created_at",
  ],
}
`;

exports[`validation-schema should create validation schema for organismesReferentiel: organismesReferentiel 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "adresse": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "academie": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
            "nom",
          ],
        },
        "code_insee": {
          "bsonType": "string",
        },
        "code_postal": {
          "bsonType": "string",
        },
        "departement": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
            "nom",
          ],
        },
        "geojson": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "geometry": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "coordinates": {
                  "bsonType": "array",
                },
                "type": {
                  "bsonType": "string",
                },
              },
              "required": [
                "type",
                "coordinates",
              ],
            },
            "properties": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "score": {
                  "bsonType": "number",
                },
                "source": {
                  "bsonType": "string",
                },
              },
            },
            "type": {
              "bsonType": "string",
            },
          },
          "required": [
            "type",
            "geometry",
          ],
        },
        "label": {
          "bsonType": "string",
        },
        "localite": {
          "bsonType": "string",
        },
        "region": {
          "additionalProperties": false,
          "bsonType": "object",
          "properties": {
            "code": {
              "bsonType": "string",
            },
            "nom": {
              "bsonType": "string",
            },
          },
          "required": [
            "code",
            "nom",
          ],
        },
      },
      "required": [
        "code_postal",
        "code_insee",
        "localite",
        "region",
        "academie",
      ],
    },
    "contacts": {
      "bsonType": "array",
      "description": "Formations de cet organisme",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "confirmé": {
            "bsonType": "bool",
          },
          "date_collecte": {
            "bsonType": "string",
          },
          "email": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
        },
      },
    },
    "enseigne": {
      "bsonType": "string",
    },
    "etat_administratif": {
      "bsonType": "string",
      "enum": [
        "actif",
        "fermé",
      ],
    },
    "forme_juridique": {
      "additionalProperties": false,
      "bsonType": "object",
      "properties": {
        "code": {
          "bsonType": "string",
        },
        "label": {
          "bsonType": "string",
        },
      },
      "required": [
        "code",
        "label",
      ],
    },
    "lieux_de_formation": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "uai": {
            "bsonType": "string",
          },
          "uai_fiable": {
            "bsonType": "bool",
          },
        },
      },
    },
    "nature": {
      "bsonType": "string",
      "enum": [
        "responsable",
        "formateur",
        "responsable_formateur",
        "inconnue",
      ],
    },
    "numero_declaration_activite": {
      "bsonType": "string",
    },
    "qualiopi": {
      "bsonType": "bool",
    },
    "raison_sociale": {
      "bsonType": "string",
    },
    "relations": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "label": {
            "bsonType": "string",
          },
          "referentiel": {
            "bsonType": "bool",
          },
          "siret": {
            "bsonType": "string",
          },
          "sources": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "type": {
            "bsonType": "string",
            "enum": [
              "formateur->responsable",
              "responsable->formateur",
              "entreprise",
            ],
          },
          "uai": {
            "bsonType": [
              "string",
              "null",
            ],
          },
        },
      },
    },
    "siege_social": {
      "bsonType": "bool",
    },
    "siret": {
      "bsonType": "string",
    },
    "uai": {
      "bsonType": "string",
    },
  },
  "required": [
    "_id",
    "siret",
    "nature",
    "lieux_de_formation",
  ],
}
`;

exports[`validation-schema should create validation schema for organismesSoltea: organismesSoltea 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "code_postal": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "commune": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "departement": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "ligne1_adresse": {
      "bsonType": "string",
    },
    "ligne2_adresse": {
      "bsonType": "string",
    },
    "ligne3_adresse": {
      "bsonType": "string",
    },
    "ligne4_adresse": {
      "bsonType": "string",
    },
    "ligne5_adresse": {
      "bsonType": "string",
    },
    "raison_sociale": {
      "bsonType": [
        "string",
        "null",
      ],
    },
    "siret": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "N° SIRET de l'établissement",
    },
    "uai": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Code UAI de l'établissement",
    },
  },
  "required": [
    "_id",
  ],
}
`;

exports[`validation-schema should create validation schema for rncp: rncp 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "actif": {
      "bsonType": "bool",
    },
    "etat_fiche": {
      "bsonType": "string",
    },
    "intitule": {
      "bsonType": "string",
    },
    "niveau": {
      "bsonType": "number",
    },
    "nouveaux_rncp": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
    "opcos": {
      "bsonType": "array",
      "description": "Information récupérée depuis les CSV des OPCOs et non le RNCP",
      "items": {
        "bsonType": "string",
      },
    },
    "rncp": {
      "bsonType": "string",
    },
    "romes": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
  },
  "required": [
    "_id",
    "rncp",
    "intitule",
    "etat_fiche",
    "actif",
    "romes",
  ],
}
`;

exports[`validation-schema should create validation schema for rome: rome 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "code": {
      "bsonType": "string",
      "description": "Code ROME",
    },
    "label_domaine": {
      "bsonType": "string",
      "description": "Label domaine professionnel",
    },
    "label_famille": {
      "bsonType": "string",
      "description": "Label famille de métier",
    },
    "label_fiche": {
      "bsonType": "string",
      "description": "Label fiche métier",
    },
  },
  "required": [
    "code",
    "label_fiche",
    "label_domaine",
    "label_famille",
    "_id",
  ],
}
`;

exports[`validation-schema should create validation schema for users: users 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "__v": {
      "bsonType": "number",
    },
    "_id": {
      "bsonType": "objectId",
    },
    "archived_at": {
      "bsonType": "date",
    },
    "created_at": {
      "bsonType": "date",
      "description": "La date de création de l'utilisateur",
    },
    "email": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Email de l'utilisateur",
    },
    "last_connection": {
      "bsonType": "date",
      "description": "Date de dernière connexion",
    },
    "network": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Le réseau de CFA de l'utilisateur s'il est précisé",
    },
    "organisme": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "L'organisme d'appartenance de l'utilisateur s'il est précisé",
    },
    "password": {
      "bsonType": "string",
      "description": "Le mot de passe hashed",
    },
    "password_update_token": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "Token généré afin de sécuriser le changement de mot de passe",
    },
    "password_update_token_expiry": {
      "anyOf": [
        {
          "bsonType": "date",
        },
        {
          "bsonType": "null",
        },
      ],
      "description": "Date d'expiration du token généré afin de sécuriser le changement de mot de passe",
    },
    "permissions": {
      "bsonType": "array",
      "items": {
        "bsonType": "string",
      },
    },
    "region": {
      "bsonType": [
        "string",
        "null",
      ],
      "description": "La région de l'utilisateur s'il est précisé",
    },
    "username": {
      "bsonType": "string",
      "description": "Le nom de l'utilisateur, utilisé pour l'authentification",
    },
  },
  "required": [
    "_id",
    "username",
    "created_at",
  ],
}
`;

exports[`validation-schema should create validation schema for usersMigration: usersMigration 1`] = `
{
  "additionalProperties": false,
  "bsonType": "object",
  "properties": {
    "_id": {
      "bsonType": "objectId",
    },
    "account_status": {
      "bsonType": "string",
      "description": "Statut du compte",
      "enum": [
        "PENDING_EMAIL_VALIDATION",
        "PENDING_ADMIN_VALIDATION",
        "CONFIRMED",
      ],
    },
    "civility": {
      "bsonType": "string",
      "description": "civilité",
      "enum": [
        "Madame",
        "Monsieur",
      ],
    },
    "connection_history": {
      "bsonType": "array",
      "description": "Historique des dates de connexion",
      "items": {
        "bsonType": "date",
      },
    },
    "created_at": {
      "bsonType": "date",
      "description": "Date de création du compte",
    },
    "email": {
      "bsonType": "string",
      "description": "Email utilisateur",
    },
    "emails": {
      "bsonType": "array",
      "items": {
        "additionalProperties": true,
        "bsonType": "object",
        "properties": {
          "error": {
            "bsonType": "array",
            "items": {
              "additionalProperties": false,
              "bsonType": "object",
              "properties": {
                "message": {
                  "bsonType": "string",
                },
                "type": {
                  "bsonType": "string",
                  "enum": [
                    "fatal",
                    "soft_bounce",
                    "hard_bounce",
                    "complaint",
                    "invalid_email",
                    "blocked",
                    "error",
                  ],
                },
              },
            },
          },
          "messageIds": {
            "bsonType": "array",
            "items": {
              "bsonType": "string",
            },
          },
          "openDate": {
            "bsonType": "date",
          },
          "payload": {},
          "sendDates": {
            "bsonType": "array",
            "items": {
              "bsonType": "date",
            },
          },
          "templateName": {
            "bsonType": "string",
          },
          "token": {
            "bsonType": "string",
          },
        },
        "required": [
          "token",
          "templateName",
          "sendDates",
        ],
      },
    },
    "fonction": {
      "bsonType": "string",
      "description": "La fonction de l'utilisateur",
    },
    "has_accept_cgu_version": {
      "bsonType": "string",
      "description": "Version des cgu accepté par l'utilisateur",
    },
    "invalided_token": {
      "bsonType": "bool",
      "description": "true si besoin de reset le token",
    },
    "last_connection": {
      "bsonType": "date",
      "description": "Date de dernière connexion",
    },
    "nom": {
      "bsonType": "string",
      "description": "Le nom de l'utilisateur",
    },
    "organisation_id": {
      "bsonType": "objectId",
      "description": "Organisation à laquelle appartient l'utilisateur",
    },
    "password": {
      "bsonType": "string",
      "description": "Le mot de passe hashé",
    },
    "password_updated_at": {
      "bsonType": "date",
      "description": "Date de dernière mise à jour mot de passe",
    },
    "prenom": {
      "bsonType": "string",
      "description": "Le prénom de l'utilisateur",
    },
    "reminder_missing_configuration_and_data_sent_date": {
      "bsonType": "date",
      "description": "Date d'envoi de la relance email pour configuration et données manquantes",
    },
    "reminder_missing_data_sent_date": {
      "bsonType": "date",
      "description": "Date d'envoi de la relance email pour données manquantes",
    },
    "telephone": {
      "bsonType": "string",
      "description": "Le téléphone de l'utilisateur",
    },
    "unsubscribe": {
      "bsonType": "bool",
      "description": "unsubscribe email",
    },
  },
  "required": [
    "_id",
    "email",
    "password",
    "civility",
    "nom",
    "prenom",
    "organisation_id",
    "account_status",
  ],
}
`;
